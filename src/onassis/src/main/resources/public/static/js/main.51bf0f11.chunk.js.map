{"version":3,"sources":["components/minibars/helpers.js","reducers/ping.js","reducers/daterange.js","reducers/minibars.js","reducers/chart.js","reducers/pie.js","reducers/payments.js","reducers/payment.js","reducers/constants.js","reducers/accounts.js","reducers/categories.js","reducers/navi.js","reducers/auditlog.js","reducers/errorMessage.js","reducers/group.js","reducers/calculator.js","reducers/day.js","reducers/versionInfo.js","reducers/index.js","actions/errorMessage.js","actions/axios.js","actions/constants.js","actions/categories.js","components/editorFields/CurrencyField.js","components/editorFields/CheckboxField.js","components/editorFields/TextField.js","components/editorFields/ColorField.js","util/alertoptions.js","util/currency.js","components/categoriesEditor/constants.js","components/categoriesEditor/CategoriesEditor.js","components/categories/categories.js","actions/chart.js","actions/accounts.js","components/accountsEditor/constants.js","components/accountsEditor/AccountsEditor.js","components/accounts/accounts.js","components/main/Spinner.js","actions/auditlog.js","components/logs/buttons.js","util/fiDate.js","components/logs/logCommons.js","components/logs/logEntry.js","components/logs/auditlogTable.js","components/logs/auditlog.js","components/logs/logs.js","util/addDays.js","actions/daterange.js","actions/minibars.js","components/minibars/minibars_d3.js","components/minibars/chunkdata.js","components/minibars/minibars.js","components/minibars/buttons/buttonL.js","components/minibars/buttons/buttonR.js","components/datepicker/datepicker.js","util/findInArray.js","components/dropdown/dropdown.js","components/constantfilter/ConstantFilter.js","components/main/RangePanel.js","actions/pie.js","actions/payments.js","actions/payment.js","actions/calculator.js","components/history/HistoryModal.js","components/editorFields/LockField.js","components/editorFields/CurrencyFieldPopover.js","components/editorFields/DropdownField.js","components/editorFields/TextFieldPopover.js","components/editorFields/DateFieldPopover.js","components/paymentsEditor/recurrent.js","util/math.js","components/paymentsEditor/constants.js","components/paymentsEditor/PaymentsEditor.js","components/payments/payments.js","components/paymentSelection/paymentSelection.js","util/tooltip.js","actions/day.js","components/day/buttonL.js","components/day/buttonR.js","components/day/buttonToday.js","components/calculator/calculator.js","components/main/DetailsPanel.js","components/chart/chart.js","components/main/ChartPanel.js","util/initials.js","components/pie/pie.js","components/main/PiePanel.js","actions/navi.js","components/main/Content.js","components/main/ErrorMessage.js","actions/versionInfo.js","components/versionInfo/versionInfo.js","components/groupid/GroupId.js","actions/group.js","components/navi/MenuBar.js","actions/ping.js","components/ping/ping.js","components/main/Onassis.js","index.js"],"names":["dates","convert","d","constructor","Date","Array","Number","String","year","month","date","NaN","compare","a","b","isFinite","this","valueOf","inRange","start","end","module","exports","reducer","state","arguments","length","undefined","action","type","Object","assign","up","payload","s","e","fetching","balances","redraw","curves","nextday","prevday","today","slices","queryType","params","payments","historystack","payment","lock_payment_request","locked","console","log","refreshTime","constants","accounts","categories","view","logentries","firstpage","lastpage","status","msg","when","g","p","ts","now","version","rootReducer","combineReducers","ping","daterange","minibars","chart","pie","navi","auditlog","errorMessage","group","calculator","day","versionInfo","showError","dispatch","showErrorAction","show_error","error","response","data","error_message","message","HOST","url","document","createElement","href","parseUrl","URL","hostname","_contextUrl","ctx_path","axios_get","f","contextUrl","axios","get","then","catch","axios_get_params","axios_post","post","constantsRefreshAction","getTime","invalidate","id","get_constants","request","done","res","json","JSON","parse","getBody","update","updates","categoriesUpdateRequestAction","load","CurrencyField","props","_this","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","currencyValue","value","onChange","bind","assertThisInitialized","handleFocus","event","target","select","_this$props","onValueChanged","field","index","newCurrencyValue","plus","lastIndexOf","minus","replace","parseInt","slice","normalizeCurrency","setState","nextprops","_this$props2","readOnly","placeholder","touched","fontSize","react_default","autoFocus","onFocus","autoComplete","disabled","className","style","textAlign","color","substr","display","width","backgroundColor","React","Component","defaultProps","CheckboxField","checked","name","borderColor","FontAwesome","require","TextField","txtValue","_this2","linkCb","maxLength","button","Button","bsSize","onClick","ColorField","handleClick","displayColorPicker","handleClose","handleChange","hex","styles","reactCSS","default","height","borderRadius","background","swatch","padding","boxShadow","cursor","popover","position","zIndex","cover","top","right","bottom","left","react_color_lib","alertOptions","offset","theme","time","transition","currencyFormat","c","parseFloat","Math","round","toFixed","fields","defaultValues","i","active","descr","validators","preInitFormat","copy","forEach","push","copyCategory","deepCopy","preSubmitFormat","copyObject","category","initState","values","initial","errors","deleted","sort","asc","copyArray","array","splice","tempId","CategoriesEditor","renderCategoriesT","sortedValues","sortersF","Panel","Heading","Title","resetT","pristine","bsStyle","preSubmitT","addR","Body","Table","striped","bordered","hover","condensed","thClassName","th","CategoriesEditor_FontAwesome","size","map","renderCategoryR","showOk","changePropertyF","changePropertyDeletedF","setValueF","validateF","touchedF","isDifferentFromInitialF","chooseValueF","renderContentF","renderDeletedContentF","setSortF","getDefaultR","removeR","validateR","readOnlyR","isPersistedR","isPristineT","hasErrorsT","preInitT","init","tdClassName","td","objectSpread","initCategories","deleteCount","original","row","editorFields_CurrencyField","editorFields_CheckboxField","editorFields_TextField","editorFields_ColorField","_this3","inv","textA","toUpperCase","textB","defaults","valuesCopy","errorsCopy","last","l","check","values_copy","errors_copy","ix","v","_this4","key","initialCategories","show","icon","src","alt","_this5","created","modified","keys","stringify","allChecked","_this6","label","arrow","sortField","labelField","marginTop","paddingRight","_this7","dist_default","ref","connect","Categories","paddingTop","paddingBottom","alignItems","components_categoriesEditor_CategoriesEditor","store","dateFormat","chartRequestAction","chartResponseAction","chart_load","chart_refresh","assert","chart_redraw","accountsUpdateRequestAction","credit","copyAccount","account","AccountsEditor","renderAccountsT","AccountsEditor_FontAwesome","renderAccountR","initAccounts","initialAccounts","Accounts","components_accountsEditor_AccountsEditor","Spinner","auditlogResponseAction","entries","fp","lp","lastPage","PAGE_SIZE","pop","next","prev","firstPage","shift","Buttons","hs","rownr","hd","first","buttons_FontAwesome","toDateFi","fiDate","parts","split","fiDateTimeMillis","millis","getDate","m","getMonth","h","getHours","mi","getMinutes","sec","getSeconds","mspart","getMilliseconds","getFullYear","op","DBDate","toFiDBFormat","c_descr","a_descr","LogEntry","renderLogHeaderT","renderLogR","r","concat","ret","indexOf","singleEntry","logEntry","AuditLogTable","renderLogEntry","AuditLog","main_Spinner","buttons","auditlogTable","Logs","components_logs_auditlog","addDays","days","result","setDate","addMonths","months","setMonth","daydiff","d1","d2","dt1","dt2","floor","UTC","isFirstAndLastOfSameMonth","daysInMonth","getYear","prev_s","prev_e","set_daterange","setDateRangeAction","daterange_next_block","diff","daterange_prev_block","set_todayrange","setFullYear","setHours","prev_cat","balances_load","cat","balance","balancesResponseAction","balances_refresh","minibars_redraw","d3","div_border_width","column_width","line_width","b_line_width","leadin_width","leadin_x","top_margin","datearea_height","center_margin","month_height","bottom_margin","datearea_y","center_margin_y","month_y","bottom_margin_y","month_markers","miny","maxy","scale","max_selection_days","FORMAT_DATE","FORMAT_MONTH","FORMAT_MONTH_YEAR","COLOR_INCOME_NEGATIV","COLOR_INCOME_POSITIV","COLOR_BALANCE","COLOR_DAY_BACKGROUND_NORMAL","COLOR_DAY_BACKGROUND_UNDER_LIMITS","COLOR_DAY_BACKGROUND_SELECTED","COLOR_DAY_BACKGROUND_FOCUS","COLOR_MONTH_BACKGROUND_NORMAL_ODD","COLOR_MONTH_BACKGROUND_NORMAL_EVEN","COLOR_MONTH_TEXT","COLOR_UNLOCKED","COLOR_MONTH_SEPARATOR_LINE","bindto","slot_width","col_per_slot_ratio","cb_select","_DIV","_TIP_DIV","_TIP_I_DIV","_DAY_TEXT","_B_TEXT","_B_COLOR","_I_TEXT","_LEADIN","_LEADIN_ZERO","_LEADIN_ZERO_TEXT","_MAX_TEXT","_MIN_TEXT","_MONTH","_BG","_I","_E","_B","_UNLOCKED","_LINE_B_PREV","_LINE_B_NEXT","_LINE_ZERO","init_changeables","columns","left_month","monthId","right_month","monthMarkers","dateId","bgColor","smallestb","bgNormal","monthColor","roundNumberText","number","num","toPrecision","roundNumber","prefix","formatPrefix","symbol","show_tip","mid","bg","getElementById","getBoundingClientRect","doc","documentElement","offsetRect","window","pageYOffset","scrollTop","clientTop","text","iColor","normalize","_s","min","_e","max","_MS_PER_DAY","dateDiffInDays","utc1","utc2","body","clicks","click","abs","attr","mouseover","mouseout","hide_tip","create","bindTo","clicks_month","s_date","e_date","minibar_div","append","float","background-color","border-style","border-width","border-color","margin-top","tbody","pointer-events","colspan","tr2","tr1","minibar_leadin_svg","x1","x2","y1","y2","stroke","stroke-width","x","y","text-anchor","font-family","font-size","fill","minibar_svg","on","selectAll","enter","prev_b","next_b","cx","cy","leadin","updateMonth","date_id","datum","nullData","len","recreate","remove","resize","config","generate","provideddata","daydata","balances_given","idaydata","lendaydata","monthDays","dayArray","data_i","m_i","y_i","d_i","z","zlen","range_text","z0","zlen0","ax","axlen","ixlen","prevm","z1","zlen1","unshift","nextm","z2","zlen2","chunk_rawdata","prev_month_markers","linear","domain","range","init_scales","start_","end_","addEventListener","Minibars","minibarconfig","su","setDateRange","nextProps","ButtonL","prevBlock","daterangePrevBlock","buttonL_FontAwesome","ButtonR","nextBlock","daterangeNextBlock","buttonR_FontAwesome","dateRange_pickeroptions","dateLimit","showWeekNumbers","autoApply","alwaysShowCalendars","locale","direction","format","separator","applyLabel","cancelLabel","fromLabel","toLabel","customRangeLabel","daysOfWeek","monthNames","firstDay","linkedCalendars","ranges","Last 7 Days","moment","subtract","Last 30 Days","This Month","startOf","endOf","Last Month","dateSingle_pickeroptions","singleDatePicker","showDropdowns","DatePicker","$","pickerName","setStartDate","setEndDate","pickerType","daterangepicker","pickerCallback","onKeyDown","which","keyCode","preventDefault","componentWillReceiveProps","findInArray","booleanfunction","item","Dropdown","selectedValue","items","getConstants","constants_id","onValueChange","renderOption","selectedItem","validConstants","filter","valid","whiteSpace","textOverflow","overflow","maxWidth","marginRight","marginLeft","dropdown_FontAwesome","border","backgroundImage","renderValue","options","hideResetButton","cancelKeyboardEventOnSelection","ConstantFilter","onFilterChanged","onCheck","dd","dropdown","RangePanel","showMinibars","that","setTimeout","minibarsRedraw","ctrls","paddingLeft","constantfilter_ConstantFilter","header","RangePanel_FontAwesome","buttonL","datepicker","buttonR","Toggle","componentClass","textDecoration","opacity","expanded","onToggle","react_media","query","matches","Collapse","minibars_minibars","pieRequestAction","pieResponseAction","pie_load","pie_redraw","history","current","paymentsRequestAction","paymentsResponseAction","paymentsUpdateRequestAction","payments_refresh","day_load","account_load","category_load","group_load","list_load","ids","prev_in_history","next_in_history","lock_payment","lockPaymentRequestAction","lockPaymentResponseAction","payment_selection","paymentSelectionAction","calc_add","calcAddRequestAction","HistoryModal","onHide","Modal","aria-labelledby","centered","dialogClassName","Header","closeButton","Footer","Lock","LockField_FontAwesome","Unlock","LockField","toggleLock","lockPayment","component_default","icons","LockField_Unlock","unchecked","LockField_Lock","elemId","caretPos","elem","createTextRange","move","selectionStart","focus","setSelectionRange","setCaretPosition","popoverText","inputField","linkButton","OverlayTrigger","trigger","placement","overlay","Popover","DropdownField","DateField","datePickerField","DAILY","iteration","date1","WEEKLY","FORTNIGHTLY","TWICE_A_MONTH","n","MONTHLY","EVERY_OTHER_MONTH","EVERY_3_MONTHS","EVERY_4_MONTHS","EVERY_6_MONTHS","YEARLY","recurrent","span","initialMaskValues","checkedList","copyPayment","toDBFormatFi","recurSpans","recurring","recur","times","masked","maskValues","maskErrors","oneIsTrue","checkedSet","PaymentsEditor","renderPaymentsHeaderT","setValueCheckAllF","drawBalanceF","PaymentsEditor_FontAwesome","renderControls","setRecurring","setRecurringSpan","react_numeric_input_default","step","precision","setRecurringTimes","renderNormalT","renderPaymentR","renderPaymentsT","showAlert","changePropertyLF","setValueCheckF","setValueMaskF","setValueMaskCheckF","validateMaskF","maskedF","disabledCheckR","groupLoad","dayLoad","showHistory","initPayments","historyShow","defaultDate","initialCopy","updateCheckedSet","paymentSelection","set","copy2","editorFields_LockField","DateFieldPopover","CurrencyFieldPopover","calculatorAdd","TextFieldPopover","editorFields_DropdownField","copyLast","count","toConsumableArray","variant","initialPayments","pos","grp","historyLoad","_this8","history_HistoryModal","FormGroup","ControlLabel","FormControl","Static","history_load","Payments","components_paymentsEditor_PaymentsEditor","PaymentSelection","list","listLoad","Badge","accountsTooltipTable","dt","showdate","findIndexInArray","trs","acc2","colSpan","next_day","prev_day","prevDay","chartPrevDay","day_buttonL_FontAwesome","nextDay","chartNextDay","day_buttonR_FontAwesome","ButtonToday","chartToday","Calculator","changeValue","newRow","clear","rows","sum","marginBottom","margin","calculator_FontAwesome","fontStyle","fontWeight","DetailsPanel","accs","cats","prevHistory","nextHistory","accountLoad","categoryLoad","prevInHistory","nextInHistory","info","day_buttonL","day_buttonR","acc","DetailsPanel_FontAwesome","a_table","hstackfirst","hstacklast","headerNormal","paymentSelection_paymentSelection","buttonToday","headerNarrow","verticalAlign","payments_payments","calculator_calculator","selectedDayOrAccount","SELECTONHOVER","Chart","selectedType","boundingRect","hahlo_ix","hahlo","draw","dateselect","paint_dayselection","legendnames","onmouseover","onmouseover_account","onmouseout","find_ix","chartDatetoDate","tooltip","c3onRendered","timer","chart_config","onrendered","grid","lines","grouped","contents","defaultTitleFormat","defaultValueFormat","onclick","xFormat","duration","names","colors","types","groups","selection","axis","tick","culling","legend","transiting","isTargetToShow","api","ReactDOMServer","renderToStaticMarkup","clearTimeout","selectedDate","substring","daterangeToday","alku","loppu","regions","c3","onMouseOut","class","alku1","loppu1","el","svg","chartLoad","ChartPanel","chart_chart","initials","startDate","endDate","Pie","d3onMouseI","d3onMouseOutI","d3onMouseE","d3onMouseOutE","getBoudingRect","sum_i","sum_e","ratio","order","br","pageXOffset","scrollLeft","clientLeft","OUTER_ARC","lessThan700","lessThan450","total","middlepoint","PI","arc_minus","arc","innerRadius","outerRadius","startAngle","endAngle","arc_plus","arc_space","pieLoad","sl","PiePanel","components_pie_pie","show_view","loadcategories","loadaccounts","loadauditlog","naviShowViewRequestAction","Acc","accounts_accounts","Cat","categories_categories","Log","logs","Content","chartRedraw","pieRedraw","main","main_RangePanel","main_ChartPanel","main_PiePanel","main_DetailsPanel","Content_Acc","Content_Cat","Content_Log","showView","ErrorMessage","dismiss","Alert","onDismiss","VersionInfoResponseAction","port","VersionInfo","GroupId","generatedOk","copyText","execCommand","InputGroup","defaultValue","new_group","MenuBar","generateGroup","showGropId","groupIdShow","newGroup","Navbar","Brand","components_versionInfo_versionInfo","Nav","NavDropdown","eventKey","title","MenuItem","onSelect","divider","groupid_GroupId","PingResponseAction","Ping","setInterval","minHeight","Keydetect","react_keyboard_event_handler_default","handleKeys","onKeyEvent","Onassis","Onassis_Keydetect","components_ping_ping","navi_MenuBar","main_ErrorMessage","main_Content","middleware","thunk","createStore","composeWithDevTools","applyMiddleware","apply","reduxStore","render","es","main_Onassis"],"mappings":"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","file":"static/js/main.51bf0f11.chunk.js","sourcesContent":["var dates = {\r\n    convert:function(d) {\r\n        // Converts the date in d to a date-object. The input can be:\r\n        //   a date object: returned without modification\r\n        //  an array      : Interpreted as [year,month,day]. NOTE: month is 0-11.\r\n        //   a number     : Interpreted as number of milliseconds\r\n        //                  since 1 Jan 1970 (a timestamp) \r\n        //   a string     : Any format supported by the javascript engine, like\r\n        //                  \"YYYY/MM/DD\", \"MM/DD/YYYY\", \"Jan 31 2009\" etc.\r\n        //  an object     : Interpreted as an object with year, month and date\r\n        //                  attributes.  **NOTE** month is 0-11.\r\n        return (\r\n            d.constructor === Date ? d :\r\n            d.constructor === Array ? new Date(d[0],d[1],d[2]) :\r\n            d.constructor === Number ? new Date(d) :\r\n            d.constructor === String ? new Date(d) :\r\n            typeof d === \"object\" ? new Date(d.year,d.month,d.date) :\r\n            NaN\r\n        );\r\n    },\r\n    compare:function(a,b) {\r\n        // Compare two dates (could be of any type supported by the convert\r\n        // function above) and returns:\r\n        //  -1 : if a < b\r\n        //   0 : if a = b\r\n        //   1 : if a > b\r\n        // NaN : if a or b is an illegal date\r\n        // NOTE: The code inside isFinite does an assignment (=).\r\n        return (\r\n            isFinite(a=this.convert(a).valueOf()) &&\r\n            isFinite(b=this.convert(b).valueOf()) ?\r\n            (a>b)-(a<b) :\r\n            NaN\r\n        );\r\n    },\r\n    inRange:function(d,start,end) {\r\n        // Checks if date in d is between dates in start and end.\r\n        // Returns a boolean or NaN:\r\n        //    true  : if d is between start and end (inclusive)\r\n        //    false : if d is before start or after end\r\n        //    NaN   : if one or more of the dates is illegal.\r\n        // NOTE: The code inside isFinite does an assignment (=).\r\n       return (\r\n            isFinite(d=this.convert(d).valueOf()) &&\r\n            isFinite(start=this.convert(start).valueOf()) &&\r\n            isFinite(end=this.convert(end).valueOf()) ?\r\n            start <= d && d <= end :\r\n            NaN\r\n        );\r\n    }\r\n}\r\n\r\nmodule.exports = dates;","const reducer = (state = [], action) => {\r\n // console.log(\"ping reducer: \"+action.type)\r\n  switch (action.type) {\r\n    case 'PING_RESPONSE':\r\n    \t//console.log(\"handling PING_RESPONSE\")\r\n        return Object.assign({}, state, {\r\n            up: action.payload.up,\r\n          })        \r\n    default:\r\n      return state\r\n  }\r\n}\r\nexport default reducer","const reducer = (state = [], action) => {\r\n  //console.log(\"dateRange reducer: \"+action.type)\r\n  switch (action.type) {\r\n    case 'DATE_RANGE_SELECTED':\r\n      //console.log(\"handling DATE_RANGE_SELECTED\")\r\n      return Object.assign({}, state, {\r\n          s: action.payload.s,\r\n          e: action.payload.e\r\n        })\r\n    default:\r\n      return state\r\n  }\r\n}\r\nexport default reducer","const reducer = (state = [], action) => {\r\n  //console.log(\"minibars reducer: \"+action.type)\r\n  switch (action.type) {\r\n    case 'MINIBARS_REQUEST':\r\n      //console.log(\"handling MINIBARS_REQUEST\")\r\n      return Object.assign({}, state, {\r\n         fetching: true\r\n    })\r\n    case 'MINIBARS_RESPONSE':\r\n//        console.log(\"handling MINIBARS_RESPONSE\")\r\n        return Object.assign({}, state, {\r\n            balances: action.payload.balances,\r\n            fetching: false\r\n          }) \r\n    case 'MINIBARS_REDRAW':\r\n        //console.log(\"handling MINIBARS_REDRAW\")\r\n        return Object.assign({}, state, {\r\n            redraw: action.payload.redraw,\r\n        })\r\n    default:\r\n      return state\r\n  }\r\n}\r\nexport default reducer","const reducer = (state = [], action) => {\r\n  //console.log(\"chart reducer: \"+action.type)\r\n  switch (action.type) {\r\n    case 'CHART_REQUEST':\r\n      return Object.assign({}, state, {\r\n         fetching: true\r\n    })\r\n    case 'CHART_RESPONSE':\r\n        return Object.assign({}, state, {\r\n            curves: action.payload.curves,\r\n            fetching: false\r\n    }) \r\n    case 'CHART_NEXTDAY':\r\n        //console.log(\"handling CHART_NEXTDAY\")\r\n        return Object.assign({}, state, {\r\n            nextday: action.payload.nextday,\r\n          })\r\n    case 'CHART_PREVDAY':\r\n        //console.log(\"handling CHART_PREVDAY\")\r\n        return Object.assign({}, state, {\r\n            prevday: action.payload.prevday,\r\n          })  \r\n    case 'CHART_TODAY':\r\n        //console.log(\"handling CHART_TODAY\")\r\n        return Object.assign({}, state, {\r\n            today: action.payload.today,\r\n          })\r\n    case 'CHART_REDRAW':\r\n        //console.log(\"handling CHART_REDRAW\")\r\n        return Object.assign({}, state, {\r\n            redraw: action.payload.redraw,\r\n        })\r\n    default:\r\n      return state\r\n  }\r\n}\r\nexport default reducer","const reducer = (state = [], action) => {\r\n // console.log(\"pie reducer: \"+action.type)\r\n  switch (action.type) {\r\n    case 'PIE_REQUEST':\r\n      //console.log(\"handling PIE_REQUEST\")\r\n      return Object.assign({}, state, {\r\n         fetching: true\r\n    })\r\n    case 'PIE_RESPONSE':\r\n        //console.log(\"handling PIE_RESPONSE\")\r\n        return Object.assign({}, state, {\r\n            slices: action.payload.slices,\r\n            fetching: false\r\n          })\r\n    case 'PIE_REDRAW':\r\n        //console.log(\"handling PIE_REDRAW\")\r\n        return Object.assign({}, state, {\r\n            redraw: action.payload.redraw,\r\n        })\r\n    default:\r\n      return state\r\n  }\r\n}\r\nexport default reducer","const reducer = (state = [], action) => {\r\n  //console.log(\"payments reducer: \"+action.type)\r\n  switch (action.type) {\r\n    case \"PAYMENTS_REQUEST\":\r\n    case \"PAYMENTS_UPDATE_REQUEST\":\r\n      return Object.assign({}, state, {\r\n         fetching: true\r\n    })\r\n    case \"PAYMENTS_RESPONSE\":\r\n      //console.log(action)\r\n      return Object.assign({}, state, {\r\n    \t fetching: false,\r\n    \t    queryType: action.payload.queryType,\r\n    \t    params: action.payload.params,\r\n         payments: action.payload.payments,\r\n         balances: action.payload.balances,\r\n         historystack: action.payload.historystack\r\n       })\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nexport default reducer","const reducer = (state = [], action) => {\r\n  //console.log(\"payment reducer: \"+action.type)\r\n  switch (action.type) {\r\n    case 'LOCK_PAYMENT_RESPONSE':\r\n     // console.log(\"handling LOCK_PAYMENT_RESPONSE\")\r\n      return Object.assign({}, state, {\r\n    \t  payment: action.payload.payment,\r\n        //locked: action.payload.locked\r\n       })\r\n    case 'LOCK_PAYMENT_REQUEST':\r\n       // console.log(\"handling LOCK_PAYMENT_REQUEST\")\r\n        return Object.assign({}, state, {\r\n      \tlock_payment_request: action.payload.lock_payment_request,\r\n          locked: action.payload.locked\r\n         })       \r\n    case 'PAYMENT_SELECTION':\r\n        //console.log(\"handling PAYMENT_SELECTION\")\r\n        return Object.assign({}, state, {\r\n        \tpayments: action.payload.payments\r\n        }) \r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nexport default reducer","const reducer = (state = [], action) => {\r\n // console.log(\"constants reducer: \"+action.type)\r\n  switch (action.type) {\r\n    case \"CONSTANTS_REFRESH\":\r\n      console.log(\"handling CONSTANTS_REFRESH\")\r\n      return Object.assign({}, state, {\r\n    \t refreshTime : action.payload.refreshTime,\r\n         constants: action.payload.constants\r\n       })\r\n       \r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nexport default reducer","const reducer = (state = [], action) => {\r\n // console.log(\"accounts reducer: \"+action.type)\r\n  switch (action.type) {\r\n    case \"ACCOUNTS_REQUEST\":\r\n      //console.log(\"handling ACCOUNTS_REQUEST\")\r\n      return Object.assign({}, state, {\r\n         fetching: true\r\n    })\r\n    case \"ACCOUNTS_RESPONSE\":\r\n      //console.log(\"handling ACCOUNTS_RESPONSE\")\r\n      return Object.assign({}, state, {\r\n    \t fetching: false,\r\n         accounts: action.payload.accounts,\r\n       })\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nexport default reducer","const reducer = (state = [], action) => {\r\n // console.log(\"accounts reducer: \"+action.type)\r\n  switch (action.type) {\r\n    case \"CATEGORIES_REQUEST\":\r\n      //console.log(\"handling CATEGORIES_REQUEST\")\r\n      return Object.assign({}, state, {\r\n         fetching: true\r\n    })\r\n    case \"CATEGORIES_RESPONSE\":\r\n      //console.log(\"handling CATEGORIES_RESPONSE\")\r\n      return Object.assign({}, state, {\r\n    \t fetching: false,\r\n         categories: action.payload.categories,\r\n       })\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nexport default reducer","const reducer = (state = [], action) => {\r\n // console.log(\"chart reducer: \"+action.type)\r\n  switch (action.type) {\r\n    case 'SHOW_VIEW':\r\n        //console.log(\"handling SHOW_VIEW\")\r\n        return Object.assign({}, state, {\r\n            view: action.payload.view,\r\n          })        \r\n    default:\r\n      return state\r\n  }\r\n}\r\nexport default reducer","const reducer = (state = [], action) => {\r\n // console.log(\"accounts reducer: \"+action.type)\r\n  switch (action.type) {\r\n    case \"AUDITLOG_REQUEST\":\r\n      //console.log(\"handling AUDITLOG_REQUEST\")\r\n      return Object.assign({}, state, {\r\n         fetching: true\r\n    })\r\n    case \"AUDITLOG_RESPONSE\":\r\n      //console.log(\"handling AUDITLOG_RESPONSE\")\r\n      return Object.assign({}, state, {\r\n    \t fetching: false,\r\n         logentries: action.payload.logentries,\r\n         firstpage: action.payload.firstpage,\r\n         lastpage: action.payload.lastpage\r\n       })\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nexport default reducer","const reducer = (state = [], action) => {\r\n    switch (action.type) {\r\n\r\n\t    case 'SHOW_ERROR':\r\n\t        return Object.assign({}, state, {\r\n\t            status: action.payload.status,\r\n\t            msg: action.payload.msg,\r\n\t            when: action.payload.when\r\n\t        })\r\n\t        \r\n\t    default:\r\n\t        return state\r\n    }\r\n}\r\n\r\nexport default reducer","const reducer = (state = [], action) => {\r\n // console.log(\"group reducer: \"+action.type)\r\n  switch (action.type) {\r\n    case \"NEW_GROUP_REQUEST\":\r\n      //console.log(\"handling NEW_GROUP_REQUEST\")\r\n      return Object.assign({}, state, {\r\n         fetching: true\r\n    })\r\n    case \"NEW_GROUP_RESPONSE\":\r\n      //console.log(\"handling NEW_GROUP_RESPONSE\")\r\n      return Object.assign({}, state, {\r\n    \t fetching: false,\r\n         g: action.payload.g,\r\n       })\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nexport default reducer","const reducer = (state = [], action) => {\r\n // console.log(\"group reducer: \"+action.type)\r\n  switch (action.type) {\r\n    case \"CALC_ADD_REQUEST\":\r\n      //console.log(\"handling CALC_ADD_REQUEST\")\r\n      return Object.assign({}, state, {\r\n         p: action.payload.p,\r\n         ts: Date.now()\r\n       })\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nexport default reducer","const reducer = (state = [], action) => {\r\n  switch (action.type) {\r\n    case 'NEXTDAY':\r\n        return Object.assign({}, state, {\r\n            nextday: action.payload.nextday,\r\n          })\r\n    case 'PREVDAY':\r\n        return Object.assign({}, state, {\r\n            prevday: action.payload.prevday,\r\n          })  \r\n    case 'TODAY':\r\n        return Object.assign({}, state, {\r\n            today: action.payload.today,\r\n          })\r\n    default:\r\n      return state\r\n  }\r\n}\r\nexport default reducer","const reducer = (state = [], action) => {\r\n // console.log(\"versionInfo reducer: \"+action.type)\r\n  switch (action.type) {\r\n    case 'VERSIONINFO_RESPONSE':\r\n    \t//console.log(\"handling VERSIONINFO_RESPONSE\")\r\n        return Object.assign({}, state, {\r\n            version: action.payload.version\r\n          })        \r\n    default:\r\n      return state\r\n  }\r\n}\r\nexport default reducer","import { combineReducers } from 'redux'\r\n\r\nimport ping from './ping'\r\nimport daterange from './daterange'\r\nimport minibars from './minibars'\r\nimport chart from './chart'\r\nimport pie from './pie'\r\nimport payments from './payments'\r\nimport payment from './payment'\r\nimport constants from './constants'\r\nimport accounts from './accounts'\r\nimport categories from './categories'\r\nimport navi from './navi'\r\nimport auditlog from './auditlog'\r\nimport errorMessage from './errorMessage'\r\nimport group from './group'\r\nimport calculator from './calculator'\r\nimport day from './day'\r\nimport versionInfo from './versionInfo'\r\n\r\nconst rootReducer = combineReducers({\r\n  ping,\r\n  daterange,\r\n  minibars,\r\n  chart,\r\n  pie,\r\n  payments,\r\n  payment,\r\n  constants,\r\n  accounts,\r\n  categories,\r\n  navi,\r\n  auditlog,\r\n  errorMessage ,\r\n  group,\r\n  calculator,\r\n  day,\r\n  versionInfo\r\n})\r\n\r\nexport default rootReducer","const showErrorAction = (status, msg, when) => ({\r\n    type: 'SHOW_ERROR',\r\n    payload: {\r\n        \"status\": status,\r\n        \"msg\": msg,\r\n        \"when\": when\r\n    }\r\n})\r\n\r\nconst showError = (status, msg) => (\r\n    (dispatch) => {\r\n        dispatch(showErrorAction(status, msg, Date.now()))\r\n    }\r\n)\r\n\r\nconst show_error = (error, dispatch) => {\r\n    if (error.response && error.response.data) {\r\n        dispatch(showError(error.response.status, error.response.data.error_message))\r\n    } else {\r\n        dispatch(showError('not known', error.message))\r\n    }\r\n}\r\n\r\nexport {\r\n    show_error\r\n}","import axios from 'axios';\r\nimport { show_error } from './errorMessage'\r\n//const HOST = 'http://localhost:8080/'\r\n\r\nfunction parseUrl( url ) {\r\n    var a = document.createElement('a');\r\n    a.href = url;\r\n    return a;\r\n}\r\n\r\nvar HOST = 'http://'+parseUrl(document.URL).hostname + ':8080/'\r\n\r\nfunction _contextUrl(ctx_path, params) {\r\n  return ctx_path + '?' + (null == params ? \"\" : params + '&') + 'ts=' + Date.now()\r\n}\r\n\r\nfunction axios_get(ctx_path, params, f, dispatch) {\r\n  var contextUrl = _contextUrl(ctx_path, params)\r\n\taxios.get(HOST + contextUrl)\r\n            .then(f)\r\n            .catch(error => { show_error(error, dispatch) })\t\t\r\n}\r\n\r\nfunction axios_get_params(ctx_path, params, f, dispatch) {\r\n  var contextUrl = _contextUrl(ctx_path, null)\r\n\taxios.get(HOST + contextUrl, params)\r\n            .then(f)\r\n            .catch(error => { show_error(error, dispatch) })\t\r\n}\r\n\r\nfunction axios_post(ctx_path, payload, f, dispatch) {\r\n\taxios.post(HOST + ctx_path, payload)\r\n            .then(f)\r\n            .catch(error => { show_error(error, dispatch) })\t\r\n}\r\n\r\n\r\nexport {HOST, axios_get, axios_get_params, axios_post}","import {HOST} from './axios';\r\n//var request = require('sync-request');\r\nimport request from 'then-request';\r\n\r\nconst CONSTANTS_REFRESH = 'CONSTANTS_REFRESH'\r\nconst constantsRefreshAction = (constants) => ({\r\n    type: CONSTANTS_REFRESH,\r\n    payload: {\r\n    \t\"refreshTime\" : (new Date()).getTime(),\r\n        \"constants\": constants\r\n    }\r\n})\r\n\r\nvar constants = {}\r\nvar fetching = {}\r\n\r\nconst invalidate = (id, dispatch) => {\r\n\tconstants[id] = null\r\n\tfetching[id] = null\r\n\tget_constants(id, dispatch)\r\n}\r\n\r\n// async function defined\r\nasync function makeSynchronousRequest(id) {\r\n\ttry {\r\n\t\t// http_promise is a Promise\r\n\t\t// \"response_body\" will hold the response if the Promise is resolved\r\n\t\tlet res = await request('GET', HOST + 'constants?id=' + id + '&ts='+Date.now());\r\n\t\tdebugger;\r\n\t\t//return res\r\n\t}\r\n\tcatch(e) {\r\n\t\t// if the Promise is rejected\r\n\t\tconsole.error(e);\r\n\t}\r\n}\r\n/*const get_constants = (id, dispatch) => {\r\n\t    if(!constants[id]) {\r\n\t    \tvar res = request('GET', HOST + 'constants?id=' + id + '&ts='+Date.now());\r\n\t    \t//TODO what if fails?\r\n\t    \tvar json = JSON.parse(res.getBody('utf8'));\r\n\t        constants[id] = json\r\n\t    }\r\n\t    dispatch(constantsRefreshAction(constants))\r\n\t    return null;\r\n}*/\r\nconst get_constants = (id, dispatch) => {\r\n        //console.log(\"GET: \"+ id);\r\n\t    if(!constants[id] && !fetching[id] ) {\r\n\t        fetching[id] = true;\r\n\t        //console.log(\"FETCHING START: \"+ id);\r\n\t    \t//var res = request('GET', HOST + 'constants?id=' + id + '&ts='+Date.now());\r\n            //var res = makeSynchronousRequest(id);\r\n\t    \trequest('GET', HOST + 'constants?id=' + id + '&ts='+Date.now()).done((res) => {\r\n\t    \t  //console.log(\"FETCHIN END: \"+ id);\r\n\t    \t  //debugger\r\n              //console.log(res.getBody());\r\n              var json = JSON.parse(res.getBody('utf8'));\r\n              constants[id] = json\r\n              dispatch(constantsRefreshAction(constants))\r\n            });\r\n\t    } else {\r\n\t        //console.log(\"IS OR FETCHING: \"+ id);\r\n\t        if(constants[id]) {\r\n\t            //console.log(\"FOUND: \" + id);\r\n\t            dispatch(constantsRefreshAction(constants))\r\n\t            return null;\r\n\t        }\r\n\t        //console.log(\"SKIP: \" + id);\r\n\t        return null;\r\n\t    }\r\n}\r\n \r\nexport {\r\n    get_constants,\r\n    invalidate\r\n}","import {axios_get, axios_post} from './axios';\r\nimport { invalidate } from './constants'\r\n\r\nconst CATEGORY = 'cat'\r\n\t\r\nconst CATEGORIES_REQUEST = 'CATEGORIES_REQUEST'\r\nconst categoriesRequestAction = () => ({\r\n    type: CATEGORIES_REQUEST\r\n})\r\n\r\nconst CATEGORIES_RESPONSE = 'CATEGORIES_RESPONSE'\r\nconst categoriesResponseAction = (categories) => ({\r\n    type: CATEGORIES_RESPONSE,\r\n    payload: {\r\n        \"categories\": categories\r\n    }\r\n})\r\n\r\nconst CATEGORIES_UPDATE_REQUEST = 'CATEGORIES_UPDATE_REQUEST'\r\nconst categoriesUpdateRequestAction = (updates) => ({\r\n    type: CATEGORIES_UPDATE_REQUEST,\r\n    payload: {\r\n    \t\"updates\": updates\r\n    }\r\n})\r\n\r\nconst CATEGORIES_UPDATE_RESPONSE = 'CATEGORIES_UPDATE_RESPONSE'\r\nconst categoriesUpdateResponseAction = () => ({\r\n    \ttype: CATEGORIES_UPDATE_RESPONSE\r\n})\r\n\r\nconst update = (updates) => (\r\n    (dispatch) => {\r\n        dispatch(categoriesUpdateRequestAction(updates))\r\n        axios_post('cat/update', updates,\r\n            (response) => {\r\n               dispatch(categoriesUpdateResponseAction())\r\n               dispatch(load())\r\n               invalidate(CATEGORY, dispatch)\r\n            },\r\n            dispatch\r\n        )\r\n    }\r\n )\r\n\r\n const load = () => (\r\n    (dispatch) => {\r\n        dispatch(categoriesRequestAction())\r\n        axios_get('cat/list',\r\n            null,\r\n            response => {\r\n               dispatch(categoriesResponseAction(response.data))\r\n            },\r\n            dispatch\r\n        )\r\n    }\r\n )\r\n \r\nexport {\r\n\tCATEGORY,\r\n    load,\r\n    update\r\n}","import React from 'react';\r\n\r\nconst normalizeCurrency = value => {\r\n    if (!value) {\r\n        return value\r\n    }\r\n    if (value === \"-\" || value === \"+\") {\r\n        value += \"0\"\r\n    }\r\n    var plus = value.lastIndexOf('+');\r\n    var minus = value.lastIndexOf('-');\r\n\r\n    value = value.replace(/[^\\d]/g, '')\r\n    if (value === \"\") {\r\n        value = \"0\"\r\n    }\r\n    value = \"\" + parseInt(value, 10);\r\n    if (value.length < 3) {\r\n        value = \"00\".slice(-3 + value.length) + value\r\n    }\r\n\r\n    var res = (plus >= minus ? '+' : '-') + value.slice(0, -2) + \".\" + value.slice(-2)\r\n    return res;\r\n}\r\n\r\nclass CurrencyField extends React.Component {\r\n\r\n\tconstructor(props) {\r\n        super(props)\r\n        this.state = {\r\n        \tcurrencyValue : props.value\r\n        }\r\n\t\tthis.onChange = this.onChange.bind(this)\r\n\t\tthis.handleFocus = this.handleFocus.bind(this)\r\n\t\t\r\n\t\t\r\n    }\r\n\t\r\n\thandleFocus(event) {\r\n\t\t  event.target.select();\r\n\t}\r\n\r\n\tonChange(e) {\r\n\t\t\r\n\t\tconst {onValueChanged, field, index} = this.props\r\n\t\tvar newCurrencyValue = normalizeCurrency(e.target.value)\r\n\t\tthis.setState({\r\n\t\t\tcurrencyValue : newCurrencyValue\r\n\t\t})\r\n\t\tonValueChanged(newCurrencyValue, field, index)\r\n\r\n\t}\r\n\t\r\n\tcomponentWillReceiveProps(nextprops) {\r\n\t\tthis.setState({\r\n\t\t\tcurrencyValue : nextprops.value\r\n\t\t})\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tconst {id, readOnly, placeholder, touched, fontSize} = this.props\r\n\r\n\t\treturn (\r\n\t    <div>\r\n\t\t\t<input\r\n        autoFocus\r\n\t\t\t  onFocus={this.handleFocus}\r\n\t\t\t  autoComplete='off'\r\n\t\t\t  id={id}\r\n\t\t\t  disabled={readOnly}\r\n\t\t\t  value={this.state.currencyValue}\r\n\t\t\t  onChange={this.onChange}\r\n\t          placeholder={readOnly ? '' : placeholder}  \r\n\t          type=\"text\"\r\n\t          className=\"form-control\" \r\n\t    \t  style={{\r\n\t    \t\t  'fontSize': fontSize,\r\n\t    \t\t  'textAlign': 'right', \r\n\t    \t\t  //'color' : this.state.currencyValue && this.state.currencyValue.startsWith('-') ? 'red' : 'green',\r\n\t    \t\t  'color' : this.state.currencyValue && (this.state.currencyValue.substr(0,1) === '-') ? 'red' : 'green',\r\n\t    \t\t  'display': 'inline',\r\n\t    \t\t  'width': '85px',\r\n\t    \t\t  'backgroundColor' : (touched ? 'lightyellow' : '')\r\n\t    \t  }} \r\n\t      />\r\n\t    </div>) \r\n\t}\t\r\n}\r\n\r\nCurrencyField.defaultProps = {\r\n\t\tid: null,\r\n\t\tonValueChanged: null,\r\n\t\tplaceholder : '',\r\n\t\tvalue : '',\r\n\t\treadOnly : false,\r\n\t\tfield: null,\r\n\t\tindex: null,\r\n\t\ttouched: false,\r\n\t\tfontSize: 'inherit'\r\n}\r\n\r\nexport default CurrencyField","import React from 'react'\r\nimport './checkbox.css'\r\n\r\nclass CheckboxField extends React.Component {\r\n\trender() {\r\n\t\tconst {id, readOnly, field, index, onValueChanged, touched, checked} = this.props\r\n\t\treturn(\r\n\t\t<div>\r\n\t\t\t<span style = {{display: \"flex\", width: '20px'}}>\r\n\t\t\t\t<div >\r\n\t\t\t\t\t<input \r\n\t\t\t\t\t\tname = {id}\r\n\t\t\t\t\t\ttype = 'checkbox' \r\n\t\t\t\t\t\tdisabled = {readOnly}\r\n\t\t\t\t\t    id = {id}  \r\n\t\t\t\t\t\tchecked = {checked}\r\n\r\n\t\t\t\t\t\tonChange = {(e) => onValueChanged(e.target.checked, field, index)}\r\n\t\t\t\t\t\tstyle = { readOnly ? {backgroundColor: 'lightgray', borderColor: 'lightgray'} : \r\n\t\t\t\t\t\t\t         (touched ? {backgroundColor: 'darkKhaki', borderColor: 'darkKhaki'} : {})}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t</span>\r\n\t\t</div>)\r\n\t}\t\r\n}\r\n\r\nCheckboxField.defaultProps = {\r\n\t\tid : null,\r\n\t\tonValueChanged : null,\r\n\t\tchecked : true,\r\n\t\treadOnly : false,\r\n\t\tfield : null,\r\n\t\tindex : null,\r\n\t\ttouched: false\r\n}\r\n\r\nexport default CheckboxField","import React from 'react';\r\nimport {Button} from 'react-bootstrap'\r\nvar FontAwesome = require('react-fontawesome');\r\n\r\nclass TextField extends React.Component {\r\n\r\n\tconstructor(props) {\r\n        super(props)\r\n        this.state = {\r\n        \ttxtValue : props.value\r\n        }\r\n        this.onChange = this.onChange.bind(this)\r\n    }\r\n\t\r\n\tonChange(e) {\r\n\t\tconst {onValueChanged, field, index} = this.props\r\n\t\tthis.setState({\r\n\t\t\ttxtValue : e.target.value\r\n\t\t})\r\n\t\tonValueChanged(e.target.value, field, index)\r\n\t}\r\n\r\n\tcomponentWillReceiveProps(nextprops) {\r\n\t\tthis.setState({\r\n\t\t\ttxtValue : nextprops.value\r\n\t\t})\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tconst {id, placeholder, readOnly, touched, linkCb, maxLength} = this.props\r\n\t\t\r\n\t\tvar button = linkCb && this.state.txtValue && this.state.txtValue.length > 0?\r\n\t\t\t\t<Button bsSize=\"small\" onClick={ () => {\r\n\t\t\t\t\tlinkCb(this.state.txtValue)}\r\n\t\t\t\t}>\r\n\t\t\t\t<FontAwesome name='caret-right' />\r\n      \t\t\t</Button>\r\n\t\t:\r\n\t\tnull\r\n\t\t\r\n\t\treturn(\r\n\t    <div>\r\n\t    \t<span style={{display: \"inline-flex\"}}>\r\n\t    \t<input \r\n\t    \t\tmaxLength={maxLength}\r\n\t    \t    id={id}\r\n\t    \t\tvalue={this.state.txtValue}\r\n\t    \t    disabled={readOnly}\r\n\t    \t    style={{'backgroundColor' : (touched ? 'lightyellow' : '')}}\r\n\t    \t\tplaceholder={readOnly ? '' : placeholder} \r\n\t    \t\ttype=\"text\" \r\n\t    \t\tautoComplete='off'\r\n\t    \t\tonChange={this.onChange}\r\n\t    \t\tclassName=\"form-control\"\r\n\t    \t/>\r\n\t    \t{button}\r\n\t    \t</span>\r\n\t    </div>)\r\n\t}\t\r\n}\r\n\r\nTextField.defaultProps = {\r\n\t\tid: null,\r\n\t\tplaceholder: '',\r\n\t\tonValueChanged: null,\r\n\t\tvalue : '',\r\n\t\treadOnly : false,\r\n\t\tfield: null,\r\n\t\tindex: null,\r\n\t\ttouched: false,\r\n\t\tlinkCb: null,\r\n\t\tmaxLength: 255\r\n}\r\n\r\nexport default TextField","\r\nimport React from 'react'\r\nimport reactCSS from 'reactcss'\r\nimport { SketchPicker } from 'react-color'\r\n\r\nclass ColorField extends React.Component {\r\n\tconstructor(props) {\r\n        super(props)\r\n        this.state = {\r\n        \tdisplayColorPicker: false,\r\n        \tcolor: props.color\r\n        }\r\n    }\r\n\t\r\n\tcomponentWillReceiveProps(nextprops) {\r\n\t\tthis.setState({\r\n\t\t\tcolor : nextprops.color\r\n\t\t})\r\n\t}\r\n\r\n\thandleClick = () => {\r\n\t\tif (!this.props.readOnly )\r\n\t\tthis.setState({ displayColorPicker: !this.state.displayColorPicker })\r\n\t};\r\n\t\r\n\thandleClose = () => {\r\n\t    this.setState({ displayColorPicker: false })\r\n\t};\r\n\r\n\thandleChange = (color) => {\r\n\t  const {onValueChanged, field, index} = this.props\r\n\t  this.setState({ \r\n\t\t  color: color.hex,\r\n\t      displayColorPicker: !this.state.displayColorPicker\r\n\t  })\r\n\t  onValueChanged(color.hex, field, index)\r\n   }\r\n\r\n  render() {\r\n\r\n    const styles = reactCSS({\r\n      'default': {\r\n        color: {\r\n          width: '28px',\r\n          height: '24px',\r\n          borderRadius: '4px',\r\n          background: this.state.color\r\n        },\r\n        swatch: {\r\n          padding: '5px',\r\n          background: (this.props.touched ? 'lightyellow' : '#fff'),\r\n          borderRadius: '4px',\r\n          boxShadow: '0 0 0 1px rgba(0,0,0,' + (this.props.readOnly ? '0' : '.1')+ ')',\r\n          display: 'inline-block',\r\n          cursor: (this.props.readOnly ? '' : 'pointer'),\r\n        },\r\n        popover: {\r\n          position: 'relative',\r\n          zIndex: '2',\r\n        },\r\n        cover: {\r\n          position: 'fixed',\r\n          top: '0px',\r\n          right: '0px',\r\n          bottom: '0px',\r\n          left: '0px',\r\n        },\r\n      },\r\n    });\r\n\r\n    return (\r\n      <div>\r\n        <div style={ styles.swatch } onClick={ this.handleClick }>\r\n          \t<div style={ styles.color } />\r\n        </div>\r\n        { this.state.displayColorPicker ? \r\n        \t\t<div style={ styles.popover }>\r\n          \t\t\t<div style={ styles.cover } \r\n          \t\t\t\tonClick={ this.handleClose }\r\n          \t\t\t/>\r\n          \t\t\t<SketchPicker \r\n          \t\t\t\tcolor={ this.state.color } \r\n          \t\t\t\tonChange={ this.handleChange } \r\n          \t\t\t/>\r\n          \t\t</div> \r\n          : null \r\n        }\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nColorField.defaultProps = {\r\n\t\tid: null,\r\n\t\tonValueChanged: null,\r\n\t\tcolor : 'red',\r\n\t\treadOnly : false,\r\n\t\tfield: null,\r\n\t\tindex: null,\r\n\t\ttouched: false,\r\n}\r\n\r\nexport default ColorField","var alertOptions = {\r\n\t\t\t    offset: 14,\r\n\t\t\t    position: 'bottom right',\r\n\t\t\t    theme: 'light',\r\n\t\t\t    time: 5000,\r\n\t\t\t    transition: 'scale'\r\n\t\t\t  }\r\n\t\t  \t\t\t  \r\nexport  default alertOptions","// c represents currency\r\nfunction currencyFormat(c) {\r\n\treturn parseFloat(Math.round(c* 100) / 100).toFixed(2)\r\n}\r\n\r\nexport default currencyFormat","import currencyFormat  from '../../util/currency'\r\n\r\nconst fields = ['color','descr','i','active']\r\n\r\nconst defaultValues = {\r\n\tid: null,\r\n\ti: \"+0.00\",\r\n\tactive: true,\r\n\tdescr: '',\r\n\tcolor: 'blue'\r\n}\r\n\r\nconst validators = {\r\n\t'i': (value) => {\r\n\t\t\treturn null\r\n\t\t  },\r\n\t'active': (value) => {\r\n\t\t\treturn null\r\n\t\t },\r\n\t'descr':  (value) => {\r\n\t\t\treturn (value !== '') ? null : 'required'\r\n\t\t  },\r\n\t'color': (value) => {\r\n\t\t\treturn (value !== '') ? null : 'required'\r\n\t\t  }\r\n}\r\n\r\nfunction preInitFormat(categories) {\r\n\tvar copy = deepCopy(categories)\r\n\tcopy.forEach((c) => {\r\n\t\t// 2 -> +2.00\r\n\t\tc.i =  (c.i >=0 ? '+' : '') + currencyFormat(c.i)\r\n\t})\r\n\treturn copy\r\n}\r\n\r\nfunction preSubmitFormat(payments) {\r\n\tpayments.forEach( (p) => {\r\n\t\tif(p.i) {\r\n\t\t\t// \"+2.00\" -> 2\r\n\t\t\tp.i =  parseFloat(p.i)\r\n\t\t\t//p.i_initial = parseFloat(p.i_initial)\r\n\t\t }\r\n\t})\r\n\treturn payments\r\n}\r\n\r\n\r\nfunction copyObject(b) {\r\n\treturn {\r\n\t\tid: b,\r\n\t\ti: b,\r\n\t\tactive: b,\r\n\t\tdescr: b,\r\n\t\tcolor: b\r\n\t}\r\n}\r\n\r\nfunction copyCategory(category, index = null) {\r\n\treturn {\r\n\t\t'index': index,\r\n\t\tid: category.id,\r\n\t\ti: category.i,\r\n\t\tactive: category.active,\r\n\t\tdescr: category.descr,\r\n\t\tcolor: category.color\r\n\t}\r\n}\r\n\r\nfunction  deepCopy(payments) {\r\n\tvar copy = []\r\n\tpayments.forEach(\r\n\t\t(p) => {copy.push(copyCategory(p))}\r\n\t)\r\n\treturn copy\r\n}\r\n\r\nfunction initState(categories) {\r\n\tvar copy = {\r\n\t\tvalues : [],\r\n\t\tinitial : [],\r\n\t\terrors : [],\r\n\t\ttouched : [],\r\n\t\tdeleted : [],\r\n\t\tsort: null,\r\n\t\tasc: true\r\n\t}\r\n\tcategories.forEach((p, index) => {\r\n\t\tcopy.values.push(copyCategory(p, index))\r\n\t\tcopy.initial.push(copyCategory(p))\r\n\t\tcopy.errors.push(copyObject(null))\r\n\t\tcopy.touched.push(copyObject(false))\r\n\t\tcopy.deleted.push(false)\r\n\t})\r\n\treturn copy\r\n}\r\n\r\nfunction oneIsTrue(row) {\r\n\tvar ret =\r\n\t\trow.i ||\r\n\t\trow.active ||\r\n\t\trow.descr ||\r\n\t\trow.color \r\n\treturn ret\r\n}\r\n\r\nfunction activeIsRo(row) {\r\n\tvar ret =\r\n\t\trow.i ||\r\n\t\trow.descr ||\r\n\t\trow.color \r\n\treturn ret\r\n}\r\nfunction copyArray(array) {\r\n\treturn array.splice(0)\r\n}\r\n\r\nexport {\r\n\tfields,\r\n\tinitState,\r\n\tdefaultValues,\r\n\tvalidators,\r\n\tpreInitFormat,\r\n\tpreSubmitFormat,\r\n\toneIsTrue,\r\n\tcopyArray,\r\n\tactiveIsRo\r\n}","import React from 'react'\r\nimport { connect } from 'react-redux'\r\nimport { Table, Panel, Button } from 'react-bootstrap';\r\n\r\nimport { update } from '../../actions/categories'\r\n\r\nimport CurrencyField from '../editorFields/CurrencyField'\r\nimport CheckboxField from '../editorFields/CheckboxField'\r\nimport TextField from '../editorFields/TextField'\r\nimport ColorField from '../editorFields/ColorField'\r\n\r\nimport './CategoriesEditor.css'\r\nimport '../../customMultiSelect.css'\r\n\r\n\r\nimport AlertContainer from 'react-alert'\r\nimport alertOptions from '../../util/alertoptions'\r\n\r\n\r\n//import { withMedia } from 'react-media-query-hoc';\r\n\r\nimport {\r\n\t\tfields,\r\n\t\tinitState,\r\n\t\tdefaultValues, \r\n\t\tvalidators,\r\n\t\tpreInitFormat,\r\n\t\tpreSubmitFormat,\r\n\t\toneIsTrue,\r\n\t\tcopyArray,\r\n\t\tactiveIsRo\r\n} from './constants'\r\n\r\nvar FontAwesome = require('react-fontawesome')\r\n\r\nvar tempId = -1\r\n\r\nclass CategoriesEditor extends React.Component {\r\n    constructor(props) {\r\n        super(props)\r\n        //postfix -abbr. F = Field, R = Row, T = Table\r\n        this.showOk = this.showOk.bind(this)\r\n        //Field related:\r\n        \r\n        //callbacks from uicomponents for updating model (state)\r\n        this.changePropertyF = this.changePropertyF.bind(this)\r\n        this.changePropertyDeletedF = this.changePropertyDeletedF.bind(this)\r\n        \r\n        //set state values:\r\n        this.setValueF = this.setValueF.bind(this)\r\n        \r\n        //validate:\r\n        this.validateF = this.validateF.bind(this)\r\n        \r\n        //some field related util;\r\n        this.touchedF = this.touchedF.bind(this) //dirty?\r\n        this.isDifferentFromInitialF = this.isDifferentFromInitialF.bind(this)        \r\n\r\n        //choose right value for render\r\n        this.chooseValueF = this.chooseValueF.bind(this)\r\n\r\n        //render\r\n        this.renderContentF = this.renderContentF.bind(this)\r\n        this.renderDeletedContentF = this.renderDeletedContentF.bind(this)\r\n        \r\n        //sort\r\n        this.setSortF = this.setSortF.bind(this)\r\n        this.sortersF = this.sortersF.bind(this)\r\n        \r\n        //Row related:\r\n        \r\n        //add/remove\r\n        this.addR = this.addR.bind(this)\r\n        this.getDefaultR = this.getDefaultR.bind(this) //choose values for new row\r\n        this.removeR = this.removeR.bind(this)\r\n\r\n        //validate\r\n        this.validateR = this.validateR.bind(this)\r\n        this.readOnlyR = this.readOnlyR.bind(this)\r\n        \r\n        //utils\r\n        this.isPersistedR = this.isPersistedR.bind(this)\r\n\r\n        //render\r\n        this.renderCategoryR = this.renderCategoryR.bind(this)\r\n\r\n        //Table related:\r\n        this.resetT =  this.resetT.bind(this)\r\n        //util\r\n        this.isPristineT = this.isPristineT.bind(this)\r\n        this.hasErrorsT = this.hasErrorsT.bind(this)\r\n        \r\n        //format input/output\r\n        this.preInitT = this.preInitT.bind(this)\r\n        this.preSubmitT = this.preSubmitT.bind(this)\r\n        \r\n        //init constants\r\n        this.init =  this.init.bind(this)\r\n        //render\r\n        this.renderCategoriesT = this.renderCategoriesT.bind(this)\r\n\r\n        //css and stuff\r\n        this.tdClassName = this.tdClassName.bind(this)\r\n        this.td = this.td.bind(this)\r\n        this.thClassName = this.thClassName.bind(this)\r\n        this.th = this.th.bind(this)\r\n        \r\n        this.init()\r\n        this.state = {...initState(this.preInitT(props.initCategories))}\r\n    }\r\n\r\n    changePropertyF(value, field, index) {\r\n    \t//touch\r\n\t\tif (this.isPersistedR(index)) { //new rows do not get 'touched' (unless masked)\r\n\t\t\tvar copy = copyArray(this.state.touched)\r\n\t\t\tcopy[index][field] = this.isDifferentFromInitialF(value, field, index)\r\n\t\t\tthis.setState({touched : copy})\r\n\t\t}\r\n\t\t\r\n\t\t//validate\r\n\t\tthis.validateF(field, value, index)\r\n\r\n    \tthis.setValueF(value, field, index)\r\n    }\r\n    \r\n    changePropertyDeletedF(value, field, index) {\r\n    \tif(this.isPersistedR(index)) { //if it has id, let backend remove: mark as deleted\r\n    \t\tthis.deleteCount += (value ? 1 : -1)\r\n    \t\tvar copy = copyArray(this.state.deleted)\r\n    \t\tcopy[index] = value\r\n    \t\tthis.setState({deleted : copy})\r\n    \t} else {\r\n    \t\tthis.removeR(index) //if newly created, just remove it\r\n    \t}\r\n    }\r\n    \r\n\tsetValueF(value, field, index) {\r\n\t\tvar copy = copyArray(this.state.values)\r\n\t\tcopy[index][field] = value\r\n\t\tthis.setState({values : copy})\r\n\t}\r\n\r\n\tvalidateF(field, value, index) {\r\n\t\tvar original = this.state.errors[index][field]\r\n\t\tvar result = validators[field](value) \r\n\t\tif( result !== original ) {\r\n\t\t\tvar copy = copyArray(this.state.errors)\r\n\t\t\tcopy[index][field] = validators[field](value) \r\n\t\t\tthis.setState({errors : copy})\r\n\t\t}\r\n\t}\r\n\t\r\n\ttouchedF(index, field) {\r\n\t\tif(index<0) return false //mask-controls are never touched (-1 = checkbox -2 = mask value)\r\n\t\tif(this.state.deleted[index]) return false \t//to be deleted: not touched\r\n\t\tif(!this.isPersistedR(index)) return false \t//this is a new row: not touched and not masked\r\n\t\treturn this.state.touched[index][field]\r\n\t}\r\n\t\r\n\tisDifferentFromInitialF(value, field, index) {\r\n\t\treturn (value !== this.state.initial[index][field])\r\n\t}\r\n\r\n\tchooseValueF(index, field) {\r\n\t\tif(this.state.deleted[index]) return this.state.initial[index][field] //show initial values if to be deleted\r\n\t\treturn this.state.values[index][field] \r\n\t}\r\n\t\r\n\trenderContentF(field, index) {\r\n     \t\r\n    \tvar  value = this.chooseValueF(index, field)\r\n    \t\r\n    \tswitch(field) {\r\n    \tcase 'i' :\r\n\t\t\t\t\treturn(\r\n\t\t\t\t  \t<div>\r\n\t\t\t\t  \t\t<CurrencyField \r\n\t\t\t\t\t  \t\tid = {'icat_'+index}\r\n\t\t\t\t\t  \t\tonValueChanged = {this.changePropertyF}\r\n\t\t\t\t\t  \t\tplaceholder = 'amount'\r\n\t\t\t\t\t  \t\tvalue = {value}\r\n\t\t\t\t\t  \t\treadOnly = {this.readOnlyR(index, 'i')}\r\n\t\t\t\t  \t\t\tfield = 'i'\r\n\t\t\t\t  \t\t\tindex = {index}\r\n\t\t\t\t  \t\t\ttouched = {this.touchedF(index, 'i')}\r\n\t\t\t\t\t  \t/>\r\n\t\t\t\t    </div>)\r\n    \tcase 'active' :\r\n\t\t\t\t\treturn(\r\n\t\t\t\t  \t<div>\r\n\t\t\t\t  \t\t<CheckboxField \r\n\t\t\t\t\t  \t\tid = {'activecat_' + index}\r\n\t\t\t\t\t  \t\tonValueChanged = {this.changePropertyF}\r\n\t\t\t\t\t  \t\tchecked = {value}\r\n\t\t\t\t\t  \t\treadOnly = {this.isPersistedR(index) && activeIsRo(this.state.touched[index])}\r\n\t\t\t\t  \t\t\tfield = 'active'\r\n\t\t\t\t  \t\t\tindex = {index}\r\n\t\t\t\t  \t\t\ttouched = {this.touchedF(index, 'active')}\r\n\t\t\t\t\t  \t/>\r\n\t\t\t\t    </div>)\t\t\t\t\t    \r\n    \tcase 'descr' :\r\n\t\t\t\t\treturn(\r\n\t\t\t\t  \t<div>\r\n\t\t\t\t  \t\t<TextField \r\n\t\t\t\t\t  \t\tid = {'descrcat_'+index}\r\n\t\t\t\t\t  \t\tonValueChanged = {this.changePropertyF}\r\n\t\t\t\t\t  \t\tvalue = {value}\r\n\t\t\t\t\t  \t\treadOnly = {this.readOnlyR(index, 'descr')}\r\n\t\t\t\t  \t\t\tfield = 'descr'\r\n\t\t\t\t  \t\t\tindex = {index}\r\n\t\t\t\t  \t\t\ttouched = {this.touchedF(index, 'descr')}\r\n\t\t\t\t  \t\t\tplaceholder = 'name'\r\n\t\t\t\t  \t\t\tmaxLength = {30}\r\n\t\t\t\t\t  \t/>\r\n\t\t\t\t    </div>)\r\n    \tcase 'color' :\r\n\t\t\t\t\treturn(\r\n\t\t\t\t  \t<div>\r\n\t\t\t\t  \t\t<ColorField \r\n\t\t\t\t\t  \t\tid = {'colorcat_'+index}\r\n\t\t\t\t\t  \t\tonValueChanged = {this.changePropertyF}\r\n\t\t\t\t\t  \t\tcolor = {value}\r\n\t\t\t\t\t  \t\treadOnly = {this.readOnlyR(index, 'color')}\r\n\t\t\t\t  \t\t\tfield = 'color'\r\n\t\t\t\t  \t\t\tindex = {index}\r\n\t\t\t\t  \t\t\ttouched = {this.touchedF(index, 'color')}\r\n\t\t\t\t\t  \t/>\r\n\t\t\t\t    </div>)\r\n\t\tdefault: console.log('UNKONWN field: '+field)\r\n\t\t\t  \t   return null\r\n    \t}\r\n    }\r\n\t\r\n\trenderDeletedContentF(index) {\r\n\t\tif(!this.isPersistedR(index)) { \r\n\t\t\treturn(\r\n\t\t\t<button \r\n\t\t  \t\ttype=\"button\" \r\n\t\t  \t\tclassName=\"form-control\"  \r\n\t\t  \t\tonClick={() => this.changePropertyDeletedF(true, 'deleted', index)}>\r\n\t\t  \t\t<FontAwesome name = 'remove' style = {{'color': 'red'}}/>\r\n\t\t    </button>)\r\n\t\t}\r\n\t  \treturn\t\r\n\t\t/*return(\r\n\t  \t<div>\r\n\t  \t\t<CheckboxField \r\n\t\t  \t\tid = {'deletedcat_'+index}\r\n\t\t  \t\tonValueChanged = {this.changePropertyDeletedF}\r\n\t\t  \t\tchecked = {this.state.deleted[index]}\r\n\t  \t\t\tfield = 'deleted'\r\n\t  \t\t\tindex = {index}\r\n\t  \t\t\ttouched = {false}\r\n\t\t  \t/>\r\n\t    </div>)*/\r\n\t}\r\n\t\t\r\n\tsetSortF(field) {\r\n\t\t//console.log(field)\r\n\t\tif(!this.state.sort || this.state.sort !==field) {\r\n\t\t\tthis.setState({\r\n\t\t\t\tsort : field,\r\n\t\t\t\tasc : true\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\t\tif(this.state.sort === field && this.state.asc) {\r\n\t\t\tthis.setState({\r\n\t\t\t\tasc : false\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\t\tthis.setState({\r\n\t\t\tsort : null\r\n\t\t})\r\n\t\treturn\r\n\t}\r\n\r\n\tsortersF() {\r\n\t\tvar inv = this.state.asc ? -1 : 1\r\n\t\tswitch(this.state.sort) {\r\n\t\tcase 'i': \r\n\t\t\treturn (a, b) => {\r\n\t\t\t\treturn inv * \r\n\t\t\t\t(this.chooseValueF(b.index,this.state.sort) - this.chooseValueF(a.index,this.state.sort))\r\n\t\t\t}\r\n\t\tcase 'descr':\r\n\t\t\treturn (a, b) => {\r\n\t\t\t\t var textA = this.chooseValueF(a.index,'descr').toUpperCase()\r\n\t\t\t\t var textB = this.chooseValueF(b.index,'descr').toUpperCase()\r\n\t\t\t\t return inv * \r\n\t\t\t\t ((textA < textB) ? -1 : (textA > textB) ? 1 : 0)\r\n\t\t\t}\r\n\t\tcase 'active':\r\n\t\t\treturn (a, b) => {\r\n\t\t\t\t return inv * (a.active && b.active ? 0 : (a.active? 1 : -1))\r\n\t\t\t}\r\n\t\tdefault: return (a, b) => {return 0}\r\n\t\t}\r\n\t}\r\n\t\r\n\taddR() {\r\n    \tvar defaults = this.getDefaultR()\r\n    \tvar valuesCopy = copyArray(this.state.values)\r\n    \tvaluesCopy.push(defaults)\r\n    \t//valuesCopy.splice(valuesCopy.length + 1, 0, defaults);\r\n    \tthis.sortedValues.push(defaults)\r\n    \t//this.sortedValues.splice(this.sortedValues.length + 1, 0, defaults);\r\n    \t\r\n    \t\r\n    \tvar errorsCopy = copyArray(this.state.errors)\r\n    \terrorsCopy.push(this.validateR(defaults))\r\n    \t//errorsCopy.splice(errorsCopy.length + 1, 0, this.validateR(defaults));\r\n    \t\r\n    \tthis.setState({\r\n    \t\t    \tvalues : valuesCopy,\r\n    \t\t    \terrors : errorsCopy,\r\n    \t})\r\n    }\r\n\t    \r\n\tgetDefaultR() {\r\n\t\tvar last = defaultValues\r\n\t\tif (this.sortedValues.length){\r\n\t\t\tlast = this.sortedValues[this.sortedValues.length - 1]\r\n\t\t}\r\n\r\n\t\tvar res = {...last}\r\n\t\tres.index = this.state.values.length\r\n\t\tres.id = tempId--\r\n\t\tres.l = false\r\n\t\tres.check = false\r\n\t\treturn res\r\n\t}\r\n    \r\n    removeR(index) {\r\n    \tthis.state.values.splice(index, 1)\r\n        var values_copy = copyArray(this.state.values)\r\n        this.state.errors.splice(index, 1)\r\n    \tvar errors_copy = copyArray(this.state.errors)\r\n\r\n    \t//reindex:\r\n    \tfor(var ix=index ; ix<values_copy.length ;ix++) {\r\n    \t\tvalues_copy[ix].index--\r\n    \t\terrors_copy[ix].index--\r\n    \t}\r\n    \tthis.setState({\r\n    \t\t    \tvalues : values_copy,\r\n    \t\t    \terrors : errors_copy,\r\n    \t})\r\n    }\r\n    \r\n    validateR(v) {\r\n\t   var res = {}\r\n\t   fields.forEach( (field) => {\r\n\t\t   \tres[field] = validators[field](v[field])\r\n    \t})\r\n    \treturn res\r\n    }\r\n    \r\n    readOnlyR(index, field) {\r\n\t\treturn this.state.deleted[index] || //marked as to be deleted?\t\t\t\r\n\t\t\t   \t   (!this.state.values[index].active && this.isPersistedR(index))\r\n\t}\r\n    \r\n    isPersistedR(index) {\r\n\t\treturn this.state.values[index].id >=0\r\n\t}\r\n    \r\n    renderCategoryR(index) {\r\n    \treturn(\r\n    \t<tr key={index}>\r\n        {/*{[...fields].map( (f) => {*/}\r\n        {['color','descr','active'].map( (f) => {\r\n\t \t\t\treturn this.td(index, f) \r\n\t \t\t})}\r\n\t \t\t\r\n\t      \t<td className={this.tdClassName(index, 'deleted')}>\r\n\t      \t\t{this.renderDeletedContentF(index)}\r\n\t      \t</td>\r\n\t      \t\r\n\t\t</tr>)\r\n    }\r\n    \r\n\tresetT() {\r\n\t\tvar state = initState(this.state.initial)\r\n\t\tthis.setState({...state})\r\n\t\tthis.init()\r\n\t}\r\n\t\r\n\tisPristineT() {\r\n\t\tvar pristine = true\r\n    \tthis.state.touched.forEach( (v) => {\r\n    \t\tfields.forEach( (f) => {\r\n    \t\t\tpristine = pristine && !v[f]\r\n    \t\t})\r\n    \t})\r\n    \treturn pristine &&\r\n    \t\t   (this.state.initial.length === this.state.values.length) && \r\n    \t       !this.deleteCount \r\n\t}\r\n\t\r\n\thasErrorsT() {\r\n\t\tvar errors = false\r\n    \tthis.state.errors.forEach( (v) => {\r\n    \t\terrors = errors || oneIsTrue(v) \r\n    \t})\r\n    \treturn errors\r\n\t}\r\n\t\r\n\tpreInitT(initialCategories) {\r\n\t\treturn preInitFormat(initialCategories)\r\n\t}\r\n\t\r\n\tshowOk() {\r\n\t\tthis.msg.show('SAVED SUCCESSFULLY', {\r\n\t      time: 2000,\r\n\t      type: 'success',\r\n\t      icon: <img src=\"yes.png\" alt=\"save ok\"/>\r\n\t    })\r\n\t }\r\n\t\r\n\tpreSubmitT() {\r\n\t\tvar created = []\r\n\t\tthis.state.values.forEach((v,index) => {\r\n\t\t\tif(!this.isPersistedR(index)) {\r\n\t\t\t\tvar p={}\r\n\t\t\t\tfields.forEach( (field) =>\r\n\t\t\t\t{\r\n\t\t\t\t\t p[field] = this.chooseValueF(index, field)\r\n\t\t\t\t})\r\n\t\t\t\tcreated.push(p)\r\n\t\t\t}\r\n\t\t}) \r\n\t\t\r\n\t\tvar deleted = []\r\n\t\tthis.state.deleted.forEach((v,i) => {\r\n\t\t\tif(v) {\r\n\t\t\t\tdeleted.push(this.state.values[i].id)\r\n\t\t\t} \r\n\t\t})\r\n\t\t\r\n\t\tvar modified = []\r\n\t\t//for(var index=0; index<this.state.values.length; index++) {\r\n\t\tthis.state.values.forEach( (v, index) => {\r\n\t\t\tif(this.isPersistedR(index)) {\r\n\t\t\t\tvar p={}\r\n\t\t\t\tfields.forEach((field) => {\r\n\t\t\t\t\t if(this.touchedF(index, field)) {\r\n\t\t\t\t\t\t p.id = v.id\r\n\t\t\t\t\t\t p[field] = this.chooseValueF(index, field)\r\n\t\t\t\t\t }\r\n\t\t\t\t })\r\n\t\t\t\t if(Object.keys(p).length > 0){\r\n\t\t\t\t\t modified.push(p)\r\n\t\t\t\t }\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\tvar updates = {\r\n\t\t\t\t'created' : preSubmitFormat(created),\r\n\t\t\t\t'deleted' : deleted,\r\n\t\t\t\t'modified' : preSubmitFormat(modified)\r\n\t\t}\r\n\t\tconsole.log(JSON.stringify(updates,null,4))\r\n\t\t//\"submit\"\r\n\t\tthis.pristine = null\r\n\t\tthis.props.update(updates)\r\n\t}\r\n\r\n    init() {\r\n        this.deleteCount = 0\r\n        this.pristine = null\r\n        this.errors = null\r\n        this.allChecked = false\r\n    }\r\n\r\n\trenderCategoriesT = () => {\r\n\t\tthis.sortedValues = this.state.values.slice(0)\r\n\t\tif (this.state.sort) this.sortedValues.sort(this.sortersF())\r\n\t\t\r\n\t\treturn (\r\n\t\t<div>\r\n\t\t<Panel id=\"accs-panel\" >\r\n          <Panel.Heading >\r\n            <Panel.Title >\r\n\t\t\t\t\t<Button onClick={() => this.resetT()} disabled={this.pristine} bsStyle={this.pristine ? \"default\":\"primary\"} >Reset</Button>\r\n\t\t\t\t\t<Button onClick={() => this.preSubmitT()} disabled={this.pristine || (this.errors != null)} bsStyle={this.pristine ? \"default\":\"primary\"}>Save</Button>\r\n\t\t\t\t\t<Button onClick={() => this.addR()}>Add</Button>\r\n\t\t\t</Panel.Title >\r\n\t\t </Panel.Heading >\t\r\n\t\t <Panel.Body>\r\n\t\t\t<Table id=\"categories_table\" striped bordered hover condensed>\r\n\t\t\t\t<thead>\r\n\t\t\t  \t\t<tr>\r\n\t\t\t  \t\t\t<th className={this.thClassName('color')} />\r\n\t\t\t  \t\t\t{this.th('descr', 'Name')}\r\n\t\t\t  \t\t\t{/*this.th('i', 'Default')*/}\r\n\t\t\t  \t\t\t{this.th('active', 'Active')}\r\n\t\t\t  \t\t\t\r\n\t\t\t  \t\t\t<th className={this.thClassName('deleted')}>\r\n\t\t\t  \t\t\t\t<FontAwesome name='trash'  size='lg' />\r\n\t\t\t  \t\t\t</th>\r\n\t\t\t  \t\t\t\r\n\t\t\t\t\t</tr>\t\t\t\t  \t\t\t\r\n\t\t\t\t</thead>\r\n\t\t\t\t<tbody>\r\n\t\t\t\t  \t{this.sortedValues.map((p) => this.renderCategoryR(p.index))}\r\n\t\t\t\t</tbody>\r\n\t\t\t</Table>\r\n\t\t</Panel.Body>\r\n\t\t</Panel >\r\n\t\t</div>)\r\n\t}\r\n\t\t\r\n\ttdClassName(index, field) {\r\n\t\treturn field + '_cell' + \r\n\t\t\t   (!this.isPersistedR(index) ? ' newRow' : '') +\r\n\t\t\t   (this.state.deleted[index] ? ' deleted' : '') +\r\n\t\t\t   (this.state.errors[index][field] ? ' error' : '')\r\n\t}\r\n\t\r\n\ttd(index, field) {\r\n\t\treturn (\r\n\t\t<td key={index+'_'+field} className={this.tdClassName(index, field)}>\r\n\t\t      {this.renderContentF(field, index)}\t\r\n\t\t</td>)\r\n\t}\r\n\t\r\n\tthClassName(field) {\r\n\t\treturn field + '_header' \r\n\t}\r\n\t\r\n\t\r\n\tth(field, label = null) {\r\n\t\tvar arrow = (<FontAwesome name = {this.state.asc ? 'sort-asc' : 'sort-desc'} />)\r\n\r\n\t\tvar sortField = (<div>{this.state.sort === field ? arrow : ''}</div>)\r\n\t\t\r\n\t\tvar labelField = (\r\n\t\t\t\t<div  style={{marginTop: 8}}>\r\n  \t\t\t\t\t<button  type=\"button\" className=\"link-button\" onClick={() => {this.setSortF(field)}}>\r\n  \t\t\t\t\t\t{label}\r\n  \t\t\t\t\t</button>\r\n\t\t  \t\t</div>)\r\n\t\treturn(\r\n\t\t<th className={this.thClassName(field)}>\r\n  \t\t\t<div>\r\n\t  \t\t\t<span style={{display: \"flex\"}}>\t\t\t  \t\t\t\t\t\t\r\n\t  \t\t\t\t<div style={{marginTop: 8, paddingRight: 3}}>\r\n\t  \t\t\t\t\t{sortField}\r\n\t  \t\t\t\t</div>\r\n\t  \t\t\t\t{label !== null ? labelField : ''}\r\n\t  \t\t\t</span>\r\n\t  \t\t</div>\r\n\t\t</th>)\r\n\t}\r\n\t\r\n\tcomponentWillReceiveProps(nextprops) {\r\n\t\tif( !this.isPristineT()  && this.pristine == null) { //just saved\r\n\t\t\tthis.showOk()\r\n\t\t}\r\n\t\r\n\t\tthis.init()\r\n\t\tthis.setState(\r\n\t\t\t\t{...initState(this.preInitT(nextprops.initCategories))}\r\n\t\t)\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tthis.pristine = this.isPristineT()\r\n\t\tthis.errors = this.hasErrorsT()\r\n\t\treturn(\r\n\t\t\t<div>\r\n\t        \t\t<AlertContainer ref={a => this.msg = a} {...alertOptions} />\r\n\t\t\t\t\t{this.renderCategoriesT()}\r\n\t\r\n\t\t   </div>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nCategoriesEditor.defaultProps = {\r\n\t\tinitCategories: []\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch) {\r\n    return({\r\n        update: (updates) => {\r\n            dispatch(update(updates))\r\n        }\r\n    })\r\n}\r\n\r\nexport default connect(null, mapDispatchToProps)(CategoriesEditor)\r\n\r\n\r\n","import React from 'react';\r\nimport { connect } from 'react-redux'\r\nimport { Panel } from 'react-bootstrap'\r\nimport CategoriesEditor from '../categoriesEditor/CategoriesEditor'\r\n\r\nclass Categories extends React.Component {\r\n\trender() {\r\n\t\treturn(\r\n\t\t\t<div>\r\n\t\t\t  <Panel >\r\n\t\t\t  \t<Panel.Heading style={{paddingTop: \"4px\", paddingBottom: \"3px\", height: \"45px\", fontSize: \"23px\"}}>\r\n\t\t\t\t  \t<span style={{display: \"flow-root\", alignItems: \"center\"}}>\r\n\t\t\t\t  \t\tIssues\r\n\t\t\t\t  \t</span>\r\n\t\t\t  \t</Panel.Heading>\r\n\t\t\t  \t<Panel.Body>\t\t\t\t\t\r\n\t\t\t\t\t<CategoriesEditor initCategories={this.props.categories} />\r\n\t\t\t\t</Panel.Body>\r\n\t\t\t  </Panel>\r\n\t\t\t</div>\r\n\t\t\t)\r\n\t}\r\n}\r\n\r\nconst mapStateToProps = (store) => {\r\n    return {\r\n        categories: store.categories.categories\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps)(Categories)\r\n","import {axios_get_params} from './axios';\r\n\r\nvar dateFormat = require('dateformat');\r\n\r\nconst CHART_REQUEST = 'CHART_REQUEST'\r\nconst chartRequestAction = (s, e) => ({\r\n    type: CHART_REQUEST,\r\n    payload: {\r\n        's': s,\r\n        'e': e\r\n    }\r\n})\r\n\r\nconst CHART_RESPONSE = 'CHART_RESPONSE'\r\nconst chartResponseAction = (response) => (\r\n  { \r\n\ttype: CHART_RESPONSE,\r\n    payload: \r\n    \t{\r\n    \t\tcurves : response\r\n    \t} \r\n  }\r\n)\r\n\r\nconst CHART_REDRAW = 'CHART_REDRAW'\r\nconst chartRedrawAction = () => (\r\n  { \r\n\ttype: CHART_REDRAW,\r\n    payload: \r\n    \t{\r\n    \t\tredraw : (new Date()).getTime() //only signal\r\n    \t} \r\n  }\r\n)\r\n\r\nvar params = null\r\n\r\nfunction get(dispatch) {\r\n    dispatch(chartRequestAction(params.s, params.e))\r\n    axios_get_params('chart',\r\n    \t\t\t\t{params: params},\r\n\t\t\t\t    response => {\r\n\t\t\t  \t\t  dispatch(chartResponseAction(response.data))\r\n\t\t\t\t    },\r\n\t\t\t\t    dispatch\r\n\t)\r\n\r\n}\r\n\r\nconst chart_load = (s, e) => (\r\n  (dispatch) => {\r\n\t  params = {\r\n\t\t\t  's': dateFormat(s, \"yyyy-mm-dd\"),\r\n\t\t\t  'e': dateFormat(e, \"yyyy-mm-dd\")\r\n\t  }\r\n\t  get(dispatch)\r\n    }\r\n)\r\n\r\n\r\nconst chart_refresh = () => (\r\n    (dispatch) => {\r\n        console.assert(params)\r\n        get(dispatch)\r\n    }\r\n)\r\n\r\nconst chart_redraw = () => (\r\n    (dispatch) => {\r\n    \tdispatch(chartRedrawAction())\r\n    }\r\n)\r\n\r\n\r\nexport {\r\n\tchart_load,\r\n\tchart_refresh,\r\n\tchart_redraw\r\n}\r\n","import {axios_get, axios_post} from './axios';\r\nimport { chart_refresh } from './chart'\r\nimport { invalidate } from './constants'\r\n\r\nconst ACCOUNT = 'acc'\r\n\t\r\nconst ACCOUNTS_REQUEST = 'ACCOUNTS_REQUEST'\r\nconst accountsRequestAction = () => ({\r\n    type: ACCOUNTS_REQUEST\r\n})\r\n\r\nconst ACCOUNTS_RESPONSE = 'ACCOUNTS_RESPONSE'\r\nconst accountsResponseAction = (accounts) => ({\r\n    type: ACCOUNTS_RESPONSE,\r\n    payload: {\r\n        \"accounts\": accounts\r\n    }\r\n})\r\n\r\nconst ACCOUNTS_UPDATE_REQUEST = 'ACCOUNTS_UPDATE_REQUEST'\r\nconst accountsUpdateRequestAction = (updates) => ({\r\n    type: ACCOUNTS_UPDATE_REQUEST,\r\n    payload: {\r\n    \t\"updates\": updates\r\n    }\r\n})\r\n\r\nconst ACCOUNTS_UPDATE_RESPONSE = 'ACCOUNTS_UPDATE_RESPONSE'\r\nconst accountsUpdateResponseAction = () => ({\r\n    \ttype: ACCOUNTS_UPDATE_RESPONSE\r\n})\r\n\r\nconst update = (updates) => (\r\n    (dispatch) => {\r\n        dispatch(accountsUpdateRequestAction(updates))\r\n        axios_post('acc/update', updates,\r\n            response => {\r\n               dispatch(accountsUpdateResponseAction())\r\n               dispatch(load())\r\n               invalidate(ACCOUNT, dispatch)\r\n               dispatch(chart_refresh())\r\n            },\r\n            dispatch\r\n        )\r\n    }\r\n )\r\n\r\n const load = () => (\r\n    (dispatch) => {\r\n        dispatch(accountsRequestAction())\r\n        axios_get('acc/list',\r\n          null,\r\n            response => {\r\n               dispatch(accountsResponseAction(response.data))\r\n            },\r\n            dispatch\r\n        )\r\n    }\r\n )\r\n \r\nexport {\r\n\tACCOUNT,\r\n    load,\r\n    update\r\n}","const fields = ['color','descr', 'credit', 'active']\r\n\r\nconst defaultValues = {\r\n\tid: null,\r\n\tcredit: 0,\r\n\tactive: true,\r\n\tdescr: '',\r\n\tcolor: 'blue'\r\n}\r\n\r\nconst validators = {\r\n\t'credit': (value) => {\r\n\t\t\treturn null\r\n\t\t  },\r\n\t'active': (value) => {\r\n\t\t\treturn null\r\n\t\t },\r\n\t'descr':  (value) => {\r\n\t\t\treturn (value !== '') ? null : 'required'\r\n\t\t  },\r\n\t'color': (value) => {\r\n\t\t\treturn (value !== '') ? null : 'required'\r\n\t\t  }\r\n}\r\n\r\nfunction preInitFormat(accounts) {\r\n\treturn deepCopy(accounts)\r\n}\r\n\r\nfunction preSubmitFormat(payments) {\r\n\treturn payments\r\n}\r\n\r\n\r\nfunction copyObject(b) {\r\n\treturn {\r\n\t\tid: b,\r\n\t\tcredit: b,\r\n\t\tactive: b,\r\n\t\tdescr: b,\r\n\t\tcolor: b\r\n\t}\r\n}\r\n\r\nfunction copyAccount(account, index = null) {\r\n\treturn {\r\n\t\t'index': index,\r\n\t\tid: account.id,\r\n\t\tcredit: account.credit,\r\n\t\tactive: account.active,\r\n\t\tdescr: account.descr,\r\n\t\tcolor: account.color\r\n\t}\r\n}\r\n\r\nfunction  deepCopy(accounts) {\r\n\tvar copy = []\r\n\taccounts.forEach(\r\n\t\t(p) => {copy.push(copyAccount(p))}\r\n\t)\r\n\treturn copy\r\n}\r\n\r\nfunction initState(accounts) {\r\n\tvar copy = {\r\n\t\tvalues : [],\r\n\t\tinitial : [],\r\n\t\terrors : [],\r\n\t\ttouched : [],\r\n\t\tdeleted : [],\r\n\t\tsort: null,\r\n\t\tasc: true\r\n\t}\r\n\taccounts.forEach((p, index) => {\r\n\t\tcopy.values.push(copyAccount(p, index))\r\n\t\tcopy.initial.push(copyAccount(p))\r\n\t\tcopy.errors.push(copyObject(null))\r\n\t\tcopy.touched.push(copyObject(false))\r\n\t\tcopy.deleted.push(false)\r\n\t})\r\n\treturn copy\r\n}\r\n\r\nfunction oneIsTrue(row) {\r\n\tvar ret =\r\n\t\trow.credit ||\r\n\t\trow.active ||\r\n\t\trow.descr ||\r\n\t\trow.color \r\n\treturn ret\r\n}\r\n\r\nfunction activeIsRo(row) {\r\n\tvar ret =\r\n\t\trow.credit ||\r\n\t\trow.descr ||\r\n\t\trow.color \r\n\treturn ret\r\n}\r\nfunction copyArray(array) {\r\n\treturn array.splice(0)\r\n}\r\n\r\nexport {\r\n\tfields,\r\n\tinitState,\r\n\tdefaultValues,\r\n\tvalidators,\r\n\tpreInitFormat,\r\n\tpreSubmitFormat,\r\n\toneIsTrue,\r\n\tcopyArray,\r\n\tactiveIsRo\r\n}","import React from 'react'\r\nimport { connect } from 'react-redux'\r\nimport { Table, Panel, Button } from 'react-bootstrap';\r\n\r\nimport { update } from '../../actions/accounts'\r\n\r\nimport CheckboxField from '../editorFields/CheckboxField'\r\nimport TextField from '../editorFields/TextField'\r\nimport ColorField from '../editorFields/ColorField'\r\n\r\nimport './AccountsEditor.css'\r\nimport '../../customMultiSelect.css'\r\n\r\nimport AlertContainer from 'react-alert'\r\nimport alertOptions from '../../util/alertoptions'\r\n\r\n//import { withMedia } from 'react-media-query-hoc';\r\n\r\nimport {\r\n\t\tfields,\r\n\t\tinitState,\r\n\t\tdefaultValues,\r\n//\t\tinitialMaskValues, \r\n\t\tvalidators,\r\n\t\tpreInitFormat,\r\n\t\tpreSubmitFormat,\r\n\t\toneIsTrue,\r\n\t\tcopyArray,\r\n\t\tactiveIsRo\r\n} from './constants'\r\n\r\nvar FontAwesome = require('react-fontawesome')\r\n\r\nvar tempId = -1\r\n\r\nclass AccountsEditor extends React.Component {\r\n    constructor(props) {\r\n        super(props)\r\n        this.showOk = this.showOk.bind(this)\r\n        //postfix -abbr. F = Field, R = Row, T = Table\r\n        \r\n        //Field related:\r\n        \r\n        //callbacks from uicomponents for updating model (state)\r\n        this.changePropertyF = this.changePropertyF.bind(this)\r\n        this.changePropertyDeletedF = this.changePropertyDeletedF.bind(this)\r\n        \r\n        //set state values:\r\n        this.setValueF = this.setValueF.bind(this)\r\n        \r\n        //validate:\r\n        this.validateF = this.validateF.bind(this)\r\n        \r\n        //some field related util;\r\n        this.touchedF = this.touchedF.bind(this) //dirty?\r\n        this.isDifferentFromInitialF = this.isDifferentFromInitialF.bind(this)        \r\n\r\n        //choose right value for render\r\n        this.chooseValueF = this.chooseValueF.bind(this)\r\n\r\n        //render\r\n        this.renderContentF = this.renderContentF.bind(this)\r\n        this.renderDeletedContentF = this.renderDeletedContentF.bind(this)\r\n        \r\n        //sort\r\n        this.setSortF = this.setSortF.bind(this)\r\n        this.sortersF = this.sortersF.bind(this)\r\n        \r\n        //Row related:\r\n        \r\n        //add/remove\r\n        this.addR = this.addR.bind(this)\r\n        this.getDefaultR = this.getDefaultR.bind(this) //choose values for new row\r\n        this.removeR = this.removeR.bind(this)\r\n\r\n        //validate\r\n        this.validateR = this.validateR.bind(this)\r\n        this.readOnlyR = this.readOnlyR.bind(this)\r\n        \r\n        //utils\r\n        this.isPersistedR = this.isPersistedR.bind(this)\r\n\r\n        //render\r\n        this.renderAccountR = this.renderAccountR.bind(this)\r\n\r\n        //Table related:\r\n        this.resetT =  this.resetT.bind(this)\r\n        //util\r\n        this.isPristineT = this.isPristineT.bind(this)\r\n        this.hasErrorsT = this.hasErrorsT.bind(this)\r\n        \r\n        //format input/output\r\n        this.preInitT = this.preInitT.bind(this)\r\n        this.preSubmitT = this.preSubmitT.bind(this)\r\n        \r\n        //init constants\r\n        this.init =  this.init.bind(this)\r\n        //render\r\n        this.renderAccountsT = this.renderAccountsT.bind(this)\r\n\r\n        //css and stuff\r\n        this.tdClassName = this.tdClassName.bind(this)\r\n        this.td = this.td.bind(this)\r\n        this.thClassName = this.thClassName.bind(this)\r\n        this.th = this.th.bind(this)\r\n        \r\n        this.init()\r\n        this.state = {...initState(this.preInitT(props.initAccounts))}\r\n    }\r\n\r\n    changePropertyF(value, field, index) {\r\n    \t//touch\r\n\t\tif (this.isPersistedR(index)) { //new rows do not get 'touched' (unless masked)\r\n\t\t\tvar copy = copyArray(this.state.touched)\r\n\t\t\tcopy[index][field] = this.isDifferentFromInitialF(value, field, index)\r\n\t\t\tthis.setState({touched : copy})\r\n\t\t}\r\n\t\t\r\n\t\t//validate\r\n\t\tthis.validateF(field, value, index)\r\n\r\n    \tthis.setValueF(value, field, index)\r\n    }\r\n    \r\n    changePropertyDeletedF(value, field, index) {\r\n    \tif(this.isPersistedR(index)) { //if it has id, let backend remove: mark as deleted\r\n    \t\tthis.deleteCount += (value ? 1 : -1)\r\n    \t\tvar copy = copyArray(this.state.deleted)\r\n    \t\tcopy[index] = value\r\n    \t\tthis.setState({deleted : copy})\r\n    \t} else {\r\n    \t\tthis.removeR(index) //if newly created, just remove it\r\n    \t}\r\n    }\r\n    \r\n\tsetValueF(value, field, index) {\r\n\t\tvar copy = copyArray(this.state.values)\r\n\t\tcopy[index][field] = value\r\n\t\tthis.setState({values : copy})\r\n\t}\r\n\r\n\tvalidateF(field, value, index) {\r\n\t\tvar original = this.state.errors[index][field]\r\n\t\tvar result = validators[field](value) \r\n\t\tif( result !== original ) {\r\n\t\t\tvar copy = copyArray(this.state.errors)\r\n\t\t\tcopy[index][field] = validators[field](value) \r\n\t\t\tthis.setState({errors : copy})\r\n\t\t}\r\n\t}\r\n\t\r\n\ttouchedF(index, field) {\r\n\t\tif(index<0) return false //mask-controls are never touched (-1 = checkbox -2 = mask value)\r\n\t\tif(this.state.deleted[index]) return false \t//to be deleted: not touched\r\n\t\tif(!this.isPersistedR(index)) return false \t//this is a new row: not touched and not masked\r\n\t\treturn this.state.touched[index][field]\r\n\t}\r\n\t\r\n\tisDifferentFromInitialF(value, field, index) {\r\n\t\treturn (value !== this.state.initial[index][field])\r\n\t}\r\n\r\n\tchooseValueF(index, field) {\r\n\t\tif(this.state.deleted[index]) return this.state.initial[index][field] //show initial values if to be deleted\r\n\t\treturn this.state.values[index][field] \r\n\t}\r\n\t\r\n\trenderContentF(field, index) {\r\n     \t\r\n    \tvar  value = this.chooseValueF(index, field)\r\n    \t\r\n    \tswitch(field) {\r\n    \tcase 'credit' :\r\n\t\t\t\t\treturn(\r\n\t\t\t\t  \t<div>\r\n\t\t\t\t  \t\t<CheckboxField \r\n\t\t\t\t\t  \t\tid = {'creditacc_' + index}\r\n\t\t\t\t\t  \t\tonValueChanged = {this.changePropertyF}\r\n\t\t\t\t\t  \t\tchecked = {value}\r\n\t\t\t\t\t  \t\treadOnly = {this.readOnlyR(index, 'credit')}\r\n\t\t\t\t  \t\t\tfield = 'credit'\r\n\t\t\t\t  \t\t\tindex = {index}\r\n\t\t\t\t  \t\t\ttouched = {this.touchedF(index, 'credit')}\r\n\t\t\t\t\t  \t/>\r\n\t\t\t\t    </div>)\r\n    \tcase 'active' :\r\n\t\t\t\t\treturn(\r\n\t\t\t\t  \t<div>\r\n\t\t\t\t  \t\t<CheckboxField \r\n\t\t\t\t\t  \t\tid = {'activeacc_' + index}\r\n\t\t\t\t\t  \t\tonValueChanged = {this.changePropertyF}\r\n\t\t\t\t\t  \t\tchecked = {value}\r\n\t\t\t\t\t  \t\treadOnly = {this.isPersistedR(index) && activeIsRo(this.state.touched[index])}\r\n\t\t\t\t  \t\t\tfield = 'active'\r\n\t\t\t\t  \t\t\tindex = {index}\r\n\t\t\t\t  \t\t\ttouched = {this.touchedF(index, 'active')}\r\n\t\t\t\t\t  \t/>\r\n\t\t\t\t    </div>)\t\t\t\t\t    \r\n    \tcase 'descr' :\r\n\t\t\t\t\treturn(\r\n\t\t\t\t  \t<div>\r\n\t\t\t\t  \t\t<TextField \r\n\t\t\t\t\t  \t\tid = {'descracc_'+index}\r\n\t\t\t\t\t  \t\tonValueChanged = {this.changePropertyF}\r\n\t\t\t\t\t  \t\tvalue = {value}\r\n\t\t\t\t\t  \t\treadOnly = {this.readOnlyR(index, 'descr')}\r\n\t\t\t\t  \t\t\tfield = 'descr'\r\n\t\t\t\t  \t\t\tindex = {index}\r\n\t\t\t\t  \t\t\ttouched = {this.touchedF(index, 'descr')}\r\n\t\t\t\t  \t\t\tplaceholder = 'name'\r\n\t\t\t\t  \t\t\tmaxLength = {30}\r\n\t\t\t\t\t  \t/>\r\n\t\t\t\t    </div>)\r\n    \tcase 'color' :\r\n\t\t\t\t\treturn(\r\n\t\t\t\t  \t<div>\r\n\t\t\t\t  \t\t<ColorField \r\n\t\t\t\t\t  \t\tid = {'coloracc_'+index}\r\n\t\t\t\t\t  \t\tonValueChanged = {this.changePropertyF}\r\n\t\t\t\t\t  \t\tcolor = {value}\r\n\t\t\t\t\t  \t\treadOnly = {this.readOnlyR(index, 'color')}\r\n\t\t\t\t  \t\t\tfield = 'color'\r\n\t\t\t\t  \t\t\tindex = {index}\r\n\t\t\t\t  \t\t\ttouched = {this.touchedF(index, 'color')}\r\n\t\t\t\t\t  \t/>\r\n\t\t\t\t    </div>)\r\n\t\tdefault: console.log('UNKONWN field: '+field)\r\n\t\t\t  \t   return null\r\n    \t}\r\n    }\r\n\t\r\n\trenderDeletedContentF(index) {\r\n\t\tif(!this.isPersistedR(index)) { \r\n\t\t\treturn(\r\n\t\t\t<button \r\n\t\t  \t\ttype=\"button\" \r\n\t\t  \t\tclassName=\"form-control\"  \r\n\t\t  \t\tonClick={() => this.changePropertyDeletedF(true, 'deleted', index)}>\r\n\t\t  \t\t<FontAwesome name = 'remove' style = {{'color': 'red'}}/>\r\n\t\t    </button>)\r\n\t\t}\r\n\t  \treturn \r\n\t\t/*return(\r\n\t  \t<div>\r\n\t  \t\t<CheckboxField \r\n\t\t  \t\tid = {'deletedacc_'+index}\r\n\t\t  \t\tonValueChanged = {this.changePropertyDeletedF}\r\n\t\t  \t\tchecked = {this.state.deleted[index]}\r\n\t  \t\t\tfield = 'deleted'\r\n\t  \t\t\tindex = {index}\r\n\t  \t\t\ttouched = {false}\r\n\t\t  \t/>\r\n\t    </div>)*/\r\n\t}\r\n\t\t\r\n\tsetSortF(field) {\r\n\t\tif(!this.state.sort || this.state.sort !==field) {\r\n\t\t\tthis.setState({\r\n\t\t\t\tsort : field,\r\n\t\t\t\tasc : true\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\t\tif(this.state.sort === field && this.state.asc) {\r\n\t\t\tthis.setState({\r\n\t\t\t\tasc : false\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\t\tthis.setState({\r\n\t\t\tsort : null\r\n\t\t})\r\n\t\treturn\r\n\t}\r\n\r\n\tsortersF() {\r\n\t\tvar inv = this.state.asc ? -1 : 1\r\n\t\tswitch(this.state.sort) {\r\n\t\tcase 'i': \r\n\t\t\treturn (a, b) => {\r\n\t\t\t\treturn inv * \r\n\t\t\t\t(this.chooseValueF(b.index,this.state.sort) - this.chooseValueF(a.index,this.state.sort))\r\n\t\t\t}\r\n\t\tcase 'descr':\r\n\t\t\treturn (a, b) => {\r\n\t\t\t\t var textA = this.chooseValueF(a.index,'descr').toUpperCase()\r\n\t\t\t\t var textB = this.chooseValueF(b.index,'descr').toUpperCase()\r\n\t\t\t\t return inv * \r\n\t\t\t\t ((textA < textB) ? -1 : (textA > textB) ? 1 : 0)\r\n\t\t\t}\r\n\t\tcase 'credit':\r\n\t\t\treturn (a, b) => {\r\n\t\t\t\t return inv * (a.credit && b.credit ? 0 : (a.credit? 1 : -1))\r\n\t\t\t}\r\n\t\tcase 'active':\r\n\t\t\treturn (a, b) => {\r\n\t\t\t\t return inv * (a.active && b.active ? 0 : (a.active? 1 : -1))\r\n\t\t\t}\r\n\t\tdefault: return (a, b) => {return 0}\r\n\t\t}\r\n\t\t\r\n\t}\r\n\t\r\n\taddR() {\r\n    \tvar defaults = this.getDefaultR()\r\n    \tvar valuesCopy = copyArray(this.state.values)\r\n    \tvaluesCopy.push(defaults)\r\n    \tthis.sortedValues.push(defaults)\r\n\r\n    \tvar errorsCopy = copyArray(this.state.errors)\r\n    \terrorsCopy.push(this.validateR(defaults))    \t\r\n    \tthis.setState({\r\n    \t\t    \tvalues : valuesCopy,\r\n    \t\t    \terrors : errorsCopy,\r\n    \t})\r\n    }\r\n\t    \r\n\tgetDefaultR() {\r\n\t\tvar last = defaultValues\r\n\t\tif (this.sortedValues.length){\r\n\t\t\tlast = this.sortedValues[this.sortedValues.length - 1]\r\n\t\t}\r\n\r\n\t\tvar res = {...last}\r\n\t\tres.index = this.state.values.length\r\n\t\tres.id = tempId--\r\n\t\tres.l = false\r\n\t\tres.check = false\r\n\t\treturn res\r\n\t}\r\n    \r\n    removeR(index) {\r\n    \tthis.state.values.splice(index, 1)\r\n        var values_copy = copyArray(this.state.values)\r\n        this.state.errors.splice(index, 1)\r\n    \tvar errors_copy = copyArray(this.state.errors)\r\n\r\n    \t//reindex:\r\n    \tfor(var ix=index ; ix<values_copy.length ;ix++) {\r\n    \t\tvalues_copy[ix].index--\r\n    \t\terrors_copy[ix].index--\r\n    \t}\r\n    \tthis.setState({\r\n    \t\t    \tvalues : values_copy,\r\n    \t\t    \terrors : errors_copy,\r\n    \t})\r\n    }\r\n    \r\n    validateR(v) {\r\n\t   var res = {}\r\n\t   fields.forEach( (field) => {\r\n\t\t   \tres[field] = validators[field](v[field])\r\n    \t})\r\n    \treturn res\r\n    }\r\n    \r\n    readOnlyR(index, field) {\r\n\t\treturn this.state.deleted[index] || //marked as to be deleted?\t\t\t\r\n\t\t\t   \t   (!this.state.values[index].active && this.isPersistedR(index))\r\n\t}\r\n    \r\n    isPersistedR(index) {\r\n\t\treturn this.state.values[index].id >=0\r\n\t}\r\n    \r\n    renderAccountR(index) {\r\n    \treturn(\r\n    \t<tr key={index}>\r\n        {/*{[...fields].map( (f) => {*/}\r\n      {['color','descr','active'].map( (f) => { //CHG-75\r\n\t \t\t\treturn this.td(index, f) \r\n\t \t\t})}\r\n\t \t\t\r\n\t      \t<td className={this.tdClassName(index, 'deleted')}>\r\n\t      \t\t{this.renderDeletedContentF(index)}\r\n\t      \t</td>\r\n\t      \t\r\n\t\t</tr>)\r\n    }\r\n    \r\n\tresetT() {\r\n\t\tvar state = initState(this.state.initial)\r\n\t\tthis.setState({...state})\r\n\t\tthis.init()\r\n\t}\r\n\t\r\n\tisPristineT() {\r\n\t\tvar pristine = true\r\n    \tthis.state.touched.forEach( (v) => {\r\n    \t\tfields.forEach( (f) => {\r\n    \t\t\tpristine = pristine && !v[f]\r\n    \t\t})\r\n    \t})\r\n    \treturn pristine &&\r\n    \t\t   (this.state.initial.length === this.state.values.length) && \r\n    \t       !this.deleteCount \r\n\t}\r\n\t\r\n\thasErrorsT() {\r\n\t\tvar errors = false\r\n    \tthis.state.errors.forEach( (v) => {\r\n    \t\terrors = errors || oneIsTrue(v) \r\n    \t})\r\n    \treturn errors\r\n\t}\r\n\t\r\n\tpreInitT(initialAccounts) {\r\n\t\treturn preInitFormat(initialAccounts)\r\n\t}\r\n\t\r\n\tshowOk() {\r\n\t\tthis.msg.show('SAVED SUCCESSFULLY', {\r\n\t      time: 2000,\r\n\t      type: 'success',\r\n\t      icon: <img src=\"yes.png\" alt=\"save ok\" />\r\n\t    })\r\n\t }\r\n\t\r\n\tpreSubmitT() {\r\n\t\tvar created = []\r\n\t\tthis.state.values.forEach((v,index) => {\r\n\t\t\tif(!this.isPersistedR(index)) {\r\n\t\t\t\tvar p={}\r\n\t\t\t\tfields.forEach( (field) =>\r\n\t\t\t\t{\r\n\t\t\t\t\t p[field] = this.chooseValueF(index, field)\r\n\t\t\t\t})\r\n\t\t\t\tcreated.push(p)\r\n\t\t\t}\r\n\t\t}) \r\n\t\t\r\n\t\tvar deleted = []\r\n\t\tthis.state.deleted.forEach((v,i) => {\r\n\t\t\tif(v) {\r\n\t\t\t\tdeleted.push(this.state.values[i].id)\r\n\t\t\t} \r\n\t\t})\r\n\t\t\r\n\t\tvar modified = []\r\n\t\t//for(var index=0; index<this.state.values.length; index++) {\r\n\t\tthis.state.values.forEach( (v, index) => {\r\n\t\t\tif(this.isPersistedR(index)) {\r\n\t\t\t\tvar p={}\r\n\t\t\t\tfields.forEach((field) => {\r\n\t\t\t\t\t if(this.touchedF(index, field)) {\r\n\t\t\t\t\t\t p.id = v.id\r\n\t\t\t\t\t\t p[field] = this.chooseValueF(index, field)\r\n\t\t\t\t\t }\r\n\t\t\t\t })\r\n\t\t\t\t if(Object.keys(p).length > 0){\r\n\t\t\t\t\t modified.push(p)\r\n\t\t\t\t }\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\tvar updates = {\r\n\t\t\t\t'created' : preSubmitFormat(created),\r\n\t\t\t\t'deleted' : deleted,\r\n\t\t\t\t'modified' : preSubmitFormat(modified)\r\n\t\t}\r\n\t\t//console.log(JSON.stringify(updates,null,4))\r\n\t\t//\"submit\"\r\n\t\tthis.pristine = null\r\n\t\tthis.props.update(updates)\r\n\t}\r\n\r\n    init() {\r\n        this.deleteCount = 0\r\n        this.pristine = null\r\n        this.errors = null\r\n        this.allChecked = false\r\n    }\r\n\r\n\trenderAccountsT = () => {\r\n\t\tthis.sortedValues = this.state.values.slice(0)\r\n\t\tif (this.state.sort) this.sortedValues.sort(this.sortersF())\r\n\t\t\r\n\t\treturn (\r\n\t\t<div>\r\n\t\t<Panel id=\"accs-panel\" >\r\n          <Panel.Heading >\r\n            <Panel.Title >\r\n\t\t\t\t\t<Button onClick={() => this.resetT()} disabled={this.pristine} bsStyle={this.pristine ? \"default\":\"primary\"}>Reset</Button>\r\n\t\t\t\t\t<Button onClick={() => this.preSubmitT()} disabled={this.pristine || (this.errors != null)} bsStyle={this.pristine ? \"default\":\"primary\"}>Save</Button>\r\n\t\t\t\t\t<Button onClick={() => this.addR()}>Add</Button>\r\n\t\t\t</Panel.Title >\r\n\t\t </Panel.Heading >\t\r\n\t\t <Panel.Body>\r\n\t\t\t<Table id=\"accounts_table\" striped bordered hover condensed>\r\n\t\t\t\t<thead>\r\n\t\t\t  \t\t<tr>\r\n\t\t\t  \t\t\t<th className={this.thClassName('color')} />\r\n\t\t\t  \t\t\t{this.th('descr', 'Name')}\r\n\t\t\t  \t\t\t{/*this.th('credit', 'Credit')*/}\r\n\t\t\t  \t\t\t{this.th('active', 'Active')}\r\n\t\t\t  \t\t\t{\r\n\t\t\t  \t\t\t<th className={this.thClassName('deleted')}>\r\n\t\t\t  \t\t\t\t<FontAwesome name='trash'  size='lg' />\r\n\t\t\t  \t\t\t</th>\r\n\t\t\t  \t\t\t}\r\n\t\t\t\t\t</tr>\t\t\t\t  \t\t\t\r\n\t\t\t\t</thead>\r\n\t\t\t\t<tbody>\r\n\t\t\t\t  \t{this.sortedValues.map((p) => this.renderAccountR(p.index))}\r\n\t\t\t\t</tbody>\r\n\t\t\t</Table>\r\n\t\t</Panel.Body>\r\n\t\t</Panel >\r\n\t\t</div>)\r\n\t}\r\n\t\t\r\n\ttdClassName(index, field) {\r\n\t\treturn field + '_cell' + \r\n\t\t\t   (!this.isPersistedR(index) ? ' newRow' : '') +\r\n\t\t\t   (this.state.deleted[index] ? ' deleted' : '') +\r\n\t\t\t   (this.state.errors[index][field] ? ' error' : '')\r\n\t}\r\n\t\r\n\ttd(index, field) {\r\n\t\treturn (\r\n\t\t<td key={index+'_'+field} className={this.tdClassName(index, field)}>\r\n\t\t      {this.renderContentF(field, index)}\t\r\n\t\t</td>)\r\n\t}\r\n\t\r\n\tthClassName(field) {\r\n\t\treturn field + '_header' \r\n\t}\r\n\t\r\n\t\r\n\tth(field, label = null) {\r\n\t\tvar arrow = (<FontAwesome name = {this.state.asc ? 'sort-asc' : 'sort-desc'} />)\r\n\r\n\t\tvar sortField = (<div>{this.state.sort === field ? arrow : ''}</div>)\r\n\t\t\r\n\t\tvar labelField = (\r\n\t\t\t\t<div  style={{marginTop: 8}}>\r\n  \t\t\t\t\t<button  type=\"button\" className=\"link-button\" onClick={() => {this.setSortF(field)}}>\r\n  \t\t\t\t\t\t{label}\r\n  \t\t\t\t\t</button>\r\n\t\t  \t\t</div>)\r\n\t\treturn(\r\n\t\t<th className={this.thClassName(field)}>\r\n  \t\t\t<div>\r\n\t  \t\t\t<span style={{display: \"flex\"}}>\t\t\t  \t\t\t\t\t\t\r\n\t  \t\t\t\t<div style={{marginTop: 8, paddingRight: 3}}>\r\n\t  \t\t\t\t\t{sortField}\r\n\t  \t\t\t\t</div>\r\n\t  \t\t\t\t{label !== null ? labelField : ''}\r\n\t  \t\t\t</span>\r\n\t  \t\t</div>\r\n\t\t</th>)\r\n\t}\r\n\t\r\n\tcomponentWillReceiveProps(nextprops) {\r\n\t\tif( !this.isPristineT()  && this.pristine == null) { //just saved\r\n\t\t\tthis.showOk()\r\n\t\t}\t\r\n\t\r\n\t\tthis.init()\r\n\t\tthis.setState(\r\n\t\t\t\t{...initState(this.preInitT(nextprops.initAccounts))}\r\n\t\t)\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tthis.pristine = this.isPristineT()\r\n\t\tthis.errors = this.hasErrorsT()\r\n\t\treturn(\r\n\t\t\t<div>\r\n\t        \t\t<AlertContainer ref={a => this.msg = a} {...alertOptions} />\r\n\t\t\t\t\t{this.renderAccountsT()}\r\n\t\t   </div>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nAccountsEditor.defaultProps = {\r\n\t\tinitAccounts: []\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch) {\r\n    return({\r\n        update: (updates) => {\r\n            dispatch(update(updates))\r\n        }\r\n    })\r\n}\r\n\r\n//export default connect(null, mapDispatchToProps)(withMedia(AccountsEditor))\r\nexport default connect(null, mapDispatchToProps)(AccountsEditor)\r\n\r\n\r\n","import React from 'react';\r\nimport { connect } from 'react-redux'\r\nimport { Panel } from 'react-bootstrap'\r\nimport AccountsEditor from '../accountsEditor/AccountsEditor'\r\n\r\n/*\r\n * package test;\r\n\r\npublic class Test {\r\n\r\n\tpublic static void main(String[] args) {\r\n\t\t// TODO Auto-generated method stub\r\n\t\tString format = \"%-24.24s|%-8.8s|%-11.11s|%15.15s|%-10.10s|%-10.10s|%-8.8s|%-1.1s|%s\";\r\n\t\tString forma2 = \"%-24.24s+%-8.8s+%-11.11s+%15.15s+%-10.10s+%-10.10s+%-8.8s+%-1.1s+%s\";\r\n\t\tSystem.out.println(String.format(format, \"id : 100\",\"crud\",\"date\",\"sum\",\"category\",\"account\",\"group\",\"s\",\"descr\"));\r\n\t\tSystem.out.println(String.format(format, \"------------------------\",\"--------\",\"-----------\",\"---------------\",\"----------\",\"----------\",\"--------\",\"-\",\"-----\"));\r\n\t\tSystem.out.println(String.format(format, \"\",\"Updated\",\"88.88.8888\",\"-88888888.88\",\"5\",\"6\",\"7\",\"8\",\"9\"));\r\n\t\tSystem.out.println(String.format(format, \"2018-06-05 15:20:02.024\",\"Updated\",\"88.88.8888\",\"-88888888.88\",\"ananasakäämä\",\"rukkanen\",\"joulu\",\"X\",\"tämä nyton sellaista höörönlööröö\"));\r\n\t\tSystem.out.println(String.format(format, \"\",\"Updated\",\"88.88.8888\",\"-88888888.88\",\"5\",\"6\",\"7\",\"8\",\"9\"));\r\n//\t\t\t\t\"2018-06-05 15:20:02.024\"\r\n//\t\t\t\t 123456789012345678901234567890\r\n\t}\r\n\r\n}\r\n */\r\n\r\nclass Accounts extends React.Component {\r\n\tconstructor(props) {\r\n\t    super(props);\r\n\t    this.state = {\r\n\t        accounts: []\r\n\t    }\r\n\t    //this.props.accountsLoad() //loaded as needed\r\n\t}\r\n\t\r\n\trender() {\r\n\t\treturn(\r\n\t\t\t<div>\r\n\t\t\t  <Panel >\r\n\t\t\t  \t<Panel.Heading style={{paddingTop: \"4px\", paddingBottom: \"3px\", height: \"45px\", fontSize: \"23px\"}}>\r\n\t\t\t\t  \t<span style={{display: \"flow-root\", alignItems: \"center\"}}>\r\n\t\t\t\t  \t\tAccounts \r\n\t\t\t\t  \t</span>\r\n\t\t\t  \t</Panel.Heading>\r\n\t\t\t  \t<Panel.Body>\t\t\t\t\t\r\n\t\t\t\t\t<AccountsEditor initAccounts={this.props.accounts} />\r\n\t\t\t\t</Panel.Body>\r\n\t\t\t  </Panel>\r\n\t\t\t</div>\r\n\t\t\t)\r\n\t}\r\n}\r\n\r\nconst mapStateToProps = (store) => {\r\n    return {\r\n        accounts: store.accounts.accounts\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps)(Accounts)\r\n","import React from 'react' // ← Main React library\r\nvar FontAwesome = require('react-fontawesome');\r\n\r\nclass Spinner extends React.Component{\r\n\trender(){\r\n\t\treturn null\r\n\t\tvar spin = <FontAwesome name='spinner' spin />\r\n\t\t//console.log(\"fetch:\"+this.props.fetching)\r\n\t\treturn(this.props.fetching ? spin : '')\t\t\t\t\t\r\n\t\t\r\n\t}\r\n}\r\n\r\nexport default Spinner\r\n","import {axios_get} from './axios';\r\n\t\r\nconst AUDITLOG_REQUEST = 'AUDITLOG_REQUEST'\r\nconst auditlogRequestAction = () => ({\r\n    type: AUDITLOG_REQUEST\r\n})\r\n\r\nconst AUDITLOG_RESPONSE = 'AUDITLOG_RESPONSE'\r\nconst auditlogResponseAction = (entries, fp, lp) => ({\r\n    type: AUDITLOG_RESPONSE,\r\n    payload: {\r\n        \"logentries\": entries,\r\n        \"firstpage\": fp,\r\n        \"lastpage\": lp\r\n    }\r\n})\r\n\r\nconst PAGE_SIZE = 50\r\n//NOTE Backend should return always PAGE_SIZE + 1 so, we can detect last/first -page\r\n const load = (id) => (\r\n    (dispatch) => {\r\n        dispatch(auditlogRequestAction())\r\n        axios_get('history',\r\n          (null != id ? 'id=' + id  : ''),\r\n           response => {\r\n        \t   var lastPage = true\r\n               if(response.data.length === (PAGE_SIZE + 1)) {\r\n            \t   lastPage = false\r\n            \t   response.data.pop()\r\n               }\r\n               dispatch(auditlogResponseAction(response.data, true, lastPage))\r\n           },\r\n           dispatch\r\n       )\r\n    }\r\n )\r\n\r\nconst next = (s) => (\r\n    (dispatch) => {\r\n        dispatch(auditlogRequestAction(s))\r\n        axios_get('history',\r\n          's='+s,\r\n            response  => {\r\n               var lastPage = true\r\n               if(response.data.length === (PAGE_SIZE + 1)) {\r\n            \t   lastPage = false\r\n            \t   response.data.pop()\r\n               }\r\n               dispatch(auditlogResponseAction(response.data, false, lastPage))\r\n            },\r\n            dispatch\r\n        )\r\n    }\r\n )\r\n \r\n const prev = (e) => (\r\n\t(dispatch) => {\r\n        dispatch(auditlogRequestAction(e))\r\n        axios_get('history',\r\n          'e='+e,\r\n            response => {\r\n               var firstPage = true\r\n               if(response.data.length === (PAGE_SIZE + 1)) {\r\n            \t   firstPage = false\r\n            \t   response.data.shift()\r\n               }\r\n               dispatch(auditlogResponseAction(response.data, firstPage, false))\r\n            },\r\n            dispatch\r\n        )\r\n    }\r\n )\r\n\r\nexport {\r\n    load,\r\n    next,\r\n    prev\r\n}","import React from 'react' // ← Main React library\r\nimport { Button } from 'react-bootstrap';\r\nimport { connect } from 'react-redux'\r\nimport { next, prev } from '../../actions/auditlog'\r\nvar FontAwesome = require('react-fontawesome');\r\n\r\nclass Buttons extends React.Component{\r\n\tconstructor(props) {\r\n\t    super(props)\r\n\t    this.next = this.next.bind(this)\r\n\t    this.prev = this.prev.bind(this)\r\n\t}\r\n\t\r\n\tnext() {\r\n\t\tif(!this.props.logentries || this.props.logentries.length === 0) return\r\n\t\tvar last = this.props.logentries[this.props.logentries.length - 1]\r\n\t\tvar s = last.hs[last.rownr].hd\r\n\t\tthis.props.next(s)\r\n\t}\r\n\r\n\tprev() {\r\n\t\tif(!this.props.logentries || this.props.logentries.length === 0) return\r\n\t\tvar first = this.props.logentries[0]\r\n\t\tvar e = first.hs[first.rownr].hd\r\n\t\tthis.props.prev(e)\r\n\t}\r\n\t\r\n\trender(){\r\n\t    return (\r\n\t    <div>\r\n\t\t    <Button onClick={this.prev} disabled={this.props.firstpage} >\r\n\t\t     \t<FontAwesome name='caret-left' />\r\n\t\t     </Button>\r\n\t\t     <Button onClick={this.next} disabled={this.props.lastpage}>\r\n\t\t     \t<FontAwesome name='caret-right'/>\r\n\t\t     </Button>\r\n\t\t     <Button href=\"http://localhost:8080/log\">\r\n\t\t     \t<FontAwesome name='download'/>\r\n\t\t     </Button>\r\n\t    </div>\r\n\t    )\r\n\t}\r\n}\r\n\r\nconst mapStateToProps = (store) => {\r\n    return {\r\n        logentries: store.auditlog.logentries,\r\n        firstpage: store.auditlog.firstpage,\r\n        lastpage: store.auditlog.lastpage\r\n    }\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch) {\r\n    return ({\r\n        next: (s) => {\r\n            dispatch(next(s))\r\n        },\r\n        prev: (e) => {\r\n            dispatch(prev(e))\r\n        }\r\n    })\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Buttons)\r\n","\r\nvar dateFormat = require('dateformat');\r\n\r\n// fiDate represents date in fi-format (string)\r\nfunction toDateFi(fiDate) {\r\n\t\tvar parts = fiDate.split(\".\");\r\n\t\tvar day = parts[0]\r\n\t\tvar month = parts[1] - 1\r\n\t\tvar year = parts[2]\r\n\t\treturn new Date(year, month, day)\r\n}\r\n\r\nfunction fiDateTimeMillis(millis) {\r\n\t\t//TODO: any more elegant ways?\r\n\t\tvar d = new Date(millis)\r\n\t\t\r\n\t\tvar day = '00' + d.getDate()\r\n\t\tday = day.substr(day.length - 2)\r\n\t\t\r\n\t\tvar m = '00' + (d.getMonth()+1) \r\n\t\tm = m.substr(m.length - 2)\r\n\t\t\r\n\t\tvar h = '00' + d.getHours()\r\n\t\th = h.substr(h.length - 2)\r\n\r\n\t\tvar mi = '00' + d.getMinutes()\r\n\t\tmi = mi.substr(mi.length - 2)\r\n\t\t\r\n\t\tvar sec = '00' + d.getSeconds()\r\n\t\tsec = sec.substr(sec.length - 2)\r\n\t\t\r\n\t\tvar mspart = '000' + d.getMilliseconds()\r\n\t\tmspart = mspart.substr(mspart.length - 3)\r\n\t\tvar r =\r\n\t\tday + '.' +\r\n\t\tm + '.' +\r\n\t\td.getFullYear() + ' ' +\r\n\t\th + ':' +\r\n\t\tmi + ':'+\r\n\t\tsec + '.' +\r\n\t\tmspart \r\n\t\treturn r\r\n}\r\n\r\nfunction toDBFormatFi(fiDate) {\r\n\t\tvar parts = fiDate.split(\".\");\r\n\t\tvar day = parts[0]\r\n\t\tvar month = parts[1] - 1\r\n\t\tvar year = parts[2]\r\n\t\treturn dateFormat(new Date(year, month, day), \"yyyy-mm-dd\")\r\n}\r\n\r\nfunction toDateDB(DBDate) {\r\n\t\tvar parts = DBDate.split(\"-\");\r\n\t\tvar day = parts[2]\r\n\t\tvar month = parts[1] - 1\r\n\t\tvar year = parts[0]\r\n\t\treturn new Date(year, month, day)\r\n}\r\n\r\nfunction toFiDBFormat(DBDate) {\r\n\t\tvar parts = DBDate.split(\"-\");\r\n\t\tvar day = parts[2]\r\n\t\tvar month = parts[1] - 1\r\n\t\tvar year = parts[0]\r\n\t\treturn dateFormat(new Date(year, month, day), \"dd.mm.yyyy\")\r\n}\r\n\r\nexport {toDateFi, toDBFormatFi, fiDateTimeMillis, toFiDBFormat, toDateDB}","\r\nimport {fiDateTimeMillis, toFiDBFormat} from '../../util/fiDate'\r\nimport currencyFormat  from '../../util/currency'\r\n\r\nfunction chooseValueF(p, field) {\r\n\t\t//'w','o','d','i','s','g','c','a','descr'\r\n    \tswitch(field) {\r\n\t    \tcase 'w' : return fiDateTimeMillis(p.hd)\r\n\t    \tcase 'op' : {\r\n\t    \t\tswitch(p.op) {\r\n\t    \t\tcase 'C' : return 'creation'\r\n\t    \t\tcase 'U' : return 'modification'\r\n\t    \t\tcase 'D' : return 'deletion'\r\n\t    \t\tdefault : console.log('UNKONWN op:' + p.op)\r\n\t    \t\t\t\t  return null\r\n\t    \t\t}\r\n\t    \t}\r\n\t    \t\t\r\n\t    \tcase 'd' : return toFiDBFormat(p.d)\r\n\t    \tcase 'i' : return currencyFormat(p.i)\r\n\t    \tcase 's' : return p.s ? 'X' : '-'\r\n\t    \tcase 'g' : return p.g\r\n\t    \tcase 'c' : return p.c_descr\r\n\t    \tcase 'a' : return p.a_descr\r\n\t    \tcase 'descr' : return p.descr\r\n\t    \tdefault : console.log('UNKONWN field: '+field)\r\n\t    \t\t\treturn null\r\n    \t}\r\n    \t\r\n\t}\r\n\r\nexport {chooseValueF}","import React from 'react';\r\nimport { Table } from 'react-bootstrap';\r\nimport {chooseValueF} from './logCommons'\r\n\r\nconst fields = ['d','i','s','g','c','a','descr']\r\n\r\nclass LogEntry extends React.Component {\r\n\t\t\r\n\tconstructor(props) {\r\n\t    super(props);\r\n\r\n\t    //render\r\n        this.renderLogHeaderT = this.renderLogHeaderT.bind(this)\r\n        this.renderLogR = this.renderLogR.bind(this)\r\n\r\n        //render\r\n        this.renderContentF = this.renderContentF.bind(this)\r\n        \r\n        //css and stuff\r\n        this.tdClassName = this.tdClassName.bind(this)\r\n        this.td = this.td.bind(this)\r\n        this.thClassName = this.thClassName.bind(this)\r\n        this.th = this.th.bind(this)\r\n        \r\n\t}\r\n\t\r\n\trenderContentF(value) {\r\n\t\t\treturn(\t\t\r\n\t\t\t<div>\r\n\t\t\t  \t{value}\r\n\t\t    </div>)\r\n    }\r\n\t\r\n\tthClassName(field) {\r\n\t\treturn field + '_header' \r\n\t}\r\n\t\r\n\tth(field, label = null) {\r\n\t\tvar labelField = (\r\n\t\t\t<div >\r\n\t\t\t\t\t{label}\r\n\t  \t\t</div>)\r\n\r\n\t\treturn(\r\n\t\t<th className={this.thClassName(field)}>\r\n  \t\t\t<div>\r\n\t  \t\t\t<span style={{display: \"flex\"}}>\t\t\t  \t\t\t\t\t\t\r\n\t  \t\t\t\t{label !== null ? labelField : ''}\r\n\t  \t\t\t</span>\r\n\t  \t\t</div>\r\n\t\t</th>)\r\n\t}\r\n\r\n\trenderLogR(r, index) {\r\n\t\treturn(\r\n    \t<tr key={r.hs[index].id+'_'+r.hs[index].rownr}>\r\n\t \t\t{['w','op', ...fields].map( (f) => { \r\n\t \t\t\treturn this.td(r, index, f) \r\n\t \t\t})}\r\n\t\t</tr>)\r\n    }\r\n\t\r\n\ttdClassName(r, index, field) {\r\n\t\tvar ret = field + '_cell' \r\n\t\tif(r.hs[index].op === 'U' \r\n\t\t   && (fields.indexOf(field) > -1) \r\n\t\t   && r.hs[index][field] !== r.hs[index - 1][field]) {\r\n\t\t\tret += ' updatedRow'\r\n\t\t}\r\n\t\t\r\n\t\tif(index === r.rownr || this.props.singleEntry) {\r\n\t\t\tret += ' actualRow'\r\n\t\t}\r\n\t\treturn ret\r\n\t}\r\n\t\r\n\r\n\t\r\n\ttd(r, index, field) {\r\n\t\tvar value = chooseValueF(r.hs[index], field)\r\n\t\treturn (\r\n\t\t<td key={r.hs[index].id + '_' + index+'_'+field} className={this.tdClassName(r, index, field)}>\r\n\t\t      \t\t{this.renderContentF(value)}\t\r\n\t\t</td>)\r\n\t}\r\n\t\r\n\trenderLogHeaderT = () => {\r\n    \treturn (\r\n\t\t<thead>\r\n\t  \t\t<tr>\r\n\t  \t\t\t{this.th('w', 'When')}\r\n\t  \t\t\t{this.th('op','What')}\r\n\t  \t\t\t{this.th('d', 'Date')}\r\n\t  \t\t\t{this.th('i', 'Pay')}\r\n\t  \t\t\t{this.th('s', 's')}\r\n\t  \t\t\t{this.th('g', 'Ref')}\r\n\t  \t\t\t{this.th('c', 'Issue')}\r\n\t  \t\t\t{this.th('a', 'Account')}\r\n\t  \t\t\t{this.th('descr', 'Desc.')}\t\t  \t\t\t\r\n\t\t\t</tr>\t\t\t\t  \t\t\t\r\n\t\t</thead>)\r\n    }\r\n\t\r\n\trender() {\r\n\t\tif(this.props.logEntry == null) return null\r\n\t\tvar r = this.props.logEntry\r\n\t\treturn(\r\n\t\t\t\t\t<Table id=\"auditlog_table\" key={'al_table_'+r.id} striped bordered hover condensed>\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthis.renderLogHeaderT()\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t<tbody>\r\n\t\t\t\t\t\t  \t{\r\n\t\t\t\t\t\t  \t\tr.hs.map((p, ix) => { return this.renderLogR(r, ix) })\r\n\t\t\t\t\t\t  \t}\r\n\t\t\t\t\t\t</tbody>\r\n\t\t\t\t\t</Table>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default LogEntry\r\n","import React from 'react';\r\nimport { Panel } from 'react-bootstrap';\r\nimport {fiDateTimeMillis} from '../../util/fiDate'\r\nimport LogEntry from './logEntry'\r\nimport {chooseValueF} from './logCommons'\r\n\r\nclass AuditLogTable extends React.Component {\r\n\tconstructor(props) {\r\n\t    super(props);\r\n\r\n\t    //render\r\n\t    this.renderLogEntry = this.renderLogEntry.bind(this)\r\n\t}\r\n\t\r\n\trenderLogEntry(r) {\r\n\t\tif(r.rownr < 0) return null\r\n\t\t\r\n\t\treturn (\r\n\t\t\r\n\t\t<Panel key={'al_panel_'+r.hs[0].id+'_'+r.rownr} >\r\n\t\t\t<Panel.Heading >\r\n\t\t\t\t<Panel.Title >\r\n\t            \t{chooseValueF(r.hs[r.rownr], 'op')} at { fiDateTimeMillis(r.hs[r.rownr].hd) } ( id: {r.hs[0].id} )\r\n\t\t\t\t</Panel.Title >\r\n            </Panel.Heading >\r\n\t\t\t <Panel.Body>\r\n\t\t\t \t<LogEntry logEntry={r} />\r\n\t\t\t</Panel.Body>\r\n\t\t</Panel >\r\n\t\t\r\n\t\t)\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tvar entries = this.props.logentries || []\r\n\r\n\t\treturn(\r\n\t\t\t<div>\r\n\t\t\t\t{entries.map((r) => this.renderLogEntry(r))}\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default AuditLogTable\r\n","import React from 'react';\r\nimport { connect } from 'react-redux'\r\nimport { Panel } from 'react-bootstrap';\r\n\r\nimport './auditlog.css'\r\nimport Spinner from '../main/Spinner'\r\nimport Buttons from './buttons'\r\nimport AuditLogTable from './auditlogTable'\r\n\r\nclass AuditLog extends React.Component {\r\n\t\r\n\trender() {\r\n\t\t\r\n\t\tvar entries = this.props.logentries || []\r\n\t\treturn(\r\n\t\t\t<div>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<Panel>\r\n\t\t\t\t\t  \t<Panel.Heading style={{paddingTop: \"6px\", paddingBottom: \"3px\", height: \"45px\", fontSize: \"23px\"}}>\r\n\t\t\t\t\t  \t\tAudit Log <Spinner fetching={this.props.fetching} />\r\n\t\t\t\t\t  \t\t\t<span className=\"pull-right\">\r\n\t\t\t\t\t\t  \t\t\t<Buttons />\r\n\t\t\t\t\t\t  \t    </span>\r\n\t\t\t\t\t  \t</Panel.Heading>\r\n\t\t\t\t\t </Panel>\r\n\t\t\t\t </div>\r\n\t\t\t\t<AuditLogTable logentries={entries} />\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<Panel>\r\n\t\t\t\t\t  \t<Panel.Heading style={{paddingTop: \"6px\", paddingBottom: \"3px\", height: \"45px\", fontSize: \"23px\"}}>\r\n\t\t\t\t\t  \t\t\t<span className=\"pull-right\">\r\n\t\t\t\t\t\t  \t\t\t<Buttons />\r\n\t\t\t\t\t\t  \t    </span>\r\n\t\t\t\t\t  \t</Panel.Heading>\r\n\t\t\t\t\t </Panel>\r\n\t\t\t\t </div>\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nconst mapStateToProps = (store) => {\r\n    return {\r\n        logentries: store.auditlog.logentries,\r\n        fetching: store.auditlog.fetching\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps)(AuditLog)\r\n","import React from 'react';\r\nimport { connect } from 'react-redux'\r\nimport AuditLog from './auditlog'\r\n\r\nclass Logs extends React.Component {\r\n\trender() {\r\n\t\treturn(\r\n\t\t\t<div>\r\n\t\t\t\t<AuditLog logentries={this.props.auditlog} />\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nconst mapStateToProps = (store) => {\r\n    return {\r\n    \t//TODO\r\n        auditlog: store.auditlog.logentries\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps)(Logs)\r\n","function addDays(date, days) {\r\n  var result = new Date(date);\r\n  result.setDate(result.getDate() + days);\r\n  return result;\r\n}\r\n\r\nfunction addMonths(date, months) {\r\n\tvar result = new Date(date);\r\n\tresult.setMonth(result.getMonth() + months);\r\n  return result;\t\r\n}\r\n\r\nfunction daydiff(d1, d2) {\r\n\tvar dt1 = new Date(d1);\r\n\tvar dt2 = new Date(d2);\r\n\treturn Math.floor((Date.UTC(dt2.getFullYear(), dt2.getMonth(), dt2.getDate()) - Date.UTC(dt1.getFullYear(), dt1.getMonth(), dt1.getDate()) ) /(1000 * 60 * 60 * 24));\r\n}\r\n\r\nfunction isFirstAndLastOfSameMonth(d1, d2) {\r\n\tvar result = \r\n\t\td1.getDate() === 1 &&\r\n\t\td1.getMonth() === d2.getMonth() &&\r\n\t\td1.getFullYear() === d2.getFullYear() &&\r\n\t\td2.getDate() === daysInMonth(d1.getMonth(), d1.getYear())\r\n\treturn result;\r\n\t\r\n}\r\n\r\nfunction daysInMonth (month, year) {// month is 0-based\r\n    return new Date(year, month + 1, 0).getDate();\r\n}\r\n\r\nexport {addDays, addMonths, daydiff, isFirstAndLastOfSameMonth, daysInMonth}","import {addDays, addMonths, daydiff, isFirstAndLastOfSameMonth, daysInMonth} from '../util/addDays'\r\n\r\nconst DATE_RANGE_SELECTED = 'DATE_RANGE_SELECTED'\r\nconst setDateRangeAction = (s, e, name) => ({\r\n    type: DATE_RANGE_SELECTED,\r\n    payload: {\r\n        's': s,\r\n        'e': e\r\n    }\r\n})\r\n\r\nvar prev_s, prev_e\r\n\r\nconst set_daterange = (s, e) => (\r\n    (dispatch) => {\r\n    \tprev_s = s\r\n    \tprev_e = e\r\n        dispatch(setDateRangeAction(s, e))\r\n    }\r\n)\r\n\r\n\r\nconst daterange_next_block = () => (\r\n    (dispatch) => {\r\n    \t//if it is a even month so will be the next month be even\r\n    \tif ( isFirstAndLastOfSameMonth(prev_s, prev_e) ) {\r\n    \t\tvar s = addMonths(prev_s, 1)\r\n    \t\tvar e = new Date(s)\r\n    \t\ts.setDate(1)\r\n    \t\te.setDate(daysInMonth(e.getMonth(), e.getYear()))\r\n    \t\tdispatch(set_daterange(s, e))\r\n    \t\treturn\r\n    \t\t\r\n    \t}\r\n    \tvar diff = daydiff(prev_s, prev_e)\r\n    \tdispatch(set_daterange(addDays(prev_s, diff + 1), addDays(prev_e, diff + 1)))\r\n    }\r\n)\r\n\r\nconst daterange_prev_block = () => (\r\n    (dispatch) => {\r\n    \t//if it is a even month so will be the preious month be even\r\n    \tif ( isFirstAndLastOfSameMonth(prev_s, prev_e) ) {\r\n    \t\tvar s = addMonths(prev_s, -1)\r\n    \t\tvar e = new Date(s)\r\n    \t\ts.setDate(1)\r\n    \t\te.setDate(daysInMonth(e.getMonth(), e.getYear()))\r\n    \t\tdispatch(set_daterange(s, e))\r\n    \t\treturn\r\n    \t}\r\n    \tvar diff = daydiff(prev_e, prev_s)\r\n    \tdispatch(set_daterange(addDays(prev_s, diff - 1), addDays(prev_e, diff - 1)))\r\n    }\r\n)\r\n\r\nconst set_todayrange = () => (\r\n    (dispatch) => {\r\n    \t\tvar s = new Date(0)\r\n    \t\tvar today = new Date()\r\n    \t\ts.setFullYear(today.getFullYear())\r\n    \t\ts.setMonth(today.getMonth())\r\n    \t\ts.setDate(1)\r\n    \t\ts.setHours(0);\r\n    \t\tvar e = new Date(s)\r\n    \t\te.setDate(daysInMonth(e.getMonth(), e.getYear()))\r\n    \t\tdispatch(set_daterange(s, e))\r\n    }\r\n)\r\n\r\nexport {\r\n    set_daterange,\r\n    set_todayrange,\r\n    daterange_prev_block,\r\n    daterange_next_block\r\n    \r\n}","import {axios_get_params} from './axios';\r\n\r\nconst MINIBARS_REQUEST = 'MINIBARS_REQUEST'\r\nconst balancesRequestAction = () => ({\r\n    type: MINIBARS_REQUEST,\r\n    payload: null\r\n})\r\n\r\nconst MINIBARS_RESPONSE = 'MINIBARS_RESPONSE'\r\nconst balancesResponseAction = (response) => ({\r\n    type: MINIBARS_RESPONSE,\r\n    payload: {\r\n        balances: response\r\n    }\r\n})\r\n\r\nconst MINIBARS_REDRAW = 'MINIBARS_REDRAW'\r\nconst minibarsRedrawAction = () => (\r\n  { \r\n\ttype: MINIBARS_REDRAW,\r\n    payload: \r\n    \t{\r\n    \t\tredraw : (new Date()).getTime() //only signal\r\n    \t} \r\n  }\r\n)\r\n\r\nvar prev_cat = 0\r\n\r\nconst balances_load = (cat) => (\r\n    (dispatch) => {\r\n    \tprev_cat = cat\r\n        dispatch(balancesRequestAction())\r\n        axios_get_params('minibars',\r\n        \t\t{ \r\n        \t\t\tparams: {\"cat\": cat}\r\n        \t\t},\r\n        \t\tresponse => {\r\n//                console.log(response);\r\n        \t\t\tvar ret = {\r\n        \t\t\t\t\t\"data\": response.data,\r\n        \t\t\t\t\tbalance: 0\r\n        \t\t\t}\r\n        \t\t\tdispatch(balancesResponseAction(ret))\r\n        \t\t},\r\n        \t\tdispatch\r\n        )\r\n    }\r\n)\r\n\r\n\r\nconst balances_refresh = () => (\r\n\tbalances_load(prev_cat)\r\n)\r\n\r\nconst minibars_redraw = () => (\r\n    (dispatch) => {\r\n    \tdispatch(minibarsRedrawAction())\r\n    }\r\n)\r\nexport {\r\n    balances_load,\r\n    balances_refresh,\r\n    minibars_redraw\r\n}","import { chunk_rawdata } from './chunkdata'\r\n\r\n//var chunk_rawdata = require('./chunkdata');\r\nvar dates = require('./helpers');\r\n\r\n\r\n\r\nvar dateFormat = require('dateformat');\r\nvar d3 = require('d3');\r\n\r\nfunction currencyFormat(c) {\r\n\treturn parseFloat(Math.round(c* 100) / 100).toFixed(2)\r\n}\r\n\r\nvar minibars = (function() {\r\n\t//date:\r\n  var FORMAT_DATE = \"dd.mm.yyyy ddd\"\r\n  var FORMAT_MONTH = \"mmm\"\r\n  var FORMAT_MONTH_YEAR = \"mmm yyyy\"\r\n  //colors:\r\n  var COLOR_INCOME_NEGATIV = \"red\"\r\n  var COLOR_INCOME_POSITIV = \"green\"\r\n  var COLOR_BALANCE = \"blue\"\r\n\r\n  var COLOR_DAY_BACKGROUND_NORMAL = \"white\"\r\n  var COLOR_DAY_BACKGROUND_UNDER_LIMITS = \"pink\"\r\n  var COLOR_DAY_BACKGROUND_SELECTED = \"gray\"\r\n  var COLOR_DAY_BACKGROUND_FOCUS = \"cadetblue\"\r\n\r\n  var COLOR_MONTH_BACKGROUND_NORMAL_ODD = \"lightblue\"\r\n  var COLOR_MONTH_BACKGROUND_NORMAL_EVEN = \"lightblue\"\r\n  var COLOR_MONTH_TEXT = \"black\"\r\n  var COLOR_UNLOCKED = \"lightgray\"\r\n\t  \r\n  var COLOR_MONTH_SEPARATOR_LINE = \"lightblue\"\r\n\r\n  //name of the element to bind to\r\n  var bindto = null\r\n  \r\n  //widths\r\n  var div_border_width\r\n  var column_width\r\n  var slot_width = 3\r\n  var line_width\r\n  var b_line_width\r\n\r\n  //leadin = rowstart in which the min and max are shown\r\n  var leadin_width\r\n\r\n  var col_per_slot_ratio = 0.8\r\n\r\n  //x-coords\r\n  var leadin_x\r\n\r\n  //heights\r\n  var top_margin\r\n  var datearea_height\r\n  var center_margin\r\n  var month_height\r\n  var bottom_margin\r\n\r\n  //y-coords\r\n  var datearea_y\r\n  var center_margin_y\r\n  var month_y\r\n  var bottom_margin_y\r\n  var height\r\n\r\n  \r\n  //min/max -months shown\r\n  var month_markers\r\n  \r\n\r\n  var miny, maxy\r\n  var scale\r\n\r\n  //date range selection\r\n  var start = null;\r\n  var end = null;\r\n\r\n  //callback\r\n  var cb_select = null;\r\n  //var dataprovider = null;\r\n\r\n  var max_selection_days\r\n\r\n  //default values\r\n  function init(config) {\r\n    if (!bindto) {\r\n      console.assert(config.bindto, \"bindto is mandatory\")\r\n      bindto = config.bindto\r\n    } else {\r\n      console.assert(!config.bindto || bindto === config.bindto, \"bindto can be defined only once\")\r\n    }\r\n  \r\n    //widths\r\n    div_border_width = config.div_border_width ||div_border_width || 0\r\n    leadin_width =  config.leadin_width || leadin_width || 45\r\n    line_width = config.line_width || line_width || 1\r\n    b_line_width = config.b_line_width || b_line_width || 0.2\r\n\r\n    //heights\r\n    top_margin = config.top_margin || top_margin || 10\r\n    datearea_height = config.datearea_height || datearea_height || 80\r\n    center_margin = config.center_margin || center_margin || 0 \r\n    month_height = config.month_height || month_height || 20\r\n    bottom_margin = config.bottom_margin || bottom_margin || 3 \r\n\r\n    //y-coords\r\n    datearea_y = top_margin\r\n\r\n    center_margin_y = datearea_y + datearea_height\r\n    month_y = center_margin_y + center_margin\r\n    bottom_margin_y = month_y + month_height\r\n    height = bottom_margin_y + bottom_margin\r\n\r\n    //callbacks\r\n    cb_select = config.select\r\n    //dataprovider = config.dataprovider\r\n    max_selection_days =  config.max_selection_days || 90\r\n    \r\n    month_markers = \"NONE\"\r\n  }\r\n\r\n  //id constants\r\n  var _DIV = \"_div_minibar\"\r\n  var _TIP_DIV = \"_tip_div_minibar\"\r\n  var _TIP_I_DIV = \"_tip_i_div_minibar\"\r\n  var _DAY_TEXT = \"_day_text\"\r\n  var _B_TEXT = \"_b_text\"\r\n  var _B_COLOR = \"_b_color\"\r\n  var _I_TEXT = \"_i_text\"\r\n  var _LEADIN = \"_leadin_minibar\"\r\n  var _LEADIN_ZERO = \"_zero_leadin_minibar\"\r\n  var _LEADIN_ZERO_TEXT = \"_zero_leadin_text_minibar\"\r\n  var _MAX_TEXT = \"_max_text_minibar\"\r\n  var _MIN_TEXT = \"_min_text_minibar\"\r\n  var _MONTH = \"_month_minibar\"\r\n  var _BG = \"_slot_bg_minibar\"\r\n  var _I = \"_i_minibar\"\r\n  var _E = \"_e_minibar\"\r\n  var _B = \"_b_minibar\"\r\n  var _UNLOCKED = \"_b_unlocked\"\r\n  var _LINE_B_PREV = \"_b_prev_minibar\"\r\n  var _LINE_B_NEXT = \"_b_next_minibar\"\r\n  var _LINE_ZERO = \"_zero_minibar\"\r\n\r\n  var months = null;\r\n  //init min and max for all\r\n  function init_scales() {\r\n  \r\n    miny = d3.min([0, months[0].columns[0].b])\r\n    maxy = d3.max([0, months[0].columns[0].b])\r\n\r\n    for (var ix = 0, len = months.length; ix < len; ix++) {\r\n      miny = d3.min([miny, d3.min(months[ix].columns, function(d) {\r\n        console.assert((null != d.i) && (null != d.e) && (null != d.b) && d.d , \"i, e, b and d must be defined\")\r\n        console.assert((d.i >= 0) && (d.e <=0 ), \"i must be positive, e must be negative\")\r\n        return d3.min([d.i, d.e, d.b]) \r\n      })])\r\n      maxy = d3.max([maxy, d3.max(months[ix].columns, function(d) {\r\n        return d3.max([d.i, d.e, d.b]) \r\n      })])\r\n    }\r\n    if(miny === 0 && maxy === 0) {maxy = 100}\r\n    scale = d3.scale.linear().domain([miny, maxy]).range([datearea_y + line_width, center_margin_y])\r\n\r\n    //miny_text = roundNumberText(miny)\r\n    //maxy_text  = roundNumberText(maxy)\r\n\r\n    //leadin_x = null\r\n  }\r\n\r\n//properties that may change dynamically in addition to basic data (ie. by update)\r\nfunction init_changeables() {\r\n  //widths\r\n  column_width = slot_width * col_per_slot_ratio\r\n\r\n  //min/max -months shown (used to decide wheter to create or update)\r\n  month_markers = monthMarkers()\r\n  \r\n  leadin_x = null\r\n}\r\n\r\n//helpers\r\nfunction dateId(day) {\r\n  return \"_\" + bindto + \"_\" + day.getDate() + \"_\" + (day.getMonth()+1) + \"_\" + day.getFullYear()\r\n}\r\n\r\nfunction monthId(day) {\r\n  return \"_\" + bindto + \"_\" + (day.getMonth() + 1) + \"_\" + day.getFullYear()\r\n}\r\n\r\nfunction bgColor(data) {\r\n  if (start && !end && !dates.compare(data.d, start)) {\r\n    return COLOR_DAY_BACKGROUND_FOCUS\r\n  }\r\n  if (withinSelection(data)) {\r\n    return COLOR_DAY_BACKGROUND_SELECTED\r\n  }\r\n  //return COLOR_DAY_BACKGROUND_NORMAL\r\n  return bgNormal(data)\r\n}\r\n\r\n/*function getNormalColorByDateOnly(day) {\r\n\tvar first_month = months[0].columns[0].d.getMonth()\r\n\tvar index_m = day.getMonth() - first_month\r\n\tvar index_d = day.getDate() - 1\r\n\treturn bgNormal(months[index_m].columns[index_d])\r\n}*/\r\n\r\nfunction bgNormal(data) {\r\n\tif( data.smallestb < 0 ) {\r\n\t\treturn COLOR_DAY_BACKGROUND_UNDER_LIMITS\r\n\t}\r\n\treturn COLOR_DAY_BACKGROUND_NORMAL\r\n}\r\n\r\nfunction iColor(data) {\r\n  return ((data.i + data.e) < 0) ? COLOR_INCOME_NEGATIV : COLOR_INCOME_POSITIV\r\n}\r\n\r\nfunction monthColor(day) {\r\n  return day.getMonth() % 2 ? COLOR_MONTH_BACKGROUND_NORMAL_EVEN : COLOR_MONTH_BACKGROUND_NORMAL_ODD\r\n}\r\n\r\nfunction mouseover_month(day) {\r\n  var point = d3.select('#' + monthId(day) + _MONTH)\r\n  point.attr(\"fill\", COLOR_DAY_BACKGROUND_FOCUS)\r\n}\r\n\r\nfunction mouseout_month(day) {\r\n  var point = d3.select('#' + monthId(day) + _MONTH)\r\n  point.attr(\"fill\", monthColor(day))\r\n}\r\n\r\nfunction click_month(s_date, e_date) {\r\n  /*if (start) {\r\n    var point = d3.select('#'+dateId(start) + _BG)\r\n    point.attr(\"fill\", getNormalColorByDateOnly(start))\r\n  }*/\r\n  start = s_date\r\n  end = e_date\r\n  //normalize_selection()\r\n  update() //jh\r\n  cb_select(start, end)\r\n  \r\n}\r\n\r\nfunction getmonthtext(date) {\r\n  if(date.getMonth() === 0) {\r\n\t  return dateFormat(date, FORMAT_MONTH_YEAR)\r\n  } else {\r\n\t  return dateFormat(date, FORMAT_MONTH)\r\n  }\r\n}\r\n\r\nfunction monthMarkers() {\r\n  //min/max -months\r\n  console.assert(months[0].columns[0].d, \"d must be defined\")\r\n  console.assert(months[months.length-1].columns[0].d, \"d must be defined\")\r\n\r\n  var left_month = monthId(months[0].columns[0].d)\r\n  var right_month = monthId(months[months.length-1].columns[0].d)\r\n\r\n  return left_month+\"-\"+right_month\r\n}\r\n\r\nfunction roundNumber(number) {\r\n\t  return Math.round(number).toPrecision(3)\r\n}\r\n\r\nfunction roundNumberText(number) {\r\n  var num = roundNumber(number)\r\n  var prefix = d3.formatPrefix(num);\r\n  return  \"\" + prefix.scale(num) + (prefix.symbol ===  \"y\" ? \"\" : prefix.symbol)\r\n}\r\n\r\nfunction withinSelection(d) {\r\n  return (start && end && d.d && dates.inRange(d.d, start, end))\r\n}\r\n\r\nfunction show_tip(data) {\r\n  var mid = monthId(data.d)\r\n  var bg = document.getElementById(dateId(data.d) + _BG).getBoundingClientRect()\r\n  var doc = document.documentElement;\r\n//  var left = (window.pageXOffset || doc.scrollLeft) - (doc.clientLeft || 0);\r\n  var top = (window.pageYOffset || doc.scrollTop)  - (doc.clientTop || 0);\r\n  //console.log('top=' + top)\r\n  var offsetRect = {left:0, 'top': -top} //document.getElementsByClassName(\"col-md-12\")[0].getBoundingClientRect()\r\n  //console.log(\"offsetRect:\" + offsetRect.left)\r\n  d3.select('#' + mid + _TIP_I_DIV).style(\"display\", (data.i === 0 && data.e === 0) ? \"none\" : \"table-row\")\r\n  d3.select('#' + mid + _TIP_DIV)\r\n  .style(\r\n    {\"display\": \"inline\",\r\n      \"left\" : (bg.left - offsetRect.left + slot_width) + \"px\",\r\n      \"top\" : (bg.top - offsetRect.top) + (0.75 * datearea_height) + \"px\",\r\n      \"position\" : \"absolute\"\r\n    })\r\n  d3.select(\"#\" + mid +_DAY_TEXT).text(dateFormat(data.d,FORMAT_DATE))\r\n  d3.select(\"#\" + mid +_B_TEXT).text(currencyFormat(data.b))\r\n  d3.select(\"#\" + mid +_B_COLOR).style(\"background-color\", iColor(data))\r\n  d3.select(\"#\" + mid +_I_TEXT).text((currencyFormat(data.i + data.e)))\r\n}\r\n\r\nfunction hide_tip(data) {\r\n  d3.select('#'+monthId(data.d) +_TIP_DIV).style(\"display\", \"none\")\r\n}\r\n\r\n\r\nfunction select(start_, end_) {\r\n  //console.log(\"select!\")\r\n  if (!start_ || !end_ ) {\r\n\t  console.assert(null != start_ && null != end_) \r\n\t  return\r\n  }\r\n  normalize(start_,end_) \r\n  \r\n  //console.log(\"select\")\r\n  //console.log(\"start:\" + start)\r\n  //console.log(\"end:\" + end)\r\n  \r\n  update() //jh\r\n  \r\n  //normalize_selection()\r\n}\r\n\r\nfunction normalize(s,e) {\r\n\t  var _s = d3.min([s, e])\r\n\t  var _e = d3.max([s, e])\r\n\t  start = _s\r\n\t  end = _e\r\n}\r\nfunction mouseover(data, i) {\r\n  ////console.log(\"mouseover\")\r\n  show_tip(data, i)\r\n  var point = d3.select('#' + dateId(data.d) +_BG)\r\n  point.attr(\"fill\", COLOR_DAY_BACKGROUND_FOCUS)\r\n  if (start && !end && Math.abs(dateDiffInDays(start, data.d)) > max_selection_days) {\r\n    cursor(\"not-allowed\")\r\n  } else if (start && !end) {\r\n    cursor(\"col-resize\")\r\n  } else {\r\n    cursor(\"pointer\")\r\n  }\r\n}\r\n\r\nfunction mouseout(data) {\r\n  ////console.log(\"mouseout\")\r\n  hide_tip(data)\r\n  var point = d3.select('#' + dateId(data.d) +_BG)\r\n  point.attr(\"fill\", bgColor(data))\r\n  //cursor(data, \"default\")\r\n}\r\n\r\nvar _MS_PER_DAY = 1000 * 60 * 60 * 24;\r\n\r\n// a and b are javascript Date objects\r\nfunction dateDiffInDays(a, b) {\r\n  // Discard the time and time-zone information.\r\n  var utc1 = Date.UTC(a.getFullYear(), a.getMonth(), a.getDate());\r\n  var utc2 = Date.UTC(b.getFullYear(), b.getMonth(), b.getDate());\r\n\r\n  return Math.floor((utc2 - utc1) / _MS_PER_DAY);\r\n}\r\n\r\n/*var prev_start = null\r\nvar prev_end = null\r\nfunction normalize_selection() {\r\n  var _s = d3.min([start, end])\r\n  var _e = d3.max([start, end])\r\n  start = _s\r\n  end = _e\r\n  colorRange(prev_start, prev_end, getNormalColorByDateOnly)\r\n  prev_start = start\r\n  prev_end = end\r\n\r\n  colorRange(start, end, () => {return COLOR_DAY_BACKGROUND_SELECTED})\r\n<<<<<<< HEAD\r\n}\r\n=======\r\n}*/\r\n\r\n\r\nfunction cursor(cursor) {\r\n  document.body.style.cursor = cursor\r\n}\r\n\r\nfunction click(data) {\r\n  if (start == null || (start && end)) {\r\n    start = data.d\r\n    end = null\r\n    cursor(\"col-resize\")\r\n    update() //jh\r\n    \r\n    //colorRange(prev_start, prev_end, getNormalColorByDateOnly)\r\n  } else if (end  == null) {\r\n    if (start && Math.abs(dateDiffInDays(start, data.d)) > max_selection_days) {\r\n      return;\r\n    }\r\n    end = data.d\r\n    cursor(\"pointer\")\r\n    normalize(start,end) \r\n    update() //jh\r\n    //normalize_selection()\r\n    cb_select(start, end)\r\n  }\r\n  ////console.log(\"s:\" + start + \" e:\" + end)\r\n  show_tip(data)\r\n  d3.select('#' + dateId(data.d) + _BG).attr(\"fill\", COLOR_DAY_BACKGROUND_FOCUS)\r\n}\r\n\r\nvar clicks = \r\n  {\r\n\t  \"click\": click,\r\n\t  \"mouseover\": mouseover,\r\n\t  \"mouseout\": mouseout\r\n  }\r\n\r\nfunction create(month) {\r\n  var mid = monthId(month.columns[0].d)\r\n  var width = month.columns.length * slot_width + line_width\r\n  var bindTo = d3.select('#' + bindto)\r\n  //console.log(\"div_width:\" + width );\r\n  var clicks_month =\r\n  {\r\n        \"click\": function() {click_month(month.columns[0].d, month.columns[month.columns.length - 1].d)},\r\n        \"mouseover\": function() {mouseover_month(month.columns[0].d)},\r\n        \"mouseout\": function() {mouseout_month(month.columns[0].d)}\r\n  }\r\n  \r\n  var minibar_div =\r\n    bindTo\r\n    .append(\"div\")\r\n    .attr(\"id\", mid +_DIV)\r\n    .style({\r\n      \"width\": width  + \"px\",\r\n      \"height\": height + \"px\",\r\n      \"float\": \"left\",\r\n      \"background-color\": \"white\",\r\n      \"border-style\": \"solid\",       \r\n      \"border-width\": div_border_width + \"px\",\r\n      \"border-color\": \"magenta\",\r\n      \"margin-top\": \"5px\" })\r\n    \r\n  var tip_div =\r\n  bindTo\r\n  .append(\"div\")\r\n  .attr(\"id\", mid +_TIP_DIV)\r\n  .style({\r\n      \"display\": \"none\",\r\n      \"position\": \"absolute\",\r\n      \"pointer-events\": \"none\",\r\n      \"top\": \"0px\",\r\n      \"left\": \"0px\"})\r\n  .append(\"table\")\r\n  .attr(\"class\",\"c3-tooltip\")\r\n\r\n  var tbody =\r\n  tip_div\r\n  .append(\"tbody\")\r\n\r\n  tbody.append(\"tr\").append(\"th\").attr(\r\n    { \"id\": mid +_DAY_TEXT,\r\n      \"colspan\":\"2\"}).text(\"CCC\")\r\n\r\n  var tr2 = tbody.append(\"tr\").attr(\"class\",\"c3-tooltip-name--data2\")\r\n  tr2.append(\"td\").attr(\"class\",\"name\").append(\"span\").style(\"background-color\", COLOR_BALANCE)\r\n  tr2.append(\"td\").attr(\"class\",\"value\").attr(\"id\", mid +_B_TEXT).text(\"\")\r\n\r\n  var tr1 = tbody.append(\"tr\").attr(\"id\", mid +_TIP_I_DIV).attr(\"class\",\"c3-tooltip-name--data1\")\r\n  tr1.append(\"td\").attr(\"class\",\"name\").append(\"span\").attr(\"id\", mid +_B_COLOR).style(\"background-color\", \"white\")\r\n  tr1.append(\"td\").attr(\"class\",\"value\").attr(\"id\", mid +_I_TEXT).text(\"\")\r\n\r\n  var minibar_leadin_svg = minibar_div\r\n    .append(\"svg\")\r\n    .attr({\r\n      \"id\": mid + _LEADIN,\r\n      \"width\": \"0px\",\r\n      \"height\": height })\r\n\r\n  minibar_leadin_svg\r\n    .append(\"line\")\r\n    .attr({\r\n    \"x1\" : leadin_width - (0.5 * line_width),\r\n    \"x2\" : leadin_width - (0.5 * line_width),\r\n    \"y1\": datearea_y,\r\n    \"y2\": bottom_margin_y,\r\n    \"stroke\": COLOR_MONTH_SEPARATOR_LINE,\r\n    \"stroke-width\": line_width\r\n    }) \r\n\r\n  minibar_leadin_svg\r\n  .append(\"line\")\r\n  .attr({\r\n    \"id\": mid + _LEADIN_ZERO,\r\n    \"x1\" : leadin_width - 7,\r\n    \"x2\" : leadin_width,\r\n    \"y1\": center_margin_y - scale(0) + top_margin + line_width,\r\n    \"y2\": center_margin_y - scale(0) + top_margin + line_width,\r\n    \"stroke\": \"black\",\r\n    \"stroke-width\": b_line_width\r\n  })\r\n\r\n  minibar_leadin_svg\r\n  .append(\"text\")\r\n        //.text(maxy_text)\r\n        .text('')\r\n        .attr({\r\n          \"id\": mid + _MAX_TEXT,\r\n          \"x\": leadin_width - 10,\r\n          \"y\": datearea_y + 12,\r\n          \"text-anchor\": \"end\",\r\n          \"font-family\": \"sans-serif\",\r\n          \"font-size\": \"12px\",\r\n          \"fill\": \"black\"\r\n        })\r\n\r\n  minibar_leadin_svg\r\n  .append(\"text\")\r\n        //.text(miny_text)\r\n  \t\t.text('')\r\n        .attr({\r\n          \"id\": mid + _MIN_TEXT,\r\n          \"x\": leadin_width - 10,\r\n          \"y\": center_margin_y  ,\r\n          \"text-anchor\": \"end\",\r\n          \"font-family\": \"sans-serif\",\r\n          \"font-size\": \"12px\",\r\n          \"fill\": \"black\"\r\n        })\r\n  //console.log(\"minibar_div.width = \" + width)\r\n  var minibar_svg = minibar_div\r\n    .append(\"svg\")\r\n    .style({\r\n        \"cursor\": \"inherit\"\r\n    })\r\n    .attr({ \r\n      \"width\": width,\r\n      \"height\": height,\r\n      \"fill\" : \"red\" })\r\n    .on({\r\n      \"mouseout\" : function() {cursor(\"default\")}\r\n    })\r\n\r\n  \r\n  minibar_svg\r\n    .append(\"rect\")\r\n    .attr({\r\n      \"id\": mid + _MONTH,\r\n      \"y\": month_y,\r\n      \"x\": 0,\r\n      \"width\": width - line_width,\r\n      \"height\" : month_height,\r\n      \"fill\" : monthColor(month.columns[0].d)\r\n    }).style(\"cursor\", \"pointer\")\r\n    .on(clicks_month)\r\n\r\n  minibar_svg\r\n  .append(\"text\")\r\n        .text(getmonthtext(month.columns[0].d))\r\n        .attr({\r\n          \"x\": 3,\r\n          \"y\": month_y + 15,\r\n          \"text-anchor\": \"start\",\r\n          \"font-family\": \"sans-serif\",\r\n          \"font-size\": \"12px\",\r\n          \"fill\": COLOR_MONTH_TEXT\r\n        }).style(\"cursor\", \"pointer\")\r\n        .on(clicks_month)\r\n        \r\n    minibar_svg\r\n    .selectAll()\r\n    .data(month.columns)\r\n    .enter()    \r\n    .append(\"rect\")\r\n    .attr({\r\n      \"id\": function(d) { \r\n        console.assert(d.d, \"d must be defined\")\r\n        return dateId(d.d) + _BG },\r\n      \"x\" : function(d, ix) {\r\n        ////console.log(\"x:\"+ (ix * slot_width))\r\n        return (ix * slot_width)},\r\n      \"y\": datearea_y,\r\n      \"width\": slot_width,\r\n      \"height\": datearea_height,\r\n      \"fill\": function(d) {return bgColor(d)}\r\n    })/*.style(\"cursor\", \"pointer\") */\r\n    .on(clicks)\r\n\r\n    minibar_svg\r\n    .selectAll()\r\n    .data(month.columns)\r\n    .enter()    \r\n    .append(\"rect\")\r\n    .attr({\r\n      \"id\": function(d) { return dateId(d.d) + _I },\r\n      \"x\" : function(d, ix){ return ((ix + (1 - col_per_slot_ratio) / 2) * slot_width)},\r\n      \"y\": function(d) { return  center_margin_y - scale(d.i) + top_margin + line_width },\r\n      \"width\": column_width,\r\n      \"height\": function(d) { return scale(d.i) - scale(0) },\r\n      \"fill\": COLOR_INCOME_POSITIV\r\n    })//.style(\"cursor\", \"pointer\")\r\n    .on(clicks)\r\n  \r\n    minibar_svg\r\n    .selectAll()\r\n    .data(month.columns)\r\n    .enter()    \r\n    .append(\"rect\")\r\n    .attr({\r\n      \"id\": function(d) { return dateId(d.d) + _E },\r\n      \"x\" : function(d, ix){ return ((ix + (1 - col_per_slot_ratio) / 2) * slot_width)},\r\n      \"y\": center_margin_y - scale(0) + top_margin + line_width,\r\n      \"width\": column_width,\r\n      \"height\": function(d) { return scale(0) - scale(d.e)},\r\n      \"fill\": COLOR_INCOME_NEGATIV\r\n    })//.style(\"cursor\", \"pointer\")\r\n    .on(clicks)\r\n    \r\n   minibar_svg\r\n    .selectAll()\r\n    .data(month.columns)\r\n    .enter()    \r\n    .append(\"line\")\r\n    .attr({\r\n      \"id\": function(d) { return dateId(d.d) + _LINE_ZERO },\r\n      \"x1\" : function(d, ix){ return (ix * slot_width)},\r\n      \"x2\" : function(d, ix) { return ((ix+1) * slot_width)},\r\n      \"y1\": center_margin_y - scale(0) + top_margin + line_width,\r\n      \"y2\": center_margin_y - scale(0) + top_margin + line_width,\r\n      \"stroke\": \"black\",\r\n      \"stroke-width\": b_line_width\r\n    })/*.style(\"cursor\", \"pointer\")*/\r\n    .on(clicks)\r\n\r\n   minibar_svg\r\n    .selectAll()\r\n    .data(month.columns)\r\n    .enter()    \r\n    .append(\"line\")\r\n    .attr({\r\n      \"id\": function(d){ return dateId(d.d) + _LINE_B_PREV},\r\n      \"x1\" : function(d, ix){ return (ix-(null != d.prev_b ? 0.5 : -0.5)) * slot_width},\r\n      \"x2\" : function(d, ix){ return (ix+0.5) * slot_width},\r\n      \"y1\": function(d){\r\n        return center_margin_y - scale(null != d.prev_b ? d.prev_b : d.b) + top_margin + line_width},\r\n      \"y2\": function(d, ix) {\r\n        return center_margin_y - scale(d.b) + top_margin + line_width},\r\n      \"stroke\": COLOR_BALANCE,\r\n      \"stroke-width\": b_line_width\r\n    })/*.style(\"cursor\", \"pointer\") */\r\n    .on(clicks)\r\n    \r\n\r\n    minibar_svg\r\n    .selectAll()\r\n    .data(month.columns)\r\n    .enter()    \r\n    .append(\"line\")\r\n    .attr({\r\n      \"id\": function(d){ return dateId(d.d) + _LINE_B_NEXT},\r\n      \"x1\" : function(d, ix){ return (ix+0.5) * slot_width },\r\n      \"x2\" : function(d, ix){ return (ix+(null != d.next_b ? 1.5 : 0.5)) * slot_width},\r\n      \"y1\": function(d) {\r\n        return center_margin_y - scale(d.b) + top_margin + line_width},\r\n      \"y2\": function(d, ix){\r\n        return center_margin_y - scale(null != d.next_b ? d.next_b : d.b) + top_margin + line_width},\r\n      \"stroke\": COLOR_BALANCE,\r\n      \"stroke-width\": b_line_width\r\n    })/*.style(\"cursor\", \"pointer\") */\r\n    .on(clicks)\r\n\r\n    if (slot_width > 4) {\r\n      minibar_svg\r\n      .selectAll()\r\n      .data(month.columns)\r\n      .enter()    \r\n      .append(\"circle\")\r\n      .style(\"shape-rendering\",\"auto\")\r\n      .attr({\r\n        \"id\": function(d) { return dateId(d.d) + _B},\r\n        \"cx\" : function(d, ix){ return ((ix + 0.5) * slot_width)},\r\n        \"cy\": function(d) { return center_margin_y - scale(d.b) + top_margin + line_width },\r\n        \"r\": 1.5, //slot_width / 6,\r\n        \"fill\": COLOR_BALANCE,\r\n      })\r\n      .on(clicks)\r\n    }\r\n\r\n   minibar_svg\r\n      .selectAll()\r\n      .data(month.columns)\r\n      .enter()    \r\n      .append(\"circle\")\r\n      .style(\"shape-rendering\",\"auto\")\r\n      .attr({\r\n        \"id\": function(d) { return dateId(d.d) + _UNLOCKED},\r\n        \"cx\" : function(d, ix){ return ((ix + 0.5) * slot_width)},\r\n        \"cy\": function(d) { return top_margin - 4},\r\n        \"r\": 1.5, //slot_width / 6,\r\n        \"fill\": function(d) { return d.l ? COLOR_UNLOCKED : 'white' }\r\n      }).on(clicks)\r\n  \r\n    minibar_svg\r\n    .append(\"line\")\r\n    .attr({\r\n      \"x1\" : -2,\r\n      \"x2\" : width + 2,\r\n      \"y1\" : datearea_y + (0.5*line_width),\r\n      \"y2\" : datearea_y + (0.5*line_width),\r\n      \"stroke\": COLOR_MONTH_SEPARATOR_LINE,\r\n      \"stroke-width\": line_width\r\n    })\r\n\r\n    minibar_svg\r\n    .append(\"line\")\r\n    .attr({\r\n      x1 : width - (0.5 * line_width),\r\n      x2 : width - (0.5 * line_width),\r\n      \"y1\" : datearea_y,\r\n      \"y2\" : bottom_margin_y,\r\n      \"stroke\": COLOR_MONTH_SEPARATOR_LINE,\r\n      \"stroke-width\": line_width\r\n    })\r\n\r\n} //create(config)\r\n\r\nfunction leadin(month) {\r\n  var mid = monthId(month.columns[0].d)\r\n  var e = document.getElementById(mid +_DIV)\r\n  var x = e.getBoundingClientRect().left\r\n  //var first = false\r\n  \r\n  var width = month.columns.length * slot_width +  line_width\r\n  if( !leadin_x ) { //init lead_in x\r\n\t  //console.log(\"first!\")  \r\n    leadin_x = x\r\n    //first = true\r\n  }\r\n  //console.log(\"x:\"+x+\" leadin:\"+leadin_x+\" add:\"+ (leadin_x === x ? leadin_width : 0))\r\n  /*d3.select('#' + mid +_DIV)\r\n  .style({\r\n    \"width\": width + (leadin_x === x ? leadin_width : 0) + \"px\"\r\n  })\r\n\r\n  d3.select('#' + mid + _LEADIN)\r\n  .attr({\r\n    \"width\": (leadin_x === x ? leadin_width : 0) + \"px\",\r\n  })*/\r\n  d3.select('#' + mid +_DIV)\r\n  .style({\r\n    \"width\": width + (x <= leadin_x ? leadin_width : 0) + \"px\"\r\n  })\r\n\r\n  d3.select('#' + mid + _LEADIN)\r\n  .attr({\r\n    \"width\": (x <= leadin_x ? leadin_width : 0) + \"px\",\r\n  })\r\n  \r\n // if (first) {\r\n\t  d3.select('#' + mid + _MAX_TEXT)\r\n\t  .text(roundNumberText(maxy))\r\n\t\r\n\t  d3.select('#' + mid + _MIN_TEXT)\r\n\t  .text(roundNumberText(miny)) \r\n  //}\r\n}\r\n\r\nfunction updateMonth(month) {\r\n  ////console.log(\"update\")\r\n  var mid = monthId(month.columns[0].d)\r\n  d3.select('#' + mid + _LEADIN_ZERO)\r\n    .transition()\r\n    .attr({\r\n      \"y1\": center_margin_y - scale(0) + top_margin + line_width,\r\n      \"y2\": center_margin_y - scale(0) + top_margin + line_width\r\n    })\r\n  d3.select('#' + mid + _LEADIN_ZERO_TEXT)\r\n    .transition()\r\n    .attr({\r\n      \"y\": center_margin_y - scale(0) + 3 + top_margin + line_width,\r\n    })\r\n\r\n  //for (var ix = 0, len = month.columns.length; ix < len; ix++) {\r\n  month.columns.forEach( m => {\r\n    var date_id = dateId(m.d)\r\n\r\n    d3.select('#' + date_id + _I)\r\n      .datum(function(d) {\r\n        d.i =  m.i\r\n        d.e =  m.e\r\n        d.b =  m.b\r\n        d.smallestb =  m.smallestb\r\n        d.prev_b =  m.prev_b\r\n        d.next_b =  m.next_b\r\n        d.l =  m.l\r\n        return d\r\n      })\r\n      .transition()\r\n      .attr({\r\n        \"y\": function(d) {\r\n          return center_margin_y - scale(d.i) + top_margin + line_width\r\n        },\r\n        \"height\": function(d) {    \r\n          return  scale(d.i) - scale(0)  \r\n        }\r\n      }\r\n    )\r\n    \r\n   d3.select('#' + date_id + _BG)\r\n      .transition()\r\n      .attr({\r\n      \"fill\": function(d) {return bgColor(d)}\r\n    })\r\n    \r\n    \r\n    d3.select('#' + date_id + _E)\r\n      .transition()\r\n      .attr({\r\n        \"y\": center_margin_y - scale(0) + top_margin + line_width,\r\n        \"height\":  function(d) { return scale(0) - scale(d.e)  \r\n        }\r\n      }\r\n    )\r\n    \r\n    d3.select('#' + date_id + _B)\r\n      .transition()\r\n      .attr({\r\n        \"cy\": function(d) { \r\n          return center_margin_y - scale(d.b) + top_margin + line_width\r\n        }  \r\n      })\r\n\r\n     d3.select('#' + date_id + _UNLOCKED)\r\n      .transition()\r\n      .attr({\r\n    \t  \"fill\": function(d) {\r\n    \t\t  return d.l ? COLOR_UNLOCKED : 'white' } \r\n      })\r\n      \r\n    d3.select('#' + date_id + _LINE_ZERO)\r\n      .transition()\r\n      .attr({\r\n        \"y1\": center_margin_y - scale(0) + top_margin + line_width,\r\n        \"y2\": center_margin_y - scale(0) + top_margin + line_width\r\n      })\r\n\r\n\r\n    d3.select('#' + date_id + _LINE_B_PREV)\r\n      .transition()\r\n      .attr({\r\n        \"y1\": function(d) {\r\n          return center_margin_y - scale(null != d.prev_b ? d.prev_b : d.b) + top_margin + line_width\r\n        },\r\n        \"y2\": function(d) {\r\n          return center_margin_y - scale(d.b) + top_margin + line_width\r\n        }\r\n      })\r\n\r\n    d3.select('#' + date_id +  _LINE_B_NEXT)\r\n      .transition()\r\n      .attr({\r\n        \"y1\": function(d) {\r\n          return center_margin_y - scale(d.b) + top_margin + line_width\r\n        },\r\n        \"y2\": function(d) {\r\n          return center_margin_y - scale(null != d.next_b ? d.next_b : d.b) + top_margin + line_width\r\n        }\r\n      })\r\n  })\r\n} //updateMonth(month)\r\n\r\n\r\n\r\n\r\nfunction resize() {\r\n\t// slot_width = 3;\r\n\tinit_changeables()\r\n\t//init_scales()\r\n\trecreate()\r\n}\r\n\r\nfunction config(config) {\r\n//  //console.log(\"config\")\r\n  if(!bindto) {\r\n\t  console.assert(config, \"not a valid config\")\r\n\t  init(config)\r\n  }\r\n  //dataprovider = config.dataprovider\r\n // fetchData()\r\n}\r\n\r\n/*function fetchData() {\r\n  //console.log(\"fetchData\")\r\n  dataprovider(fetchdataCb)\r\n}*/\r\n\r\nconst nullData = \r\n{\r\n\tbalance : 0,\r\n\tdata : \r\n\t[\r\n\t\t{\r\n\t\t\t//d: (new Date).getFullYear() + \"-\" + ((new Date).getMonth() + 1) + \"-01\",\r\n\t\t\td:new Date(),\r\n\t\t\tb:0, \r\n\t\t\te:0, \r\n\t\t\ti:0,\r\n\t\t\tsmallestb: 0,\r\n\t\t\tl: false,\r\n\t\t}\r\n\t]\r\n}\r\n\r\n\r\nfunction generate(provideddata) {\r\n\tif (!provideddata || !provideddata.data) return\r\n\t  if (!provideddata.data.length) {\r\n\t\t  provideddata = nullData\t \r\n\t  }\r\n\t  //console.log(\"generate\")\r\n\t  console.assert(bindto, \"config must be called first!\")\r\n\t  //console.log(provideddata)\r\n\t  //months = chunk_rawdata(provideddata.data, provideddata.balance)\r\n\t  months = chunk_rawdata(provideddata.data)\r\n\t  var prev_month_markers = month_markers;\r\n\t  //slot_width = calculateSlotWidth()\r\n\r\n\t  init_changeables()\r\n\t  init_scales()\r\n\t  if ( prev_month_markers === month_markers ) {\r\n\t\t  update()\r\n\t  } else {\r\n\t\t  recreate()\r\n\t  }\r\n\t  /*if(start == null && end == null) {\r\n\t\t  select(initials.startDate, initials.endDate)\r\n\t  }*/\r\n}\r\n\r\nfunction update() {\r\n  if(!months) return\r\n  for (var ix = 0, len = months.length; ix < len; ix++) {\r\n\t    updateMonth(months[ix])\r\n\t    leadin(months[ix])\r\n\t}\r\n}\r\n\r\nfunction recreate() {\r\n\t  d3.select('#'+bindto).selectAll(\"div\").remove()\r\n\t  for (var ix = 0, len = months.length; ix < len; ix++) {\r\n\t    create(months[ix])\r\n\t    leadin(months[ix])\r\n\t  }\r\n}\r\n/*\r\nvar p_cursor\r\nfunction fetchAllMonths() {\r\n  //console.log(\"fetchAllMonths\")\r\n  p_cursor = document.body.style.cursor\r\n  //cursor(wait)\r\n  dataprovider(dataCb)\r\n}\r\n\r\nfunction dataCb(provideddata) {\r\n\t  cursor(p_cursor)\r\n\t  //console.log(\"dataCb\")\r\n\t  //console.log(provideddata)\r\n\t  months = chunk_rawdata(provideddata.data, provideddata.balance)\r\n\t  resizeMonths();\r\n\t}\r\n\r\nfunction resizeMonths() {\r\n  //console.log(\"resizeMonths\")\r\n  slot_width = calculateSlotWidth()\r\n  init_changeables()\r\n  init_scales()\r\n  d3.select('#'+bindto).selectAll(\"div\").remove()\r\n  for (var ix = 0, len = months.length; ix < len; ix++) {\r\n    create(months[ix])\r\n    leadin(months[ix])\r\n  }\r\n}\r\n\r\nfunction refresh() {\r\n  //console.log(\"refresh\")\r\n  dataprovider(refreshCb)\r\n}\r\n\r\nfunction refreshCb(provideddata) {\r\n  months = chunk_rawdata(provideddata.data, provideddata.balance)\r\n  init_scales()\r\n  for (var ix = 0, len = months.length; ix < len; ix++) {\r\n    updateMonth(months[ix])\r\n    leadin(months[ix])\r\n  }\r\n}*/\r\n\r\n/*function add(date, ie) {\r\n  //console.log(\"add \" +date )\r\n  console.assert(date && null != ie, \"add cannot have null params\")\r\n  if(dates.compare(date, months[0].columns[0].d ) < 0  || dates.compare(date, months[months.length-1].columns[months[months.length-1].columns.length-1].d ) > 0) {\r\n    fetchAllMonths()\r\n  } else  {\r\n    var found = false;\r\n    for (var ix1 = 0, len1 = months.length; ix1 < len1; ix1++) {\r\n      var month = months[ix1]\r\n      for (var ix2 = 0, len2 = month.columns.length; ix2 < len2; ix2++) {\r\n        if (!found && (dateDiffInDays(date, month.columns[ix2].d) == -1)) {\r\n            month.columns[ix2].next_b += ie\r\n        }\r\n        if (!found && (dateDiffInDays(date, month.columns[ix2].d) == 0)) {\r\n            month.columns[ix2].i += ie\r\n            month.columns[ix2].b += ie\r\n            month.columns[ix2].next_b += ie\r\n            found = true\r\n        } else if (found) {\r\n          month.columns[ix2].prev_b += ie\r\n          month.columns[ix2].b += ie\r\n          if (month.columns[ix2].next_b) {\r\n            month.columns[ix2].next_b += ie\r\n          }\r\n        }\r\n      }\r\n    }\r\n    refresh()\r\n  }\r\n}*/\r\n\r\n\r\nreturn {\r\n  //\t\"refresh\" : refresh,\r\n    \"resize\" : resize,\r\n    //\"add\" : add,\r\n    \"config\" : config,\r\n    \"generate\" : generate,\r\n    \"select\" : select\r\n}\r\n})()\r\n\r\nwindow.addEventListener(\"resize\", function(e) {\r\n  minibars.resize()\r\n});\r\n\r\nexport {minibars}\r\n//module.exports = minibars;\r\n","//produces array of objects containing\r\n//months in input and dates of each month and more...\r\n\r\nfunction chunk_rawdata(daydata) {\r\n  // (I) loop daydata (must be ascending by date and date is unique) (var i)\r\n  //  - (II) for each dates (var data_i) construct array of dates for that month - if needed. (var dayArray)\r\n  //  - (III) update the corresponding array index data (var data_i) to data of that date (var dayArray)\r\n  //  - (IV) add to each day balances of previous and next days\r\n  //  - (V) add empty month to the beginning and end\r\n\t\r\n\t\r\n  // if account == -1, we must calculate balances ourselves (i.e denotes that category filter is on)\r\n  var balances_given = (daydata[0].a !== -1);\r\n\t\r\n  //trivial checks\r\n\r\n  var r = []; //return value\r\n  if (!daydata || !daydata.length) {\r\n    return r\r\n  }\r\n\r\n  //convert date-strings to date\r\n  if (typeof daydata[0].d  === \"string\") {\r\n\t  for (var idaydata = 0, lendaydata = daydata.length; idaydata < lendaydata; idaydata++) {\r\n\t\t  daydata[idaydata].d = new Date(daydata[idaydata].d)\r\n\t  }\r\n  }\r\n\r\n  //returns the # of days of month (m is 0-based)\r\n  function monthDays(m , y){\r\n    return (new Date(y, m + 1, 0)).getDate();\r\n  }\r\n\r\n  //init the main loop vars\r\n  console.assert(daydata[0].d, \"d is mandatory\")\r\n  var m = daydata[0].d.getMonth() - 1\r\n  var y = daydata[0].d.getFullYear()\r\n  var d = daydata[0].d.getDate() - 1\r\n  var b = 0\r\n  var smallestb = 0\r\n  var dayArray = null\r\n\r\n  //main loop (I)\r\n  for (var i = 0, len = daydata.length; i < len; i++) {\r\n    var data_i = daydata[i]\r\n    console.assert(data_i.d, \"d is mandatory\")\r\n    var m_i = data_i.d.getMonth()\r\n    var y_i = data_i.d.getFullYear()\r\n    var d_i = data_i.d.getDate()\r\n    \r\n    console.assert(\r\n      m_i >= 0 \r\n      && m_i < 12 \r\n      && d_i >0 \r\n      && d_i <= 31 \r\n      && (y * (12 * 31) + m * 31 + d) < (y_i * (12 * 31) + m_i * 31 + d_i),\r\n     \"input array must be ascending\")\r\n    d = d_i\r\n    while (m !== m_i || y !== y_i) {\r\n      //(II)\r\n      //a new month encountered: construct empty array for that month and the months before\r\n      m++\r\n      if (m === 12) {\r\n        y++\r\n        m=0\r\n      }\r\n      //array constructor\r\n      dayArray = []\r\n      for(var z=1, zlen = monthDays(m,y); z <= zlen; z++) {\r\n        dayArray.push(\r\n          { \r\n            \"i\": 0,\r\n            \"e\": 0,\r\n            \"d\": new Date(y, m, z),\r\n            \"b\": b,\r\n            \"smallestb\": smallestb,\r\n            \"l\": false\r\n          }\r\n        )\r\n      }\r\n\r\n      r.push({\r\n        \"columns\": dayArray,\r\n        \"range_text\": (m + 1) + \"/\" + y\r\n      })\r\n    }\r\n    // (III)  \r\n    //balances\r\n    //balances prior to day are set in array constructor\r\n    \r\n    console.assert(null != data_i.b, \"b is mandatory\")\r\n    console.assert(null != data_i.smallestb, \"smallestb is mandatory\")\r\n    console.assert(null != data_i.i, \"i is mandatory\")\r\n    console.assert(data_i.i >= 0, \"i must be positive\")\r\n    console.assert(null != data_i.e, \"e is mandatory\")\r\n    console.assert(data_i.e <= 0, \"i must be negative\")\r\n    console.assert(null != data_i.l, \"l is mandatory\")\r\n    \r\n    //calculate balance\r\n    if( !balances_given ) {\r\n    \tb = Math.round((b + data_i.i + data_i.e) * 100) / 100\r\n    \tsmallestb = b\r\n    } else {\r\n    \tb =  data_i.b\r\n    \tsmallestb = data_i.smallestb\r\n    }\r\n    \r\n    //fill up the array from this date  till end of month with balance\r\n    for(var z0 = data_i.d.getDate(), zlen0 = dayArray.length; z0 < zlen0; z0++) {\r\n       dayArray[z0].b = b\r\n       dayArray[z0].smallestb = smallestb\r\n    }\r\n    //update i, e and balance in array\r\n    dayArray[data_i.d.getDate()-1].i = data_i.i\r\n    dayArray[data_i.d.getDate()-1].e = data_i.e\r\n    dayArray[data_i.d.getDate()-1].b = b \r\n    dayArray[data_i.d.getDate()-1].smallestb = smallestb\r\n    dayArray[data_i.d.getDate()-1].l = data_i.l\r\n  }\r\n  \r\n  //(IV) add to each day balances of previous and next days\r\n  for(var ax = 0, axlen = r.length; ax < axlen; ax++) {\r\n    for( var ix = 0, ixlen = r[ax].columns.length; ix < ixlen; ix++) {\r\n      var data = r[ax].columns[ix]\r\n      if (!ax && !ix) {\r\n        data.prev_b = null;\r\n      } else if((ax + 1) === axlen && (ix + 1) === ixlen) {\r\n        data.next_b = null;\r\n      } else if(!ix) {\r\n        data.prev_b = r[ax - 1].columns[r[ax - 1].columns.length - 1].b\r\n      } else if((ix + 1) === ixlen) {\r\n        data.next_b = r[ax + 1].columns[0].b\r\n      } \r\n      if (typeof data.prev_b === \"undefined\") {\r\n        data.prev_b = r[ax].columns[ix - 1].b\r\n      }\r\n      if (typeof data.next_b === \"undefined\") {\r\n        data.next_b = r[ax].columns[ix + 1].b       \r\n      }\r\n    }  \r\n  }\r\n  \r\n  //  - (V) add empty month to the beginning and end\r\n dayArray = []\r\n var prevm = new Date(r[0].columns[0].d)\r\n prevm.setMonth(prevm.getMonth()-1);\r\n m = prevm.getMonth()\r\n y = prevm.getFullYear()\r\n for(var z1=1, zlen1 = monthDays(m, y); z1 <= zlen1; z1++) {\r\n        dayArray.push(\r\n          { \r\n            \"i\": 0,\r\n            \"e\": 0,\r\n            \"d\": new Date(y, m, z1),\r\n            \"b\": 0,\r\n            \"smallestb\": 0,\r\n            \"l\": false\r\n          }\r\n        )\r\n  }\r\n  r.unshift({\r\n    \"columns\": dayArray,\r\n    \"range_text\": (m + 1) + \"/\" + y\r\n  })\r\n\r\n dayArray = []\r\n var last = r[r.length-1].columns[r[r.length-1].columns.length-1]\r\n last.next_b = last.b\r\n var nextm = new Date(last.d)\r\n nextm.setDate(1)\r\n nextm.setMonth(nextm.getMonth() + 1);\r\n\r\n m = nextm.getMonth()\r\n y = nextm.getFullYear()\r\n for(var z2=1, zlen2 = monthDays(m, y); z2 <= zlen2; z2++) {\r\n\t \r\n        dayArray.push(\r\n          { \r\n            \"i\": 0,\r\n            \"e\": 0,\r\n            \"d\": new Date(y, m, z2),\r\n            \"b\": last.b,\r\n            \"smallestb\": last.smallestb,\r\n            \"prev_b\": last.b,\r\n            \"next_b\": last.b,\r\n            \"l\": false\r\n          }\r\n        )\r\n  }\r\n dayArray[dayArray.length -1].next_b = null\r\n  r.push({\r\n    \"columns\": dayArray,\r\n    \"range_text\": (m + 1) + \"/\" + y\r\n  })\r\n\r\n  return r;\r\n}\r\n\r\nexport {chunk_rawdata}\r\n","import React from 'react';\r\n\r\nimport {balances_load} from '../../actions/minibars'\r\nimport {set_daterange} from '../../actions/daterange'\r\nimport '../../../node_modules/c3/c3.min.css'\r\n\r\nimport { connect } from 'react-redux'\r\nimport { minibars } from './minibars_d3'\r\n\r\nclass Minibars extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n    \t\tstart: new Date(),\r\n    \t\tend: new Date(),\r\n    \t\tbalances: null,\r\n    \t\tredraw: null\r\n    }\r\n    // This binding is necessary to make `this` work in the callback\r\n    this.select = this.select.bind(this);\r\n    this.redraw = this.redraw.bind(this);\r\n    props.load();\r\n  }\r\n  \r\n  componentDidMount() {\r\n\t  var minibarconfig = {\r\n\t\t\t  \tmax_selection_days: 400,\r\n\t\t\t    bindto: this.props.name,\r\n\t\t\t    select: this.select,\r\n\t\t\t}  \r\n\t  \r\n\t  this.minibars = minibars;\r\n\t  this.minibars.config(minibarconfig);\r\n  }\r\n  \r\n  select(start, end) {\r\n\t  this.su = false;\r\n      this.props.setDateRange(new Date(start), new Date(end), \"rangePicker1\")\r\n  }\r\n  \r\n  redraw() {\r\n\t  this.minibars.generate(this.props.balances)\r\n\t  this.minibars.select(this.props.start, this.props.end)\r\n  }\r\n  \r\n  componentWillReceiveProps(nextProps){\r\n\t  this.minibars.generate(nextProps.balances)\r\n\t  this.minibars.select(nextProps.start, nextProps.end)\r\n  }\r\n\r\n  render() {\r\n    return (\r\n    \t<div>\r\n\t        <div id={this.props.name} />\r\n        </div>\r\n    );\r\n  }\r\n  \r\n}\r\n\r\nconst mapStateToProps = (store) => {\r\n\t  return {\r\n  \t\tstart: store.daterange.s,\r\n\t\tend: store.daterange.e,\r\n\t\tbalances: store.minibars.balances,\r\n\t\tredraw: store.minibars.redraw,\r\n\t  }\r\n  }\r\n\r\nfunction mapDispatchToProps(dispatch) {\r\n    return({\r\n        load: () => {\r\n        \tdispatch(balances_load(0)) //all\r\n        },\r\n        setDateRange: (s, e, name) => {\r\n        \tdispatch(set_daterange(s, e, name)) \r\n        }\r\n    })\r\n}\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Minibars)\r\n","import React from 'react' // ← Main React library\r\nimport { Button } from 'react-bootstrap';\r\nimport { connect } from 'react-redux'\r\n\r\nimport { daterange_prev_block } from '../../../actions/daterange'\r\nvar FontAwesome = require('react-fontawesome');\r\n\r\nclass ButtonL extends React.Component{\r\n\tconstructor(props) {\r\n\t    super(props)\r\n\t    this.prevBlock = this.prevBlock.bind(this)\r\n\t}\r\n\t\r\n\tprevBlock() {\r\n\t\tthis.props.daterangePrevBlock()\r\n\t}\r\n\t\r\n\trender(){\r\n\t    return (\r\n\t    <div>\r\n\t     <Button onClick={this.prevBlock}>\r\n\t     \t<FontAwesome name='caret-left' />\r\n\t     </Button>\r\n\t    </div>\r\n\t    )\r\n\t}\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch) {\r\n    return ({\r\n        daterangePrevBlock: () => {\r\n            dispatch(daterange_prev_block())\r\n        }\r\n    })\r\n}\r\n\r\nexport default connect(null, mapDispatchToProps)(ButtonL)\r\n","import React from 'react' // ← Main React library\r\nimport { Button } from 'react-bootstrap';\r\nimport { connect } from 'react-redux'\r\n\r\nimport { daterange_next_block } from '../../../actions/daterange'\r\nvar FontAwesome = require('react-fontawesome');\r\n\r\nclass ButtonR extends React.Component{\r\n\tconstructor(props) {\r\n\t    super(props)\r\n\t    this.nextBlock = this.nextBlock.bind(this)\r\n\t}\r\n\t\r\n\tnextBlock() {\r\n\t\tthis.props.daterangeNextBlock()\r\n\t}\r\n\t\r\n\trender(){\r\n\t    return (\r\n\t    <div>\r\n\t     <Button onClick={this.nextBlock}>\r\n\t     \t<FontAwesome name='caret-right' />\r\n\t     </Button>\r\n\t    </div>\r\n\t    )\r\n\t}\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch) {\r\n    return ({\r\n        daterangeNextBlock: () => {\r\n            dispatch(daterange_next_block())\r\n        }\r\n    })\r\n}\r\n\r\nexport default connect(null, mapDispatchToProps)(ButtonR)\r\n","import React from 'react';\r\nimport moment from 'moment';\r\nimport $ from 'jquery';\r\n// eslint-disable-next-line\r\nimport daterangepicker from 'daterangepicker';\r\nimport { connect } from 'react-redux'\r\n\r\n/*\r\n * Note: this must be included:\r\n    <link rel=\"stylesheet\" type=\"text/css\" media=\"all\" href=\"%PUBLIC_URL%/daterangepicker/daterangepicker.css\" />\r\n */\r\n\r\nvar dateRange_pickeroptions = {\r\n\t    \"dateLimit\": {\r\n\t        \"days\": 90\r\n\t    },\r\n\t    \"showWeekNumbers\": true,\r\n\t    \"autoApply\": true,\r\n\t    \"alwaysShowCalendars\": true,\r\n\t    \"locale\": {\r\n\t      \"direction\": \"ltr\",\r\n\t      \"format\": \"DD.MM.YYYY\",\r\n\t      \"separator\": \" - \",\r\n\t      \"applyLabel\": \"Apply\",\r\n\t      \"cancelLabel\": \"Cancel\",\r\n\t      \"fromLabel\": \"From\",\r\n\t      \"toLabel\": \"To\",\r\n\t      \"customRangeLabel\": \"Custom\",\r\n\t      \"daysOfWeek\": [\"Su\", \"Mo\", \"Tu\", \"We\", \"Th\", \"Fr\", \"Sa\"],\r\n\t      \"monthNames\": [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"],\r\n\t      \"firstDay\": 1\r\n\t    },\r\n\t    \"linkedCalendars\": false,\r\n\t    //\"startDate\": new Date(),\r\n\t    //\"endDate\": new Date(),\r\n\t    \"ranges\": {\r\n\t        'Last 7 Days': [moment().subtract(6, 'days'), moment()],\r\n\t        'Last 30 Days': [moment().subtract(29, 'days'), moment()],\r\n\t        'This Month': [moment().startOf('month'), moment().endOf('month')],\r\n\t        'Last Month': [moment().subtract(1, 'month').startOf('month'), moment().subtract(1, 'month').endOf('month')]\r\n\t     }\r\n\t  }\r\n\r\n\tvar dateSingle_pickeroptions = {\r\n\t        \"singleDatePicker\": true,\r\n\t        \"showDropdowns\": false,\r\n\t\t    \"showWeekNumbers\": true,\r\n\t\t    \"alwaysShowCalendars\": true,\r\n\t\t    \"autoApply\": true,\r\n\t\t    \"locale\": {\r\n\t\t      \"direction\": \"ltr\",\r\n\t\t      \"format\": \"DD.MM.YYYY\",\r\n\t\t      \"separator\": \" - \",\r\n\t\t      \"applyLabel\": \"Apply\",\r\n\t\t      \"cancelLabel\": \"Cancel\",\r\n\t\t      \"fromLabel\": \"From\",\r\n\t\t      \"toLabel\": \"To\",\r\n\t\t      \"customRangeLabel\": \"Custom\",\r\n\t\t      \"daysOfWeek\": [\"Su\", \"Mo\", \"Tu\", \"We\", \"Th\", \"Fr\", \"Sa\"],\r\n\t\t      \"monthNames\": [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"],\r\n\t\t      \"firstDay\": 1\r\n\t\t    },\r\n\t\t //   \"startDate\": new Date()\r\n\t\t  }\r\nclass DatePicker extends React.Component {\r\n   constructor(props) {\r\n\t    super(props);\r\n\t    this.state = {\r\n\t    \t\tstart: props.value ? props.value : props.start ? props.start : new Date(),\r\n\t    \t\tend: props.value ? null : props.end ? props.end : new Date()\r\n\t    }\r\n  }\r\n  \r\n  componentWillReceiveProps(nextProps){\r\n\t    //console.log('componentWillReceiveProps' + this.props.componentWillReceiveProps)\r\n\t    if(nextProps.value) {\r\n\t    \t//console.log(\"VALUE=\" + nextProps.value)\r\n\t    \t$('#' + this.props.pickerName).data('daterangepicker').setStartDate(nextProps.value)\r\n\t    \t$('#' + this.props.pickerName).data('daterangepicker').setEndDate(nextProps.value)\r\n\t    } else if (nextProps.start) {\r\n\t    \t  //console.log(\"START=\" + nextProps.start)\r\n\t\t\t  $('#' + this.props.pickerName).data('daterangepicker').setStartDate(nextProps.start)\r\n\t\t\t  $('#' + this.props.pickerName).data('daterangepicker').setEndDate(nextProps.end)\r\n\t  \t} \r\n  }\r\n   \r\n  componentDidMount() {\r\n\t  //new:\r\n\t\tif(this.props.pickerType === \"single\") {\r\n\t\t\t$('#' + this.props.pickerName).daterangepicker(\r\n\t\t\t\t\tdateSingle_pickeroptions, \r\n\t\t\t\t\t(start) =>  {\r\n\t\t\t\t\t\t//console.log('New single date selected: ' + start.format('MM.DD.YYYY'));\r\n\t\t\t\t\t\tthis.props.pickerCallback(start, this.props.pickerName)\r\n\t\t\t\t\t}\r\n\t\t\t)\r\n\t\t}\r\n\t\tif(this.props.pickerType === \"range\") {\r\n\t\t\t$('#' + this.props.pickerName).daterangepicker(\r\n\t\t\t\t\t  dateRange_pickeroptions, \r\n\t\t\t\t\t  (start, end) => { \r\n\t\t\t\t\t\t\t//console.log('New date range selected: ' + start.format('MM.DD.YYYY')+ \" - \" + end.format('MM.DD.YYYY'));\r\n\t\t\t\t\t\t\tthis.props.pickerCallback(start, end, this.props.pickerName)\r\n\t\t\t\t    }\r\n\t\t\t  )\r\n\t\t}\r\n\t\t$('#' + this.props.pickerName).data('daterangepicker').setStartDate(this.state.start)\r\n\t\tif (this.props.pickerType === \"range\") {\r\n\t\t\t$('#' + this.props.pickerName).data('daterangepicker').setEndDate(this.state.end)\r\n\t\t} else {\r\n\t\t\t$('#' + this.props.pickerName).data('daterangepicker').setEndDate(this.state.start)\t\r\n\t\t}\r\n\r\n  }\r\n  render() {\r\n    return (\r\n    \t\t<div>\r\n    \t\t\t<input readOnly\r\n    \t\t\t\tdisabled = {this.props.disabled}\r\n    \t\t\t\tautoComplete='off'\r\n    \t\t\t\tonKeyDown={function(e) { \r\n    \t\t\t\t\tvar char = e.which || e.keyCode;\r\n    \t\t\t\t\tif( char !== 9) {\r\n    \t\t\t\t\t\te.preventDefault(); return false;\r\n    \t\t\t\t\t}\r\n    \t\t\t\t}} \r\n    \t\t\t\ttype=\"text\" \r\n    \t\t\t\tid={this.props.pickerName} \r\n    \t\t\t\tclassName=\"form-control\" \r\n    \t\t\t\tstyle={{\r\n    \t\t\t\t\t\tdisplay: 'inline', \r\n    \t\t\t\t\t\twidth: this.props.pickerType === 'range' ? '185px' : '100px',\r\n    \t\t\t\t\t\t'backgroundColor' : (this.props.touched ? 'lightyellow' : this.props.disabled ? 'transparent' : 'white')\r\n    \t\t\t\t}}/>\r\n    \t\t</div>\r\n    );\r\n  }\r\n}\r\n\r\nDatePicker.defaultProps = {\r\n\t\tcomponentWillReceiveProps: false,\r\n\t    start: null, //initials.startDate,\r\n\t    end: null, //initials.endDate,\r\n\t    disabled: false,\r\n\t    touched: false\r\n}\r\n\r\nconst mapStateToProps = (store) => {\r\n\t  return {\r\n  \t\tstart: store.daterange.s,\r\n\t\tend: store.daterange.e\r\n\t  }\r\n  }\r\n\r\nexport default connect(mapStateToProps)(DatePicker)\r\n\r\n//module.exports = connect(mapStateToProps)(DatePicker)\r\n\r\n","//because IE11 does not support .find!!!\r\nfunction findInArray(array, booleanfunction) {\r\n  for(var i=0; i<array.length; i++) {\r\n\t  var item = array[i]\r\n\t  if(booleanfunction(item)) return item \r\n  }\r\n  return null;\r\n}\r\n\r\n//because IE11 does not support .find!!!\r\nfunction findIndexInArray(array, booleanfunction) {\r\n  for(var i=0; i<array.length; i++) {\r\n\t  var item = array[i]\r\n\t  if(booleanfunction(item)) return i \r\n  }\r\n  return -1;\r\n}\r\nexport {findInArray, findIndexInArray}","import React from 'react';\r\nimport {SimpleSelect} from 'react-selectize'\r\nimport 'react-selectize/themes/index.css'\r\nimport { get_constants } from '../../actions/constants'\r\nimport { connect } from 'react-redux'\r\nimport { findInArray } from '../../util/findInArray'\r\n\r\nvar FontAwesome = require('react-fontawesome');\r\n\r\nconst width = 150\r\n\r\nclass Dropdown extends React.Component {\r\n\tconstructor(props) {\r\n\t    super(props);\r\n\t    this.state = {\r\n\t    \t\tselectedValue : null,\r\n\t    \t\t'items' :  props.getConstants(props.constants_id) // return null, but launches fetch\r\n\t    \t\t\r\n\t    }\r\n\t    this.constants_id = props.constants_id\r\n\t    this.onValueChange = this.onValueChange.bind(this);\r\n\t    this.className = this.className.bind(this);\r\n\t}\r\n\t\r\n\tonValueChange(item) {\r\n    \tthis.setState( {\r\n\t    \t\tselectedValue : item\r\n\t    })\r\n\t    this.props.onValueChange(item != null? item.value : null)\r\n    \treturn this.renderOption(item)\r\n    }\r\n\r\n\t\r\n    componentWillReceiveProps(nextProps){\r\n    \tif( nextProps.constants && nextProps.constants[this.props.constants_id]) {\r\n    \t\tvar constants = nextProps.constants[this.props.constants_id]\r\n    \t\tvar selectedItem = findInArray( constants,  c => { return c.value === nextProps.selectedValue} )\r\n\t    \t/*var selectedItem = constants.find( c => { return c.value === nextProps.selectedValue })*/\r\n\t    \tvar validConstants = constants.filter(  c => { return (c.valid || c === selectedItem) })\r\n\t    \tthis.setState({\r\n\t\t    \t\tselectedValue : selectedItem,\r\n\t\t    \t\t'items' : validConstants\t\t\r\n\t\t    })\r\n    \t}\r\n    }\r\n    \r\n\trenderOption(item) {\t\t\r\n\t\tif(item == null) {\r\n\t\t\treturn\r\n\t\t}\r\n    \treturn (\r\n\t\t\t<span style={{\r\n\t \t\t\t\t display: 'block', \r\n\t \t\t\t\t whiteSpace: 'nowrap',\r\n\t\t\t}}>\r\n\t\t\t\t<span style={{\r\n\t \t\t\t\t display: 'block', \r\n\t\t\t\t\t textOverflow: 'ellipsis',\r\n\t\t\t\t\t overflow: 'hidden',\r\n\t\t\t\t\t whiteSpace: 'nowrap',\r\n\t\t\t\t\t maxWidth: (width-50)+'px'\r\n\t    \t\t}}>\r\n\t\t\t\t\t<span style = {{'marginRight':'5px', 'marginLeft':'5px'}}>\r\n\t\t\t\t\t\t<FontAwesome name = 'square' style = {{'color': item.color}} />\r\n\t\t\t\t\t</span>\r\n\t    \t\t\t<span>\r\n\t    \t\t\t\t{item.label}\r\n\t    \t\t\t</span>\r\n\t    \t\t</span>\r\n\t\t\t</span>\r\n    \t)    \t\r\n    }\r\n\t\r\n\tclassName() {\r\n\t\tif(!this.props.readOnly && !this.props.touched) return 'simpledropdown'\r\n\t\tif(!this.props.readOnly && this.props.touched) return 'simpledropdown_touched'\r\n\t\tif(this.props.readOnly && !this.props.touched) return 'simpledropdown_ro'\r\n\t\tif(this.props.readOnly && this.props.touched) return 'simpledropdown_ro_touched'\r\n\t\t\r\n\t}\r\n\t\r\n\trender() {\r\n\t\treturn (\r\n\t\t<SimpleSelect\r\n\t\t\tclassName={this.className()}\r\n\t\t\tdisabled={this.props.readOnly}\r\n\t\t    style={{\r\n\t\t    \twidth: width+'px',\r\n\t\t    \tborder: 'none',\r\n\t\t    \tbackgroundColor: 'none',\r\n\t\t    \tbackgroundImage: 'none'\r\n\t\t    }}\r\n\t\t\trenderOption={this.renderOption}\r\n\t\t\trenderValue={this.renderOption}\r\n\t\t\tonValueChange={this.onValueChange}\r\n\t        placeholder={this.props.placeholder}\r\n\t        options = {this.state.items}\r\n\t\t\tvalue = {this.state.selectedValue}\r\n\t\t\thideResetButton = {true}\r\n\t\t\tcancelKeyboardEventOnSelection = {false}\r\n\t\t/>)\r\n\t}\r\n}\r\n\r\nDropdown.defaultProps = {\r\n\t\trefreshTime: null,\r\n\t\tonValueChange: null,\r\n\t    touched: false,\r\n\t    readOnly: false,\r\n\t    placeholder: '',\r\n\t    constants: null,\r\n\t    constants_id: null\r\n}\r\n\r\nconst mapStateToProps = (store) => {\r\n    return {\r\n    \trefreshTime:  store.constants.refreshTime,\r\n        constants: store.constants.constants\r\n    }\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch) {\r\n    return({\r\n        getConstants: (id) => {\r\n        \tget_constants(id, dispatch)\r\n        }\r\n    })\r\n}\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Dropdown)\r\n","import React from 'react';\r\nimport { connect } from 'react-redux'\r\nimport { balances_load } from '../../actions/minibars'\r\nimport Dropdown from '../dropdown/dropdown'\r\nimport CheckboxField from '../editorFields/CheckboxField'\r\n\r\nclass ConstantFilter extends React.Component {\r\n\tconstructor(props) {\r\n\t    super(props);\r\n\t    this.state = {\r\n\t    \tfilter: null,\r\n\t    \tchecked: true\r\n\t    }\r\n\t    this.onFilterChanged = this.onFilterChanged.bind(this);\r\n\t    this.onCheck = this.onCheck.bind(this);\r\n  \t}\r\n\t  \r\n\tonFilterChanged(e) {\r\n\t\tthis.setState(\r\n\t\t\t\t{\r\n\t\t\t\t\tfilter: e\r\n\t\t\t\t})\r\n\t\tthis.props.balances_load(e)\r\n\t}\r\n\t\r\n\tonCheck(e) {\r\n\t\tthis.setState(\r\n\t\t\t\t{\r\n\t\t\t\t\tchecked: e\r\n\t\t\t\t})\r\n\t\tif(e) {\r\n\t\t\tthis.props.balances_load(0)\r\n\t\t} else if(this.state.filter) {\r\n\t\t\tthis.props.balances_load(this.state.filter)\r\n\t\t}\r\n\t}\r\n\t\r\n\t\r\n\trender() {\t\r\n\t\tvar dd = \t<Dropdown \r\n\t\t\t    \t\treadOnly = {this.state.checked}\r\n\t\t\t    \t\tonValueChange={ this.onFilterChanged } \r\n\t\t\t    \t\tselectedValue={this.state.filter}\r\n\t\t\t    \t\tplaceholder='filter'\r\n\t\t\t    \t\tconstants_id='cat'\r\n\t\t\t    \t/>\r\n\t\treturn(\r\n\t    <div>\r\n\t\t    <span style={{display: \"inline-flex\"}}>\r\n\t\t    \t<div style={{paddingTop: \"7px\", paddingRight: \"5px\"}}>\r\n\t\t    \tAll \r\n\t\t    \t</div>\r\n\t\t    \t<CheckboxField\r\n\t\t    \t\t\tid = 'all'\r\n\t\t\t\t  \t\tonValueChanged = {this.onCheck}\r\n\t\t\t\t  \t\tchecked = {this.state.checked}\r\n\t\t\t\t/>\r\n\t\t    \t{ !this.state.checked ? dd : null }\r\n\t\t    </span>\r\n\t    </div>)\r\n\t}\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch) {\r\n    return({\r\n        balances_load: (e) => {\r\n        \tdispatch(balances_load(e)) \r\n        }\r\n    })\r\n}\r\n\r\nexport default connect(null, mapDispatchToProps)(ConstantFilter)\r\n","import React from 'react' // ← Main React library\r\nimport { Panel } from 'react-bootstrap';\r\nimport { set_daterange } from '../../actions/daterange'\r\nimport { minibars_redraw } from '../../actions/minibars'\r\n\r\nimport Minibars from '../minibars/minibars'\r\nimport ButtonL from '../minibars/buttons/buttonL'\r\nimport ButtonR from '../minibars/buttons/buttonR'\r\n\r\nimport DatePicker from '../datepicker/datepicker'\r\n\r\nimport ConstantFilter from '../constantfilter/ConstantFilter'\r\n\r\nimport { connect } from 'react-redux'\r\n\r\nimport Spinner from './Spinner'\r\n\r\nimport Media from 'react-media';\r\n\r\nvar FontAwesome = require('react-fontawesome');\r\n\r\n\r\nclass RangePanel extends React.Component{\r\n\tconstructor(props) {\r\n\t\tsuper(props)\r\n\t\tthis.showMinibars = this.showMinibars.bind(this)\r\n\t\tthis.state = {\r\n\t\t\tshowMinibars: false\r\n\t\t}\r\n\t}\r\n\t\r\n\tshowMinibars() {\r\n\t\tthis.setState({\r\n\t\t\tshowMinibars : !this.state.showMinibars\r\n    \t})\r\n    \tvar that = this\r\n\t\tvar f = () => {\r\n\t    \t\t\tthat.props.minibarsRedraw()\r\n\t    }\r\n\t    //console.log(\"FIRE:\")\r\n\t    setTimeout(f, 0)\r\n\t}\r\n\r\n\trender(){\r\n\t\t/*\r\n\t\treturn(\r\n\t\t<div>\r\n\t\t\t<Panel style={{width: '100%'}}>\r\n\t\t\t  \t<Panel.Heading style={{paddingTop: \"3px\", paddingBottom: \"3px\", height: \"45px\"}}>\r\n\t\t\t  \t\t<div style={{\"display\": \"inline-flex\", \"whiteSpace\": \"nowrap\", \"alignItems\": \"center\", fontSize: \"23px\"}}>\r\n\t\t              \t\t  <FontAwesome name='calendar' />-<FontAwesome name='calendar' />&nbsp;\r\n\t\t\t\t              <DatePicker componentWillReceiveProps = {true} pickerName=\"rangePicker1\" pickerType=\"range\"\r\n\t\t\t\t\t              pickerCallback=\r\n\t\t\t\t\t              \t{(start, end, name) => {this.props.setDateRange(new Date(start), new Date(end))}}\r\n\t\t\t\t              />&nbsp;<Spinner fetching={this.props.fetching} /> \r\n\t\t               </div>\r\n\t\t\t\t       <span className=\"pull-right\" style={{paddingLeft: \"20px\"}}>  \r\n\t\t\t\t       \t\t<ConstantFilter />\r\n\t\t\t\t      </span>\r\n\t\t\t\t      <span className=\"pull-right\">\r\n\t\t\t\t  \t\t\t<Buttons />\r\n\t\t\t\t  \t  </span>\r\n\t\t\t  \t\r\n\t\t\t  \t</Panel.Heading>\r\n\t\t\t  \t<Panel.Body>\r\n\t\t\t  \t\t<Minibars name=\"minibar\"/>\r\n\t\t\t  \t\t{this.props.children}\r\n\t\t\t\t</Panel.Body>\r\n\t\t\t  </Panel>\r\n\t\t</div>\r\n\t\t)*/\r\n\t\t\r\n\r\n\t\tvar ctrls = this.state.showMinibars ?\r\n\t\t\t\t       <span className=\"pull-right\" style={{paddingLeft: \"20px\"}}>  \r\n\t\t\t\t       \t\t<ConstantFilter />\r\n\t\t\t\t       </span>\r\n\t\t\t\t  \t :\r\n\t\t\t\t  \t   null\r\n\t\t\t//451\r\n\t\tvar header =\r\n\t\t\t      <div>\r\n\t\t\t  \t\t   <div style={{\"display\": \"inline-flex\", \"whiteSpace\": \"nowrap\", \"alignItems\": \"center\", fontSize: \"23px\"}}>\r\n\t                      <FontAwesome name='calendar' />-<FontAwesome name='calendar' />&nbsp;\r\n\t                      \t<div style={{paddingTop: \"1px\"}}>\r\n\t                      \t\t<ButtonL  />\r\n\t                      \t</div>\r\n\t\t\t\t\t        <DatePicker componentWillReceiveProps = {true} pickerName=\"rangePicker1\" pickerType=\"range\"\r\n\t\t\t\t\t              pickerCallback={(start, end, name) => {this.props.setDateRange(new Date(start), new Date(end))}}\r\n\t\t\t\t\t        />\r\n\t\t\t\t\t        <div style={{paddingTop: \"1px\"}}>\r\n\t                        \t<ButtonR />\r\n\t                       </div>\r\n\t\r\n\t                     </div>\r\n\t\t\t             <span>\r\n\t\t\t\t\t\t\t\t<Panel.Toggle componentClass=\"button\" className=\"link-button\" onClick={this.showMinibars} style={{textDecoration: 'none'}}>&nbsp;\r\n\t\t\t\t\t\t\t\t\t{ (this.state.showMinibars ? <FontAwesome name='caret-up' size='2x' /> : <FontAwesome name='caret-down' size='2x' />) }&nbsp;\r\n\t\t\t            \t\t</Panel.Toggle>\r\n\t\t\t            </span><Spinner fetching={this.props.fetching} />\r\n\t\t           {ctrls}\r\n\t\t         </div>\r\n\t\t\t\r\n\t\treturn(\r\n\t\t<Panel style={{width: '100%', opacity: this.props.fetching ? 0.3 : 1 }} id=\"minibars-panel\" expanded={this.state.showMinibars} onToggle={() => {}}  >\r\n         \r\n\t\t\t\t<Media query=\"(max-width: 604px)\">\r\n\t\t\t          {matches =>\r\n\t\t\t            matches ? (\r\n\t\t\t              \t\t  <Panel.Heading style={{paddingTop: \"3px\", paddingBottom: \"3px\", height: \"80px\"}}>\r\n\t\t\t              \t\t  \t{header}\r\n\t\t\t              \t\t </Panel.Heading>\r\n\t\t\t            ) : (\r\n\t\t\t             \t\t  <Panel.Heading style={{paddingTop: \"3px\", paddingBottom: \"3px\", height: \"45px\"}}>\r\n\t\t\t             \t\t  \t{header}\r\n          \t\t\t\t\t\t </Panel.Heading>\r\n\t\t\t            )\r\n\t\t\t          }\r\n    \t\t\t</Media>\r\n\t\t\r\n\r\n          <Panel.Collapse>\r\n            <Panel.Body >\r\n            \t<Minibars name=\"minibar\" />\r\n            </Panel.Body>\r\n          </Panel.Collapse>\r\n        </Panel>)\r\n        \r\n\t}\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch) {\r\n    return ({\r\n        'setDateRange': (start, end) => {\r\n            dispatch(set_daterange(start, end))\r\n        },\r\n        minibarsRedraw: () => {\r\n            dispatch(minibars_redraw())\r\n        }\r\n    })\r\n}\r\n\r\nconst mapStateToProps = (store) => {\r\n    return {\r\n        fetching: store.minibars.fetching\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(RangePanel)\r\n\t\t\t\t\t\t","import { axios_get_params } from './axios'\r\nvar dateFormat = require('dateformat')\r\n\r\nconst PIE_REQUEST = 'PIE_REQUEST'\r\nconst pieRequestAction = (s, e) => ({\r\n    type: PIE_REQUEST,\r\n    payload: {\r\n        's': s,\r\n        'e': e\r\n    }\r\n})\r\n\r\n  \r\nconst PIE_RESPONSE = 'PIE_RESPONSE'\r\nconst pieResponseAction = (response) => (\r\n  { \r\n\ttype: PIE_RESPONSE,\r\n    payload: \r\n    \t{\r\n    \t\tslices : response\r\n    \t} \r\n  }\r\n)\r\n\r\nconst PIE_REDRAW = 'PIE_REDRAW'\r\nconst pieRedrawAction = () => (\r\n  { \r\n\ttype: PIE_REDRAW,\r\n    payload: \r\n    \t{\r\n    \t\tredraw : (new Date()).getTime() //only signal\r\n    \t} \r\n  }\r\n)\r\n\r\nvar params = null\r\n\r\nfunction get(dispatch) {\r\n    dispatch(pieRequestAction(params.s, params.e));\r\n    axios_get_params('pie?ts='+Date.now(), \r\n    \t\t{\t\t  \r\n\t\t  \t\tparams: params\r\n    \t\t},\r\n    \t\tresponse => {\r\n    \t\t\t// console.log(response);\r\n    \t\t\tdispatch(pieResponseAction(response.data))\r\n    \t\t},\r\n    \t\tdispatch\r\n\t  )\r\n}\r\n\r\nconst pie_load = (s, e) => (\r\n  (dispatch) => {\r\n\t  params = {\r\n\t\t\t  's': dateFormat(s, \"yyyy-mm-dd\"),\r\n\t\t\t  'e': dateFormat(e, \"yyyy-mm-dd\")\r\n\t  }\r\n\t  get(dispatch)\r\n    }\r\n)\r\n\r\nconst pie_refresh = () => (\r\n    (dispatch) => {\r\n        console.assert(params)\r\n        get(dispatch)\r\n    }\r\n)\r\n\r\nconst pie_redraw = () => (\r\n    (dispatch) => {\r\n    \tdispatch(pieRedrawAction())\r\n    }\r\n)\r\nexport {\r\n\tpie_load,\r\n\tpie_refresh,\r\n\tpie_redraw\r\n}\r\n","import { axios_get_params, axios_post } from './axios';\r\nimport { balances_refresh } from '../actions/minibars'\r\nimport { chart_refresh } from '../actions/chart'\r\nimport { pie_refresh } from '../actions/pie'\r\n\r\nvar dateFormat = require('dateformat');\r\n\r\nvar params = null //cache for refresh\r\nvar history = [] //day/account..  selection history\r\nvar current = -1;\r\n\r\n\r\nconst PAYMENTS_REQUEST = 'PAYMENTS_REQUEST'\r\nconst paymentsRequestAction = () => ({\r\n    type: PAYMENTS_REQUEST\r\n})\r\n\r\nconst PAYMENTS_RESPONSE = 'PAYMENTS_RESPONSE'\r\nconst paymentsResponseAction = (payments, balances) => ({\r\n    type: PAYMENTS_RESPONSE,\r\n    payload: {\r\n    \t\"params\" : params,\r\n    \t\"queryType\" : params.e,\r\n      \"payments\": payments,\r\n      \"balances\": balances,\r\n      \"historystack\": {\r\n    \t                 \"last\": current === history.length - 1,\r\n                         \"first\": current === 0,\r\n                      }\r\n    }\r\n})\r\n\r\n\r\nconst PAYMENTS_UPDATE_REQUEST = 'PAYMENTS_UPDATE_REQUEST'\r\nconst paymentsUpdateRequestAction = (updates) => ({\r\n    type: PAYMENTS_UPDATE_REQUEST,\r\n    payload: {\r\n    \t\"updates\": updates\r\n    }\r\n})\r\n\r\nconst PAYMENTS_UPDATE_RESPONSE = 'PAYMENTS_UPDATE_RESPONSE'\r\nconst paymentsUpdateResponseAction = () => ({\r\n    \ttype: PAYMENTS_UPDATE_RESPONSE\r\n})\r\n\r\nconst update = (updates) => (\r\n    (dispatch) => {\r\n        dispatch(paymentsUpdateRequestAction(updates))\r\n        axios_post('payments/update', \r\n        \t\tupdates,\r\n        \t\tresponse => {\r\n        \t\t\tdispatch(paymentsUpdateResponseAction())\r\n        \t\t\t//tähän kaikki refrhesit, jotka update aiheuttaa\r\n                    //refresh pie and minibars\r\n        \t\t\tdispatch(payments_refresh())\r\n        \t\t\tdispatch(pie_refresh())\r\n        \t\t\tdispatch(balances_refresh())\r\n        \t\t\tdispatch(chart_refresh())\r\n        \t\t},\r\n        \t\tdispatch\r\n        )\r\n    }\r\n )\r\n\r\n\r\nfunction make_history() {\r\n  if(current < history.length - 1) {\r\n\t  history = history.slice(0, current + 1)\r\n  }\r\n  history.push(params)\r\n  current++\r\n}\r\n\r\n\r\n\r\nfunction get(dispatch, historify = false) {\r\n    if(historify) {\r\n      make_history()\r\n    }\r\n    //history.forEach(x => console.log(x))\r\n   \t//console.log(\"---current:\" + current)\r\n    dispatch(paymentsRequestAction())\r\n    axios_get_params('payments',\r\n    \t\t{\r\n        \t\t\"params\": params\r\n    \t\t},\r\n    \t\t(response) => {\r\n    \t\t\tdispatch(paymentsResponseAction(response.data[0], response.data[1]))\r\n    \t\t},\r\n    \t\tdispatch\r\n    )\r\n}\r\n\r\nconst day_load = (d) => (\r\n    (dispatch) => {\r\n        params = {\r\n            \"e\": \"d\",\r\n            \"d\": dateFormat(d, \"yyyy-mm-dd\")\r\n        }\r\n        get(dispatch, true)\r\n    }\r\n)\r\n\r\nconst account_load = (a, d1, d2) => (\r\n    (dispatch) => {\r\n        params = {\r\n            \"e\": \"a\",\r\n            \"a\": a,\r\n            \"d1\": dateFormat(d1, \"yyyy-mm-dd\"),\r\n            \"d2\": dateFormat(d2, \"yyyy-mm-dd\")\r\n        }\r\n        get(dispatch, true)\r\n    }\r\n)\r\n\r\nconst category_load = (c, d1, d2) => (\r\n    (dispatch) => {\r\n        params = {\r\n            \"e\": \"c\",\r\n            \"c\": c,\r\n            \"d1\": dateFormat(d1, \"yyyy-mm-dd\"),\r\n            \"d2\": dateFormat(d2, \"yyyy-mm-dd\")\r\n        }\r\n        get(dispatch, true)\r\n    }\r\n)\r\n\r\nconst group_load = (g) => (\r\n    (dispatch) => {\r\n        params = {\r\n            \"e\": \"g\",\r\n            \"g\": g\r\n        }\r\n        get(dispatch, true)\r\n    }\r\n)\r\n\r\nconst list_load = (ids) => (\r\n    (dispatch) => {\r\n        params = {\r\n            \"e\": \"l\",\r\n            \"ids\": ids\r\n        }\r\n        get(dispatch, true)\r\n    }\r\n)\r\n\r\nconst payments_refresh = () => (\r\n    (dispatch) => {\r\n        console.assert(params)\r\n        get(dispatch)\r\n    }\r\n)\r\n\r\nconst prev_in_history = () => (\r\n  (dispatch) => {\r\n      current--\r\n      params = history[current]\r\n      get(dispatch)\r\n  }\r\n)\r\n\r\nconst next_in_history = () => (\r\n  (dispatch) => {\r\n      current++\r\n      params = history[current]\r\n      get(dispatch)\r\n  }\r\n)\r\n\r\nexport {\r\n    prev_in_history,\r\n    next_in_history,\r\n    day_load,\r\n    account_load,\r\n    category_load,\r\n    group_load,\r\n    list_load,\r\n    payments_refresh,\r\n    update\r\n}","import {axios_get_params} from './axios';\r\nimport { balances_refresh } from '../actions/minibars'\r\n\r\nconst LOCK_PAYMENT_REQUEST = 'LOCK_PAYMENT_REQUEST'\r\nconst lockPaymentRequestAction = (lock_payment_request, locked) => {\r\n    return {\r\n        type: LOCK_PAYMENT_REQUEST,\r\n        payload: {\r\n            lock_payment_request: lock_payment_request,\r\n            locked: locked\r\n        }\r\n    }\r\n}\r\n\r\nconst LOCK_PAYMENT_RESPONSE = 'LOCK_PAYMENT_RESPONSE'\r\nconst lockPaymentResponseAction = (payment, locked) => {\r\n    return {\r\n        type: LOCK_PAYMENT_RESPONSE,\r\n        payload: {\r\n            payment: payment\r\n        }\r\n    }\r\n}\r\n\r\nconst lock_payment = (payment, locked) => (\r\n    (dispatch) => {\r\n        dispatch(lockPaymentRequestAction(payment, locked))\r\n        axios_get_params('lock',\r\n        \t\t{\r\n                \tparams: {\r\n                \t\t\"id\": payment,\r\n                \t\t\"l\": locked\r\n                \t}\r\n        \t\t},\r\n        \t\tresponse => {\r\n        \t\t\tdispatch(lockPaymentResponseAction(payment, locked))\r\n        \t\t\tconsole.log('ref')\r\n        \t\t\tdispatch(balances_refresh())\r\n                //DO NOT dispatch(payments_refresh()) : it will refresh possibly unsubmitted payments, \r\n                \r\n        \t\t},\r\n        \t\tdispatch\r\n        )\r\n    }\r\n )\r\n    \r\nconst PAYMENT_SELECTION = 'PAYMENT_SELECTION'\r\nconst paymentSelectionAction = (payments) => {\r\n    return {\r\n        type: PAYMENT_SELECTION,\r\n        payload: {\r\n            \"payments\": payments\r\n        }\r\n    }\r\n}\r\n\r\nconst payment_selection = (payments) => (\r\n    (dispatch) => {\r\n        dispatch(paymentSelectionAction(payments))\r\n    }\r\n)\r\n\r\n export {\r\n    lock_payment,\r\n    payment_selection\r\n}","const CALC_ADD_REQUEST = 'CALC_ADD_REQUEST'\r\nconst calcAddRequestAction = (p) => ({\r\n    type: CALC_ADD_REQUEST,\r\n    payload: {\r\n        \"p\": p\r\n    }\r\n})\r\n\r\n const calc_add = (p) => (\r\n    (dispatch) => {\r\n        dispatch(calcAddRequestAction(p))\r\n    }\r\n )\r\n \r\nexport {\r\n    calc_add\r\n}","import React from 'react'\r\nimport { connect } from 'react-redux'\r\nimport { Button, Modal } from 'react-bootstrap';\r\nimport LogEntry from '../logs/logEntry'\r\nimport './style.css'\r\n\r\nclass HistoryModal extends React.Component {\r\n  render() {\r\n\tif(this.props.logentries == null) return null\r\n  var r = this.props.logentries[0]\r\n\r\n  var {show, onHide} = {...this.props}\r\n\tvar props = {show, onHide}\r\n\treturn (\r\n\r\n      <Modal\r\n        {...props}\r\n        size=\"lg\"\r\n        aria-labelledby=\"contained-modal-title-vcenter\"\r\n        centered=\"true\"\r\n        dialogClassName=\"modal-90w\"\r\n      >\r\n        <Modal.Header closeButton>\r\n          <Modal.Title id=\"contained-modal-title-vcenter\">\r\n            History\r\n          </Modal.Title>\r\n        </Modal.Header>\r\n        <Modal.Body>\r\n        \t<LogEntry logEntry={r} singleEntry={true}/>\r\n        </Modal.Body>\r\n        <Modal.Footer>\r\n          <Button onClick={this.props.onHide}>Close</Button>\r\n        </Modal.Footer>\r\n      </Modal>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (store) => {\r\n    return {\r\n        logentries: store.auditlog.logentries,\r\n        //fetching: store.auditlog.fetching\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps)(HistoryModal)","import Toggle from 'react-toggle'\r\nimport React from 'react';\r\nimport { lock_payment } from '../../actions/payment'\r\nimport { connect } from 'react-redux'\r\n\r\nimport './toggle.css'\r\n\r\nvar FontAwesome = require('react-fontawesome')\r\n\r\n\r\n\r\nclass Lock extends React.Component {\r\n\trender() {\r\n\t\treturn <FontAwesome name='lock' style={{ 'color':'white' }}/>\r\n\t}\r\n}\r\n\r\nclass Unlock extends React.Component {\r\n\trender() {\r\n\t\treturn <FontAwesome name='unlock-alt' style={{ 'color':'white' }}/>\r\n\t}\r\n}\r\n\r\nclass LockField extends React.Component {\r\n\t  constructor(props) {\r\n\t\t    super(props);\r\n\t\t    this.toggleLock = this.toggleLock.bind(this);\r\n\t  }\r\n\t  \r\n\t  toggleLock(e) {\r\n\t\t  \tconst {field, index} = this.props\r\n\t\t\tvar locked = !e.target.checked;\r\n\t\t\tthis.props.onValueChanged(locked, field, index )\r\n\t\t\tthis.props.lockPayment(this.props.id, locked)\r\n\t  }\r\n\t  \r\n\t  componentWillReceiveProps(nextProps){\r\n\t\t  this.setState({\r\n\t        checked : nextProps.checked,\r\n\t\t  })\r\n\t  }\r\n\t  render() {\r\n\t\tconst {readOnly, checked} = this.props\r\n\r\n\t    return (\r\n\t    <div style={{paddingTop: 8}}>\r\n\t\t\t<Toggle\r\n\t\t\t\tdisabled = {readOnly}\r\n\t\t\t    checked = {!checked}\r\n\t    \t\tonChange = {this.toggleLock}\r\n\t    \t\ticons={{\r\n\t    \t\t      checked: <Unlock />,\r\n\t    \t\t      unchecked: <Lock />,\r\n\t    \t\t}}\t\r\n\t\t\t/>\r\n\t    </div>)\r\n\t  }\r\n\t}\r\n\r\nLockField.defaultProps = {\r\n\t\tid: null,\r\n\t\tonValueChanged: null,\r\n\t\tchecked : false,\r\n\t\treadOnly : false,\r\n\t\tfield: null,\r\n\t\tindex: null,\r\n}\r\n\r\n\r\nfunction mapDispatchToProps(dispatch) {\r\n    return({\r\n        lockPayment: (id, locked) => {\r\n        \tdispatch(lock_payment(id, locked)) \r\n        }\r\n    })\r\n}\r\n\r\nexport default connect(null, mapDispatchToProps)(LockField)\r\n","import React from 'react';\r\nimport {Button, OverlayTrigger, Popover} from 'react-bootstrap'\r\n\r\nfunction setCaretPosition(elemId, caretPos) {\r\n    var elem = document.getElementById(elemId);\r\n\r\n    if(elem != null) {\r\n        if(elem.createTextRange) {\r\n            var range = elem.createTextRange();\r\n            range.move('character', caretPos);\r\n            range.select();\r\n        }\r\n        else {\r\n            if(elem.selectionStart) {\r\n                elem.focus();\r\n                elem.setSelectionRange(caretPos, caretPos);\r\n            }\r\n            else\r\n                elem.focus();\r\n        }\r\n    }\r\n}\r\n\r\nconst normalizeCurrency = value => {\r\n    if (!value) {\r\n        return value\r\n    }\r\n    if (value === \"-\" || value === \"+\") {\r\n        value += \"0\"\r\n    }\r\n    var plus = value.lastIndexOf('+');\r\n    var minus = value.lastIndexOf('-');\r\n\r\n    value = value.replace(/[^\\d]/g, '')\r\n    if (value === \"\") {\r\n        value = \"0\"\r\n    }\r\n    value = \"\" + parseInt(value, 10);\r\n    if (value.length < 3) {\r\n        value = \"00\".slice(-3 + value.length) + value\r\n    }\r\n\r\n    var res = (plus >= minus ? '+' : '-') + value.slice(0, -2) + \".\" + value.slice(-2)\r\n    return res;\r\n}\r\n\r\nclass CurrencyField extends React.Component {\r\n\r\n\tconstructor(props) {\r\n        super(props)\r\n        this.state = {\r\n        \tcurrencyValue : props.value\r\n        }\r\n\t\tthis.onChange = this.onChange.bind(this)\r\n\t\tthis.handleFocus = this.handleFocus.bind(this)\r\n\t\t\r\n\t\t\r\n    }\r\n\t\r\n\thandleFocus(event) {\r\n\t\t event.target.select();\r\n\t}\r\n\r\n\tonChange(e) {\r\n\t\t\r\n\t\tconst {onValueChanged, field, index, id} = this.props\r\n\t\tvar newCurrencyValue = normalizeCurrency(e.target.value)\r\n\t\tthis.setState({\r\n\t\t\tcurrencyValue : newCurrencyValue\r\n\t\t})\r\n\t\tonValueChanged(newCurrencyValue, field, index)\r\n\t\tsetCaretPosition(id, newCurrencyValue.length)\r\n\t\t\r\n\t}\r\n\t\r\n\t/*onChange(e) {\r\n\t\t\r\n\t\tconst {onValueChanged, field, index} = this.props\r\n\t\t//var newCurrencyValue = normalizeCurrency(e.target.value)\r\n\t\tthis.setState({\r\n\t\t\tcurrencyValue : e.target.value\r\n\t\t})\r\n\t\tonValueChanged(e.target.value, field, index)\r\n\r\n\t}*/\r\n\tcomponentWillReceiveProps(nextprops) {\r\n\t\tthis.setState({\r\n\t\t\tcurrencyValue : nextprops.value\r\n\t\t})\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tconst {id, readOnly, placeholder, touched, fontSize, linkCb, popoverText} = this.props\r\n\t\tvar inputField =\t\t\t\r\n\t    <div>\r\n\t\t\t<input\r\n\t\t\t  onFocus={this.handleFocus}\r\n\t\t\t  autoComplete='off'\r\n\t\t\t  id={id}\r\n\t\t\t  disabled={readOnly}\r\n\t\t\t  value={this.state.currencyValue}\r\n\t\t\t  onChange={this.onChange}\r\n\t          placeholder={readOnly ? '' : placeholder}  \r\n\t          type=\"text\"\r\n\t          className=\"form-control\" \r\n\t    \t  style={{\r\n\t    \t\t  'fontSize': fontSize,\r\n\t    \t\t  'textAlign': 'right', \r\n\t    \t\t  //'color' : this.state.currencyValue && this.state.currencyValue.startsWith('-') ? 'red' : 'green',\r\n\t    \t\t  'color' : this.state.currencyValue && (this.state.currencyValue.substr(0,1) === '-') ? 'red' : 'green',\r\n\t    \t\t  'display': 'inline',\r\n\t    \t\t  'width': '85px',\r\n\t    \t\t  'backgroundColor' : (touched ? 'lightyellow' : '')\r\n\t    \t  }} \r\n\t      />\r\n\t    </div>\r\n\r\n\t\tif(readOnly) {\r\n\t    \treturn(\r\n\t    \t<Button className=\"link-button\" onClick={ () => {linkCb(this.state.currencyValue)} } >\r\n\t\t\t\t{inputField}\r\n\t\t\t</Button>)\r\n\t    } else if( \r\n//\t    \t\ttouched ||\r\n\t    \t\t linkCb == null \r\n\t    \t\t|| this.state.currencyValue == null \r\n\t    \t\t//|| this.state.currencyValue.length === 0)\r\n\t    \t\t){\r\n\t\t    return (\r\n\t    \t<span style={{display: \"inline-flex\"}}>\r\n\t\t\t\t\t{inputField}\r\n\t    \t</span>)\r\n\t    \r\n\t    } else {\r\n\t\t    var linkButton = linkCb && this.state.currencyValue && this.state.currencyValue.length > 0?\r\n\t\t\t<Button className=\"link-button\" onClick={ () => {\r\n\t\t\t\tlinkCb(this.state.currencyValue)}\r\n\t\t\t}>\r\n\t\t\t\t{popoverText}\r\n\t\t\t</Button>\r\n\t\t\t:\r\n\t\t\tnull\r\n\t\t\t\r\n\t\t\t\r\n\t\t\treturn(\r\n\t\t\t    <div>\r\n\t\t\t    \t<span style={{display: \"inline-flex\"}}>\r\n\t\t\t\t\t\t<OverlayTrigger trigger='focus' key=\"top\" placement=\"top\"\r\n\t\t\t\t\t\t  overlay={\r\n\t\t\t\t\t\t    <Popover\r\n\t\t\t\t\t\t      id={`popover_cur_-positioned-${id}`}>\r\n\t\t\t\t\t\t    \t{linkButton}\r\n\t\t\t\t\t\t    </Popover>\r\n\t\t\t\t\t\t  }>\t    \t\r\n\t\t\t\t\t\t\t{inputField}\r\n\t\t\t\t\t\t</OverlayTrigger>\r\n\t\t\t    \t</span>\r\n\t\t\t    </div>)\r\n\t    }\r\n\t}\t\r\n}\r\n\r\nCurrencyField.defaultProps = {\r\n\t\tid: null,\r\n\t\tonValueChanged: null,\r\n\t\tplaceholder : '',\r\n\t\tvalue : '',\r\n\t\treadOnly : false,\r\n\t\tfield: null,\r\n\t\tindex: null,\r\n\t\ttouched: false,\r\n\t\tfontSize: 'inherit',\r\n\t\tlinkCb: null,\r\n\t\tpopoverText: null\r\n}\r\n\r\nexport default CurrencyField","import React from 'react';\r\nimport Dropdown from '../dropdown/dropdown'\r\n\r\nclass DropdownField extends React.Component {\r\n\trender() {\r\n\t\tconst {readOnly, field, index, onValueChanged, placeholder, touched, constants_id} = this.props\r\n\t\r\n\t\treturn(\r\n\t    <div>\r\n\t    \t<Dropdown \r\n\t    \t    readOnly={readOnly}\r\n\t    \t\tonValueChange={ (e) => {\r\n\t    \t\t\tonValueChanged(e, field, index ) \r\n\t    \t\t}} \r\n\t    \t\tselectedValue={this.props.value}\r\n\t    \t\tplaceholder={placeholder}\r\n\t    \t\ttouched={touched}\r\n\t    \t\tconstants_id={constants_id}\r\n\t    \t/>\r\n\t    </div>)\r\n\t}\t\r\n}\r\n\r\nDropdownField.defaultProps = {\r\n\t\tonValueChanged: null,\r\n\t\tvalue : null,\r\n\t\treadOnly : false,\r\n\t\tplaceholder : '',\r\n\t\tfield: null,\r\n\t\tindex: null,\r\n\t\ttouched: false,\r\n\t\tconstants_id: null\r\n}\r\n\r\nexport default DropdownField\r\n\r\n","import React from 'react';\r\nimport {Button, OverlayTrigger, Popover} from 'react-bootstrap'\r\n\r\nclass TextField extends React.Component {\r\n\r\n\tconstructor(props) {\r\n        super(props)\r\n        this.state = {\r\n        \ttxtValue : props.value\r\n        }\r\n        this.onChange = this.onChange.bind(this)\r\n    }\r\n\t\r\n\tonChange(e) {\r\n\t\tconst {onValueChanged, field, index} = this.props\r\n\t\tthis.setState({\r\n\t\t\ttxtValue : e.target.value\r\n\t\t})\r\n\t\tonValueChanged(e.target.value, field, index)\r\n\t}\r\n\r\n\tcomponentWillReceiveProps(nextprops) {\r\n\t\tthis.setState({\r\n\t\t\ttxtValue : nextprops.value\r\n\t\t})\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tconst {id, placeholder, readOnly, touched, linkCb, popoverText, maxLength} = this.props\r\n\t\t\r\n\t\tvar inputField = \r\n\t\t<input \r\n\t\t\t\tautoComplete='off'\r\n\t    \t    id={id}\r\n\t    \t\tvalue={this.state.txtValue}\r\n\t    \t    disabled={readOnly}\r\n\t    \t    style={{'backgroundColor' : (touched ? 'lightyellow' : '')}}\r\n\t    \t\tplaceholder={readOnly ? '' : placeholder} \r\n\t    \t\ttype=\"text\" \r\n\t    \t\tonChange={this.onChange}\r\n\t    \t\tclassName=\"form-control\"\r\n\t    \t\tmaxLength={maxLength}\r\n\t    />\r\n\t\r\n\t    if(readOnly && linkCb != null ) {\r\n\t    \t\r\n\t    \treturn(\r\n\t    \t<Button className=\"link-button\" onClick={ () => {linkCb(this.state.txtValue)} } >\r\n\t\t\t\t{inputField}\r\n\t\t\t</Button>)\r\n\t\t\t\r\n\t    } else if( touched \r\n\t    \t\t|| linkCb == null \r\n\t    \t\t|| this.state.txtValue == null \r\n\t    \t\t|| this.state.txtValue.length === 0) {\r\n\t    \t\t\r\n\t\t    return (\r\n\t    \t<span style={{display: \"inline-flex\"}}>\r\n\t\t\t\t\t{inputField}\r\n\t    \t</span>)\r\n\t    \r\n\t    } else {\r\n\t    \t\r\n\t\t\tvar linkButton = linkCb && this.state.txtValue && this.state.txtValue.length > 0?\r\n\t\t\t\t\t<Button className=\"link-button\" onClick={ () => {\r\n\t\t\t\t\t\tlinkCb(this.state.txtValue)}\r\n\t\t\t\t\t}>\r\n\t\t\t\t\t\t{popoverText}\r\n\t      \t\t\t</Button>\r\n\t\t\t:\r\n\t\t\tnull\r\n\t\t\t\r\n\t\t\treturn(\r\n\t\t    <div>\r\n\t\t    \t<span style={{display: \"inline-flex\"}}>\r\n\t\t\t\t\t<OverlayTrigger trigger='focus' key=\"top\" placement=\"top\"\r\n\t\t\t\t\t  overlay={\r\n\t\t\t\t\t    <Popover\r\n\t\t\t\t\t      id={`popover-positioned-${id}`}>\r\n\t\t\t\t\t    \t{linkButton}\r\n\t\t\t\t\t    </Popover>\r\n\t\t\t\t\t  }>\t    \t\r\n\t\t\t\t\t\t{inputField}\r\n\t\t\t\t\t</OverlayTrigger>\r\n\t\t    \t</span>\r\n\t\t    </div>)\r\n\t    }\r\n\t}\t\r\n}\r\n\r\nTextField.defaultProps = {\r\n\t\tid: null,\r\n\t\tplaceholder: '',\r\n\t\tonValueChanged: null,\r\n\t\tvalue : '',\r\n\t\treadOnly : false,\r\n\t\tfield: null,\r\n\t\tindex: null,\r\n\t\ttouched: false,\r\n\t\tlinkCb: null,\r\n\t\tpopoverText: null,\r\n\t\tmaxLength: 255\r\n}\r\n\r\nexport default TextField","import React from 'react';\r\nimport DatePicker from '../datepicker/datepicker'\r\nimport {Button, OverlayTrigger, Popover} from 'react-bootstrap'\r\n\r\nvar dateFormat = require('dateformat');\r\n\r\nclass DateField extends React.Component {\r\n\trender() {\r\n\r\n\t\tconst {id, onValueChanged, value, readOnly, field, index, touched, linkCb, popoverText} = this.props\r\n\t\tvar datePickerField =\r\n\t\t<div>\r\n\t    \t<DatePicker \r\n\t    \t    disabled={readOnly}\r\n\t    \t\tvalue={value}\r\n\t    \t\tid={id}\r\n\t    \t\tpickerName={'picker_d_' + id + index} \r\n\t    \t \tpickerCallback={(d) => onValueChanged(dateFormat(d, \"dd.mm.yyyy\"), field, index)}\r\n\t    \t \tpickerType=\"single\"\r\n\t    \t \ttouched = {touched}\r\n\t    \t \tstyle={{\r\n\t    \t\t  'backgroundColor' : (touched ? 'lightyellow' : '')\r\n\t    \t \t}}\r\n\t    \t />\r\n\t    </div>\r\n\t    \t\r\n\t    if(readOnly && linkCb != null) {\r\n\t    \t\r\n\t    \treturn(\r\n\t    \t<Button className=\"link-button\" onClick={ () => {linkCb(value)} } >\r\n\t\t\t\t{datePickerField}\r\n\t\t\t</Button>)\r\n\t\t\t\r\n\t    } else if( touched \r\n\t    \t\t|| readOnly\r\n\t    \t\t|| linkCb == null \r\n\t    \t\t|| value == null \r\n\t    \t\t|| value.length === 0) {\r\n\t    \t\t    \t\t\r\n\t\t    return (\r\n\t    \t<span style={{display: \"inline-flex\"}}>\r\n\t\t\t\t\t{datePickerField}\r\n\t    \t</span>)\r\n\t    \t\r\n\t    } else {\r\n\t\t\tvar linkButton = linkCb && value && value.length > 0?\r\n\t\t\t\t\t<Button className=\"link-button\" onClick={ () => {linkCb(value)}\r\n\t\t\t\t\t}>\r\n\t\t\t\t\t\t{popoverText}\r\n\t      \t\t\t</Button>\r\n\t\t\t:\r\n\t\t\tnull\r\n\t\t\t\r\n\t\t\treturn(\r\n\t\t    <div>\r\n\t\t    \t<span style={{display: \"inline-flex\"}} >\r\n\t\t\t\t\t<OverlayTrigger trigger='focus' key=\"top\" placement=\"top\"\r\n\t\t\t\t\t  overlay={\r\n\t\t\t\t\t    <Popover \r\n\t\t\t\t\t      id={'popover-d-positioned-'+id}>\r\n\t\t\t\t\t    \t{linkButton}\r\n\t\t\t\t\t    </Popover>\r\n\t\t\t\t\t  }>\t    \t\r\n\t\t\t\t\t\t{datePickerField}\r\n\t\t\t\t\t</OverlayTrigger>\r\n\t\t    \t</span>\r\n\t\t    </div>)\r\n\t    }\r\n\t}\t\r\n}\r\n\r\nDateField.defaultProps = {\r\n\t\tid: null,\r\n\t\tonValueChanged: null,\r\n\t\tvalue : true,\r\n\t\treadOnly : false,\r\n\t\tfield: null,\r\n\t\tindex: null,\r\n\t\ttouched: false,\r\n\t\tlinkCb: null,\r\n\t\tpopoverText: null\r\n}\r\n\r\nexport default DateField","import {toDateFi} from '../../util/fiDate'\r\nimport {addDays, addMonths} from '../../util/addDays'\r\nimport {isEven} from '../../util/math'\r\n\r\nvar dateFormat = require('dateformat')\r\n\r\nvar f = {\r\n\t\"DAILY\" : (payment, iteration) => {\r\n\t\tvar date = toDateFi(payment.d)\r\n\t\tvar date1 = addDays(date, 1)\r\n\t\tpayment.d = dateFormat(date1, \"dd.mm.yyyy\")\r\n\t},\r\n\t\"WEEKLY\" : (payment, iteration) => {\r\n\t\tvar date = toDateFi(payment.d)\r\n\t\tvar date1 = addDays(date, 7)\r\n\t\tpayment.d = dateFormat(date1, \"dd.mm.yyyy\")\r\n\t},\r\n\t\"FORTNIGHTLY\" : (payment, iteration) => {\r\n\t\tvar date = toDateFi(payment.d)\r\n\t\tvar date1 = addDays(date, 14)\r\n\t\tpayment.d = dateFormat(date1, \"dd.mm.yyyy\")\r\n\t},\r\n\t\"TWICE_A_MONTH\" : (payment, iteration) => {\r\n\t\tvar date = toDateFi(payment.d)\r\n\t\tvar date1 = null\r\n\t\tif(isEven(iteration)) {\r\n\t\t\tdate1 = addDays(date, 14)\r\n\t\t} else {\r\n\t\t\tdate1 = addDays(date, -14)\r\n\t\t\tdate1 = addMonths(date1, 1)\r\n\t\t}\r\n\t\tpayment.d = dateFormat(date1, \"dd.mm.yyyy\")\r\n\t},\r\n\t\"MONTHLY\" : (payment, iteration) => {\r\n\t\tvar date = toDateFi(payment.d)\r\n\t\tvar date1 = addMonths(date, 1)\r\n\t\tpayment.d = dateFormat(date1, \"dd.mm.yyyy\")\r\n\t},\r\n\t\"EVERY_OTHER_MONTH\" : (payment, iteration) => {\r\n\t\tvar date = toDateFi(payment.d)\r\n\t\tvar date1 = addMonths(date, 2)\r\n\t\tpayment.d = dateFormat(date1, \"dd.mm.yyyy\")\r\n\t},\r\n\t\"EVERY_3_MONTHS\" : (payment, iteration) => {\r\n\t\tvar date = toDateFi(payment.d)\r\n\t\tvar date1 = addMonths(date, 3)\r\n\t\tpayment.d = dateFormat(date1, \"dd.mm.yyyy\")\r\n\t},\r\n\t\"EVERY_4_MONTHS\" : (payment, iteration) => {\r\n\t\tvar date = toDateFi(payment.d)\r\n\t\tvar date1 = addMonths(date, 4)\r\n\t\tpayment.d = dateFormat(date1, \"dd.mm.yyyy\")\r\n\t},\r\n\t\"EVERY_6_MONTHS\" : (payment, iteration) => {\r\n\t\tvar date = toDateFi(payment.d)\r\n\t\tvar date1 = addMonths(date, 6)\r\n\t\tpayment.d = dateFormat(date1, \"dd.mm.yyyy\")\r\n\t},\r\n\t\"YEARLY\" : (payment, iteration) => {\r\n\t\tvar date = toDateFi(payment.d)\r\n\t\tvar date1 = addMonths(date, 12)\r\n\t\tpayment.d = dateFormat(date1, \"dd.mm.yyyy\")\r\n\t}\r\n}\r\n\r\nfunction recurrent(payment, iteration, span) {\r\n\tf[span](payment, iteration)\r\n}\r\n\r\nexport default recurrent","function isEven(n) {\r\n  n = Number(n);\r\n  return n === 0 || !!(n && !(n%2));\r\n}\r\n\r\nexport {isEven}","import {toDBFormatFi} from '../../util/fiDate'\r\nimport currencyFormat  from '../../util/currency'\r\n\r\nvar dateFormat = require('dateformat')\r\n\r\nconst fields = ['d','b','i','s','g','c','a','descr']\r\n\r\nconst defaultValues = {\r\n\tid: null,\r\n\tl: false ,\r\n\td: dateFormat(new Date(), \"dd.mm.yyyy\"),\r\n\ti: \"+0.00\",\r\n\tc: null,\r\n\ta: null,\r\n\ts: true,\r\n\tg: \"\",\r\n\tdescr: \"\",\r\n\tb: null\r\n}\r\n\r\nconst initialMaskValues = {\r\n\tid: null,\r\n\tl: false,\r\n\td: dateFormat(new Date(), 'dd.mm.yyyy'),\r\n\ti: '+0.00',\r\n\tc: null,\r\n\ta: null,\r\n\ts: true,\r\n\tg: '',\r\n\tdescr: '',\r\n\tb: null\r\n}\r\n\r\nconst \tvalidators = {\r\n\t'check': (value) => {\r\n\t\t\treturn null\r\n\t\t  },\r\n\t'l': (value) => {\r\n\t\t\treturn null\r\n\t\t  },\r\n\t'd': (value) => {\r\n\t\t\treturn (value != null && value !== '') ? null : 'required'\r\n\t\t  },\r\n\t'i':  (value) => {\r\n\t\t\treturn (value !== '') ? null : 'required'\r\n\t\t  },\r\n\t's': (value) => {\r\n\t\t\treturn null\r\n\t\t  },\r\n\t'c': (value) => {\r\n\t\t\treturn (value != null && value !== '') ? null : 'required'\r\n\t\t  },\r\n\t'a': (value) => {\r\n\t\t\treturn (value !== null && value !== '') ? null : 'required'\r\n\t\t  },\r\n\t'g': (value) => {\r\n\t\t\treturn null\r\n\t\t  },\r\n\t'descr': (value) => {\r\n\t\t\treturn null\r\n\t\t  },\r\n\t'b': (value) => {\r\n\t\t\treturn null\r\n\t\t  }\r\n}\r\n\r\nfunction preInitFormat(payments, checkedList) {\r\n\tvar copy = deepCopy(payments, checkedList)\r\n\tcopy.forEach((p) => {\r\n\t\t// 2006-12-31 -> 31.12.2005\r\n\t\tp.d = dateFormat(p.d, \"dd.mm.yyyy\")\r\n\t\t// 2 -> +2.00\r\n\t\tp.i =  (p.i >=0 ? '+' : '') + currencyFormat(p.i)\r\n\t})\r\n\treturn copy\r\n}\r\n\r\nfunction preSubmitFormat(payments) {\r\n\tpayments.forEach( (p) => {\r\n\t\tif(p.i) {\r\n\t\t\t// \"+2.00\" -> 2\r\n\t\t\tp.i =  parseFloat(p.i)\r\n\t\t\t//p.i_initial = parseFloat(p.i_initial)\r\n\t\t }\r\n\t\t if(p.d) {\r\n\t\t\t// \"1.12.2001\" -> \"2001-12-01\"\r\n\t\t\tp.d = toDBFormatFi(p.d)\r\n\t\t\t//p.d_initial = toDBFormatFi(p.d_initial)\r\n\t\t }\r\n\t})\r\n\treturn payments\r\n}\r\n\r\n\r\nfunction copyObject(b) {\r\n\treturn {\r\n\t\tcheck: b,\r\n\t\tid: b,\r\n\t\tl: b,\r\n\t\td: b,\r\n\t\ti: b,\r\n\t\tc: b,\r\n\t\ta: b,\r\n\t\ts: b,\r\n\t\tg: b,\r\n\t\tdescr: b,\r\n\t\t\"b\": b\r\n\t}\r\n}\r\n\r\nfunction copyPayment(payment, checkedList, index = null) {\r\n\treturn {\r\n\t\tcheck: checkedList.indexOf(payment.id) > -1,\r\n\t\tindex: index,\r\n\t\tid: payment.id,\r\n\t\tl: payment.l,\r\n\t\td: payment.d,\r\n\t\ti: payment.i,\r\n\t\tc: payment.c,\r\n\t\ta: payment.a,\r\n\t\ts: payment.s,\r\n\t\tg: payment.g,\r\n\t\tdescr: payment.descr,\r\n\t\tb: payment.b\r\n\t}\r\n}\r\n\r\nfunction  deepCopy(payments, checkedList) {\r\n\tvar copy = []\r\n\tif(payments) {\r\n        payments.forEach(\r\n            (p) => {copy.push(copyPayment(p, checkedList))}\r\n        )\r\n\t}\r\n\treturn copy\r\n}\r\n\r\nconst recurSpans = [\r\n\t{label: \"daily\", value: \"DAILY\"},\r\n\t{label: \"weekly\", value: \"WEEKLY\"},\r\n\t{label: \"fortnightly\", value: \"FORTNIGHTLY\"},\r\n\t{label: \"twice a month\", value: \"TWICE_A_MONTH\"},\r\n\t{label: \"monthly\", value: \"MONTHLY\"},\r\n\t{label: \"every other month\", value: \"EVERY_OTHER_MONTH\"},\r\n\t{label: \"every 3 months\", value: \"EVERY_3_MONTHS\"},\r\n\t{label: \"every 4 months\", value: \"EVERY_4_MONTHS\"},\r\n\t{label: \"every 6 months\", value: \"EVERY_6_MONTHS\"},\r\n\t{label: \"yearly\", value: \"YEARLY\"},\r\n\t];\r\n\r\nfunction initState(payments, checkedList, recurring = { recur: false, times: 1, span: recurSpans[4]} ) {\r\n\tvar copy = {\r\n\t\tvalues : [],\r\n\t\tinitial : [],\r\n\t\terrors : [],\r\n\t\ttouched : [],\r\n\t\tdeleted : [],\r\n\t\tmasked : copyObject(false),\r\n\t\tmaskValues : initialMaskValues,\r\n\t\tmaskErrors : copyObject(null),\r\n\t\tsort: null,\r\n\t\tasc: true,\r\n\t\tallChecked: false,\r\n\t\trecurring : recurring,\r\n\t}\r\n\tcopy.recurring.recur = false\r\n\t\r\n\tpayments.forEach((p, index) => {\r\n\t\tcopy.values.push(copyPayment(p, checkedList, index))\r\n\t\tcopy.initial.push(copyPayment(p, checkedList))\r\n\t\tcopy.errors.push(copyObject(null))\r\n\t\tcopy.touched.push(copyObject(false))\r\n\t\tcopy.deleted.push(false)\r\n\t})\r\n\treturn copy\r\n}\r\n\r\nfunction oneIsTrue(row) {\r\n\tvar ret =\r\n\t\trow.d ||\t\t\t\r\n\t\trow.i ||\r\n\t\trow.c ||\r\n\t\trow.a ||\r\n\t\trow.s ||\r\n\t\trow.g ||\r\n\t\trow.descr\r\n\t\t\r\n\treturn ret\r\n}\r\n\r\nfunction copyArray(array) {\r\n\treturn array.splice(0)\r\n}\r\n\r\nexport {\r\n\tfields,\r\n\tinitState,\r\n\tdefaultValues,\r\n\tinitialMaskValues, \r\n\tvalidators,\r\n\tpreInitFormat,\r\n\tpreSubmitFormat,\r\n\toneIsTrue,\r\n\tcopyArray,\r\n\trecurSpans,\r\n\tcopyPayment\r\n}","import React from 'react'\r\nimport { connect } from 'react-redux'\r\n\r\nimport { update } from '../../actions/payments'\r\nimport { payment_selection } from '../../actions/payment'\r\nimport { CATEGORY } from '../../actions/categories'\r\nimport { ACCOUNT } from '../../actions/accounts'\r\nimport { load as history_load } from '../../actions/auditlog'\r\nimport { calc_add } from '../../actions/calculator'\r\n\r\nimport { Table, Panel, Button, FormGroup, ControlLabel, FormControl } from 'react-bootstrap'\r\n\r\nimport HistoryModal from '../history/HistoryModal'\r\n\r\nimport LockField from '../editorFields/LockField'\r\nimport CurrencyField from '../editorFields/CurrencyFieldPopover'\r\nimport CheckboxField from '../editorFields/CheckboxField'\r\nimport DropdownField from '../editorFields/DropdownField'\r\nimport TextField from '../editorFields/TextField'\r\nimport TextFieldPopover from '../editorFields/TextFieldPopover'\r\nimport DateFieldPopover from '../editorFields/DateFieldPopover'\r\n\r\nimport NumericInput from 'react-numeric-input';\r\nimport alertOptions from '../../util/alertoptions'\r\n\r\nimport './PaymentsEditor.css'\r\nimport '../../customMultiSelect.css'\r\n\r\nimport { group_load } from '../../actions/payments'\r\nimport { day_load } from '../../actions/payments'\r\n\r\nimport {SimpleSelect} from 'react-selectize'\r\n\r\nimport {toDateFi} from '../../util/fiDate'\r\n\r\nimport recurrent from './recurrent'\r\n\r\nimport AlertContainer from 'react-alert'\r\n\r\nimport Media from 'react-media';\r\n\r\nimport {\r\n\t\tfields,\r\n\t\tinitState,\r\n\t\tdefaultValues,\r\n\t\tvalidators,\r\n\t\tpreInitFormat,\r\n\t\tpreSubmitFormat,\r\n\t\toneIsTrue,\r\n\t\tcopyArray,\r\n\t\trecurSpans,\r\n\t\tcopyPayment\r\n} from './constants'\r\n\r\nvar FontAwesome = require('react-fontawesome')\r\nvar dateFormat = require('dateformat');\r\n\r\nvar tempId = -1\r\nvar checkedSet = []\r\n\r\nclass PaymentsEditor extends React.Component {\r\n\r\n\tconstructor(props) {\r\n        super(props)\r\n        this.showAlert = this.showAlert.bind(this)\r\n        this.showOk = this.showOk.bind(this)\r\n        //postfix -abbr. F = Field, R = Row, T = Table\r\n        \r\n        //Field related:\r\n        \r\n        //callbacks from uicomponents for updating model (state)\r\n        this.changePropertyF = this.changePropertyF.bind(this)\r\n        this.changePropertyDeletedF = this.changePropertyDeletedF.bind(this)\r\n        this.changePropertyLF = this.changePropertyLF.bind(this)\r\n        \r\n        //set state values:\r\n        this.setValueF = this.setValueF.bind(this)\r\n        this.setValueCheckF = this.setValueCheckF.bind(this)\r\n        this.setValueCheckAllF = this.setValueCheckAllF.bind(this)\r\n        this.setValueMaskF = this.setValueMaskF.bind(this)\r\n        this.setValueMaskCheckF = this.setValueMaskCheckF.bind(this)\r\n        \r\n        //validate:\r\n        this.validateF = this.validateF.bind(this)\r\n        this.validateMaskF = this.validateMaskF.bind(this) \r\n        \r\n        //some field related util;\r\n        this.maskedF = this.maskedF.bind(this) //is field masked \r\n        this.touchedF = this.touchedF.bind(this) //dirty?\r\n        this.isDifferentFromInitialF = this.isDifferentFromInitialF.bind(this)        \r\n        this.drawBalanceF = this.drawBalanceF.bind(this)\r\n        \r\n        //choose right value for render\r\n        this.chooseValueF = this.chooseValueF.bind(this)\r\n\r\n        //render\r\n        this.renderContentF = this.renderContentF.bind(this)\r\n        this.renderDeletedContentF = this.renderDeletedContentF.bind(this)\r\n        \r\n        //sort\r\n        this.setSortF = this.setSortF.bind(this)\r\n        this.sortersF = this.sortersF.bind(this)\r\n        \r\n        //Row related:\r\n        \r\n        //add/remove\r\n        this.addR = this.addR.bind(this)\r\n        this.getDefaultR = this.getDefaultR.bind(this) //choose values for new row\r\n        this.removeR = this.removeR.bind(this)\r\n        this.setRecurring = this.setRecurring.bind(this)\r\n        this.setRecurringTimes = this.setRecurringTimes.bind(this)\r\n        this.setRecurringSpan = this.setRecurringSpan.bind(this)\r\n        \r\n        //validate\r\n        this.validateR = this.validateR.bind(this)\r\n        this.readOnlyR = this.readOnlyR.bind(this)\r\n        \r\n        //utils\r\n        this.isPersistedR = this.isPersistedR.bind(this)\r\n        this.disabledCheckR = this.disabledCheckR.bind(this) //row selection disabled\r\n\r\n        //render\r\n        this.renderPaymentR = this.renderPaymentR.bind(this)\r\n\r\n        //Table related:\r\n        this.resetT =  this.resetT.bind(this)\r\n        //util\r\n        this.isPristineT = this.isPristineT.bind(this)\r\n        this.hasErrorsT = this.hasErrorsT.bind(this)\r\n        \r\n        //format input/output\r\n        this.preInitT = this.preInitT.bind(this)\r\n        this.preSubmitT = this.preSubmitT.bind(this)\r\n        \r\n        //init constants\r\n        this.init =  this.init.bind(this)\r\n        //render\r\n        this.renderPaymentsHeaderT = this.renderPaymentsHeaderT.bind(this)\r\n        this.renderPaymentsT = this.renderPaymentsT.bind(this)\r\n        \r\n        this.renderNormalT = this.renderNormalT.bind(this)\r\n        /*this.renderNarrowT = this.renderNarrowT.bind(this)*/\r\n        \r\n        //save, new and rest aso\r\n        this.renderControls = this.renderControls.bind(this)\r\n        \r\n        //css and stuff\r\n        this.tdClassName = this.tdClassName.bind(this)\r\n        this.td = this.td.bind(this)\r\n        this.thClassName = this.thClassName.bind(this)\r\n        this.th = this.th.bind(this)\r\n        \r\n        this.groupLoad = this.groupLoad.bind(this)\r\n        this.dayLoad = this.dayLoad.bind(this)\r\n        this.showHistory = this.showHistory.bind(this)\r\n        \r\n        this.init()\r\n        var state = {...initState(this.preInitT(props.initPayments), checkedSet)}\r\n\r\n        this.state = {...state, historyShow: false}\r\n        this.state.maskValues.d = dateFormat(this.props.defaultDate)\r\n    }\r\n\t\r\n\tshowAlert() {\r\n\t\tthis.msg.show('SAVE YOUR CHANGES, OR RESET FIRST!', {\r\n\t      time: 5000,\r\n\t      type: 'success',\r\n\t      icon: <img src=\"stop.png\" alt=\"SAVE YOUR CHANGES, OR RESET FIRST!\"/>\r\n\t    })\r\n\t }\r\n\r\n\tshowOk() {\r\n\t\tthis.msg.show('SAVED SUCCESSFULLY', {\r\n\t      time: 2000,\r\n\t      type: 'success',\r\n\t      icon: <img src=\"yes.png\" alt=\"save ok\" />\r\n\t    })\r\n\t }\r\n\t\r\n    changePropertyF(value, field, index) {\r\n    \tif(index === -1){ //mask checkbox\r\n    \t\tthis.setValueMaskCheckF(field, value)\r\n    \t\treturn\r\n    \t}\r\n    \t\r\n    \tif(index === -2){ //mask value\r\n    \t\tthis.validateMaskF(field, value)\r\n    \t\tthis.setValueMaskF(field, value)\r\n    \t\treturn\r\n    \t}\r\n    \t\r\n    \t//touch\r\n\t\tif (this.isPersistedR(index)) { //new rows do not get 'touched' (unless masked)\r\n\t\t\tvar copy = copyArray(this.state.touched)\r\n\t\t\tcopy[index][field] = this.isDifferentFromInitialF(value, field, index)\r\n\t\t\tthis.setState({touched : copy})\r\n\t\t}\r\n\t\t\r\n\t\t//validate\r\n\t\tif(!this.state.masked[field]) { //do not validate masked fields\r\n\t\t\tthis.validateF(field, value, index)\r\n\t\t}\r\n    \tthis.setValueF(value, field, index)\r\n    }\r\n    \r\n    changePropertyDeletedF(value, field, index) {\r\n    \tif(this.isPersistedR(index)) { //if it has id, let backend remove: mark as deleted\r\n    \t\tthis.deleteCount += (value ? 1 : -1)\r\n    \t\tvar copy = copyArray(this.state.deleted)\r\n    \t\tcopy[index] = value\r\n    \t\tthis.setValueCheckF( false, 'check', index)\r\n    \t\tthis.setState({deleted : copy})\r\n    \t} else {\r\n    \t\tthis.removeR(index) //if newly created, just remove it\r\n    \t}\r\n    }\r\n    \r\n\tchangePropertyLF(value, field, index) { //updated on-the-fly (ie. lock-field), so don't set touched, set initial\r\n\t\tvar valuesCopy = copyArray(this.state.values)\r\n\t\tvaluesCopy[index].l = value\r\n\t\tvar initialCopy = copyArray(this.state.initial)\r\n\t\tinitialCopy[index].l = value\r\n\t\tthis.setState({\r\n\t\t\tvalues : valuesCopy,\r\n\t\t\tinitial : initialCopy\r\n\t\t})\r\n\t}\r\n\r\n\tsetValueF(value, field, index) {\r\n\t\tvar copy = copyArray(this.state.values)\r\n\t\tcopy[index][field] = value\r\n\t\tthis.setState({values : copy})\r\n\t}\r\n\r\n\tsetValueCheckF(value, field, index) {\r\n\t\tthis.updateCheckedSet(value, index)\r\n\t\tthis.setValueF(value, 'check', index)\r\n\t\tthis.props.paymentSelection(checkedSet.slice(0))  //broadcast\r\n\t}\r\n\t\r\n\tsetValueCheckAllF(value, field, index) {\r\n\t\tvar copy = this.state.values.slice(0)\r\n\t\tcopy.map( (v) => { \r\n\t\t\tthis.updateCheckedSet(value, v.index, copy)\r\n\t\t\treturn null\r\n\t\t})\r\n\t\tthis.setState({\r\n\t\t\tvalues: copy,\r\n\t\t\tallChecked : value\r\n\t\t})\r\n\t\tthis.props.paymentSelection(checkedSet.slice(0))\r\n\t}\r\n\t\r\n\tsetValueMaskF(field, value) {\r\n\t\tvar copy = {...this.state.maskValues}\r\n\t\tcopy[field] = value\r\n\t\tthis.setState({maskValues : copy})\r\n\t}\r\n\t\r\n\tsetValueMaskCheckF(field, set) {\r\n\t    var copy = {...this.state.masked}\r\n\t\tcopy[field] = set\r\n\t\tthis.setState({masked : copy})\r\n\r\n\t\t//clear/set errors of existing maskValues\r\n\t\tcopy = {...this.state.maskErrors}\r\n\t\tcopy[field] = !set ? null : validators[field](this.state.maskValues[field])\r\n\t\tthis.setState({maskErrors : copy})\r\n\r\n\t\t//clear/set errors of existing values masked\r\n\t\tvar copy2 = copyArray(this.state.errors)\r\n\t\tthis.state.values.forEach( (v, index) => {\r\n\t\t\tcopy2[index][field] = set ? null : validators[field](v[field])\r\n\t\t})\r\n\t\tthis.setState({errors : copy2})\r\n\t}\r\n\t\r\n\tvalidateF(field, value, index) {\r\n\t\tvar original = this.state.errors[index][field]\r\n\t\tvar result = validators[field](value) \r\n\t\tif( result !== original ) {\r\n\t\t\tvar copy = copyArray(this.state.errors)\r\n\t\t\tcopy[index][field] = validators[field](value) \r\n\t\t\tthis.setState({errors : copy})\r\n\t\t}\r\n\t}\r\n\t\r\n\tvalidateMaskF(field, value) {\r\n\t\tvar copy = {...this.state.maskErrors}\r\n\t\tcopy[field] = !this.state.masked[field] ? null : validators[field](value)\r\n\t\tthis.setState({maskErrors : copy})\r\n\t}\r\n\t\r\n\tmaskedF(index, field) {\r\n\t\tif(index<0 || this.state.deleted[index]) return false\r\n\t\treturn this.state.masked[field] && !this.state.values[index].l\r\n\t}\r\n\t\t\r\n\ttouchedF(index, field) {\r\n\t\tif(index<0) return false //mask-controls are never touched (-1 = checkbox -2 = mask value)\r\n\t\tif(this.state.deleted[index]) return false \t//to be deleted: not touched\r\n\t\tif(this.maskedF(index, field) && \r\n\t\t   this.isPersistedR(index) && \r\n\t\t   !this.isDifferentFromInitialF(this.state.maskValues[field], field, index)) return false //if masked and different: it is touched\r\n\t\tif(this.maskedF(index, field)) return true\r\n\t\tif(!this.isPersistedR(index)) return false \t//this is a new row: not touched and not masked\r\n\t\treturn this.state.touched[index][field]\r\n\t}\r\n\t\r\n\tisDifferentFromInitialF(value, field, index) {\r\n\t\treturn (value !== this.state.initial[index][field])\r\n\t}\r\n\r\n\tchooseValueF(index, field) {\r\n\t\tif(this.state.deleted[index]) return this.state.initial[index][field] //show initial values if to be deleted\r\n\t\treturn this.maskedF(index, field) ? this.state.maskValues[field] : this.state.values[index][field] \r\n\t}\r\n\t\r\n\trenderContentF(field, index) {\r\n    \tif(index === -1) {//mask -checkbox\r\n    \t\treturn(\r\n\t    \t<div>\r\n\t\t  \t\t<CheckboxField \r\n\t\t\t  \t\tid = {field + '_mask_check'}\r\n\t\t\t  \t\tonValueChanged = {this.changePropertyF}\r\n\t\t\t  \t\tchecked = {this.state.masked[field]}\r\n\t\t\t  \t\treadOnly = {false}\r\n\t\t  \t\t\tfield = {field}\r\n\t\t  \t\t\tindex = {-1}\r\n\t\t\t  \t/>\r\n\t\t    </div>)\r\n    \t}\r\n\r\n    \tif(index === -2 && !this.state.masked[field]) return //draw maskValue only if masked\r\n    \t\r\n    \tvar  value = null\r\n    \tif(index === -2) { //mask value\r\n    \t\tvalue = this.state.maskValues[field]\r\n    \t} else {\r\n    \t   value = this.chooseValueF(index, field)\r\n    \t}\r\n    \t\r\n    \tswitch(field) {\r\n    \tcase 'check' :\r\n    \t\t\t\treturn(\r\n\t\t\t\t  \t<div>\r\n\t\t\t\t  \t\t<CheckboxField \r\n\t\t\t\t\t  \t\tid = {'check_' + index}\r\n\t\t\t\t\t  \t\tonValueChanged = {this.setValueCheckF}\r\n\t\t\t\t\t  \t\tchecked = {value}\r\n\t\t\t\t\t  \t\treadOnly = {this.disabledCheckR(index)}\r\n\t\t\t\t  \t\t\tfield = 'check'\r\n\t\t\t\t  \t\t\tindex = {index}\r\n\t\t\t\t  \t\t\ttouched = {false}\r\n\t\t\t\t\t  \t/>\r\n\t\t\t\t    </div>)\r\n    \tcase 'l' :\r\n\t\t\t\t\treturn(\r\n\t\t\t\t  \t<div>\r\n\t\t\t\t  \t\t<LockField \r\n\t\t\t\t\t  \t\tid = {this.state.values[index].id}\r\n\t\t\t\t\t  \t\tonValueChanged = {this.changePropertyLF}\r\n\t\t\t\t\t  \t\tchecked = {value}\r\n\t\t\t\t\t  \t\treadOnly = {\r\n\t\t\t\t  \t\t\t\t!this.isPersistedR(index) \r\n\t\t\t\t  \t\t\t\t|| this.state.deleted[index] \r\n\t\t\t\t\t  \t\t\t|| oneIsTrue(this.state.masked)\r\n\t\t\t\t\t  \t\t\t|| oneIsTrue(this.state.touched[index])\r\n\t\t\t\t\t  \t\t}\r\n\t\t\t\t  \t\t\tfield = 'l'\r\n\t\t\t\t  \t\t\tindex = {index}\r\n\t\t\t\t\t  \t/>\r\n\t\t\t\t    </div>)\t\t\t\t\t    \r\n    \tcase 'd' :\r\n\t\t\t\t\treturn(\t\t\r\n\t\t\t\t\t<div>\r\n\t\t\t\t    \t<DateFieldPopover \r\n\t\t\t\t    \t\tid = {'d_'+index}\r\n\t\t\t\t\t  \t\tonValueChanged = {this.changePropertyF}\r\n\t\t\t\t\t  \t\tvalue = {value}\r\n\t\t\t\t\t  \t\treadOnly = {this.readOnlyR(index, 'd')}\r\n\t\t\t\t  \t\t\tfield = 'd'\r\n\t\t\t\t  \t\t\tindex = {index}\r\n\t\t\t\t  \t\t\ttouched = {this.touchedF(index, 'd')}\r\n\t\t\t\t    \t\tlinkCb = {this.props.queryType === 'd' || index === -2 || !this.isPristineT() ? null : this.dayLoad}\r\n\t\t\t\t  \t\t\tpopoverText = {'Show day ' + value }\r\n\t\t\t\t    \t />\r\n\t\t\t\t    </div>)\r\n    \tcase 'b' :  return(\r\n    \t\t\t\t<div>\r\n     \t\t\t\t\t<CurrencyField \r\n\t\t\t\t\t\t  \t\tvalue = {'' + this.chooseValueF(index, 'b')}\r\n\t\t\t\t\t  \t\t\tfield = 'b'\r\n\t\t\t\t\t\t  \t\treadOnly = {true}\r\n\t\t\t\t\t  \t\t\ttouched = {false}\r\n\t\t\t\t  \t\t\t\tlinkCb = {index === -2 ? null : this.props.calculatorAdd}\r\n\t\t\t\t\t\t />\t\r\n     \t\t\t\t</div>)\r\n    \tcase 'i' :\r\n\t\t\t\t\treturn(\r\n\t\t\t\t  \t<div>\r\n\t\t\t\t  \t\t<CurrencyField \r\n\t\t\t\t\t  \t\tid = {'i_'+index}\r\n\t\t\t\t\t  \t\tonValueChanged = {this.changePropertyF}\r\n\t\t\t\t\t  \t\tplaceholder = 'amount'\r\n\t\t\t\t\t  \t\tvalue = {value}\r\n\t\t\t\t\t  \t\treadOnly = {this.readOnlyR(index, 'i')}\r\n\t\t\t\t  \t\t\tfield = 'i'\r\n\t\t\t\t  \t\t\tindex = {index}\r\n\t\t\t\t  \t\t\ttouched = {this.touchedF(index, 'i')}\r\n\t\t\t\t  \t\t\tlinkCb = {index === -2 ? null : this.props.calculatorAdd}\r\n\t\t\t\t  \t\t\tpopoverText = 'Add to calculator'\r\n\t\t\t\t\t  \t/>\r\n\t\t\t\t    </div>)\r\n    \tcase 's' :\r\n\t\t\t\t\treturn(\r\n\t\t\t\t  \t<div>\r\n\t\t\t\t  \t\t<CheckboxField \r\n\t\t\t\t\t  \t\tid = {'s_' + index}\r\n\t\t\t\t\t  \t\tonValueChanged = {this.changePropertyF}\r\n\t\t\t\t\t  \t\tchecked = {value}\r\n\t\t\t\t\t  \t\treadOnly = {this.readOnlyR(index, 's')}\r\n\t\t\t\t  \t\t\tfield = 's'\r\n\t\t\t\t  \t\t\tindex = {index}\r\n\t\t\t\t  \t\t\ttouched = {this.touchedF(index, 's')}\r\n\t\t\t\t\t  \t/>\r\n\t\t\t\t    </div>)\t\t\t\t\t    \r\n    \tcase 'g' :\r\n\t\t\t\t\treturn(\r\n\t\t\t\t  \t<div>\r\n\t\t\t\t  \t\t<TextFieldPopover \r\n\t\t\t\t\t  \t\tid = {'g_'+index}\r\n\t\t\t\t\t  \t\tonValueChanged = {this.changePropertyF}\r\n\t\t\t\t\t  \t\tvalue = {value}\r\n\t\t\t\t\t  \t\treadOnly = {this.readOnlyR(index, 'g')}\r\n\t\t\t\t  \t\t\tfield = 'g'\r\n\t\t\t\t  \t\t\tindex = {index}\r\n\t\t\t\t  \t\t\ttouched = {this.touchedF(index, 'g')}\r\n\t\t\t\t  \t\t\tplaceholder = 'gId'\r\n\t\t\t\t  \t\t\tlinkCb = {this.props.queryType === 'g' || index === -2 || !this.isPristineT() ? null : this.groupLoad}\r\n\t\t\t\t  \t\t\tpopoverText = {'Show all in group \"' + value + '\"'}\r\n\t\t\t\t  \t\t\tmaxLength = {15}\r\n\t\t\t\t\t  \t/>\r\n\t\t\t\t    </div>)\r\n     \tcase 'c' :\r\n\t\t\t\t\treturn(\r\n\t\t\t\t  \t<div>\r\n\t\t\t\t  \t\t<DropdownField \r\n\t\t\t\t  \t\t\tonValueChanged = {this.changePropertyF}\r\n\t\t\t\t  \t\t\tvalue = {value}\r\n\t\t\t\t  \t\t\treadOnly = {this.readOnlyR(index, field)}\r\n\t\t\t\t  \t\t\tplaceholder = 'select'\r\n\t\t\t\t  \t\t\tfield = 'c'\r\n\t\t\t\t  \t\t\tindex = {index}\r\n\t\t\t\t  \t\t\ttouched = {this.touchedF(index, field)}\r\n\t\t\t\t  \t\t\tconstants_id = {CATEGORY}\r\n\t\t\t\t\t  \t/>\r\n\t\t\t\t    </div>)\r\n     \tcase 'a' :\r\n \t\t\t\t\treturn(\r\n\t\t\t\t\t  \t<div style={{\"display\": \"inline-flex\", \"whiteSpace\": \"nowrap\"}}>\r\n\t\t\t\t\t  \t\t<DropdownField \r\n\t\t\t\t\t  \t\t\tonValueChanged = {this.changePropertyF}\r\n\t\t\t\t\t  \t\t\tvalue = {value}\r\n\t\t\t\t\t  \t\t\treadOnly = {this.readOnlyR(index, field)}\r\n\t\t\t\t\t  \t\t\tplaceholder = 'select'\r\n\t\t\t\t\t  \t\t\tfield = 'a'\r\n\t\t\t\t\t  \t\t\tindex = {index}\r\n\t\t\t\t\t  \t\t\ttouched = {this.touchedF(index, field)}\r\n\t\t\t\t\t  \t\t\tconstants_id = {ACCOUNT}\r\n\t\t\t\t\t\t  \t/>\r\n\t\t\t\t\t    </div>)\r\n     \tcase 'descr' :\r\n\t\t\t\t\treturn(\r\n\t\t\t\t  \t<div>\r\n\t\t\t\t  \t\t<TextField \r\n\t\t\t\t\t  \t\tid = {'descr_'+index}\r\n\t\t\t\t\t  \t\tonValueChanged = {this.changePropertyF}\r\n\t\t\t\t\t  \t\tvalue = {value}\r\n\t\t\t\t\t  \t\treadOnly = {this.readOnlyR(index, 'descr')}\r\n\t\t\t\t  \t\t\tfield = 'descr'\r\n\t\t\t\t  \t\t\tindex = {index}\r\n\t\t\t\t  \t\t\ttouched = {this.touchedF(index, 'descr')}\r\n\t\t\t\t  \t\t\tplaceholder = 'description'\r\n\t\t\t\t  \t\t\tmaxLength = {50}\r\n\t\t\t\t\t  \t/>\r\n\t\t\t\t  \t\t{ /* CHG-\r\n\t\t\t\t  \t\t<TextareaField \r\n\t\t\t\t\t  \t\tid = {'descr_'+index}\r\n\t\t\t\t\t  \t\tonValueChanged = {this.changePropertyF}\r\n\t\t\t\t\t  \t\tvalue = {value}\r\n\t\t\t\t\t  \t\treadOnly = {this.readOnlyR(index, 'descr')}\r\n\t\t\t\t  \t\t\tfield = 'descr'\r\n\t\t\t\t  \t\t\tindex = {index}\r\n\t\t\t\t  \t\t\ttouched = {this.touchedF(index, 'descr')}\r\n\t\t\t\t  \t\t\tplaceholder = 'description'\r\n\t\t\t\t  \t\t\twidth = '180px'\r\n\t\t\t\t\t  \t/>*/}\r\n\t\t\t\t    </div>)\t\r\n\t\t  default: console.log('UNKONWN field: '+field)\r\n\t\t\t  \t   return null\r\n    \t}\r\n    }\r\n\t\r\n\trenderDeletedContentF(index) {\r\n\t\tif(!this.isPersistedR(index)) { \r\n\t\t\treturn(\r\n\t\t\t<button \r\n\t\t  \t\ttype=\"button\" \r\n\t\t  \t\tclassName=\"form-control\"  \r\n\t\t  \t\tonClick={() => this.changePropertyDeletedF(true, 'deleted', index)}>\r\n\t\t  \t\t<FontAwesome name = 'remove' style = {{'color': 'red'}}/>\r\n\t\t    </button>)\r\n\t\t}\r\n\t  \t\t\r\n\t\treturn(\r\n\t  \t<div>\r\n\t  \t\t<CheckboxField \r\n\t\t  \t\tid = {'deleted_'+index}\r\n\t\t  \t\tonValueChanged = {this.changePropertyDeletedF}\r\n\t\t  \t\tchecked = {this.state.deleted[index]}\r\n\t\t  \t\treadOnly = {this.state.values[index].l}\r\n\t  \t\t\tfield = 'deleted'\r\n\t  \t\t\tindex = {index}\r\n\t  \t\t\ttouched = {false}\r\n\t\t  \t/>\r\n\t    </div>)\r\n\t}\r\n\t\t\r\n\tsetSortF(field) {\r\n\t\t//console.log(field)\r\n\t\tif(!this.state.sort || this.state.sort !==field) {\r\n\t\t\tthis.setState({\r\n\t\t\t\tsort : field,\r\n\t\t\t\tasc : true\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\t\tif(this.state.sort === field && this.state.asc) {\r\n\t\t\tthis.setState({\r\n\t\t\t\tasc : false\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\t\tthis.setState({\r\n\t\t\tsort : null\r\n\t\t})\r\n\t\treturn\r\n\t}\r\n\r\n\tsortersF() {\r\n\t\tvar inv = this.state.asc ? -1 : 1\r\n\t\tswitch(this.state.sort) {\r\n\t\tcase 'i': \r\n\t\t//TODO: a:n ja c:n tekstiarvolla sorttaus ei id:llä\r\n\t\t// eslint-disable-next-line\r\n\t\tcase 'a':\r\n\t\tcase 'c':\r\n\t\t\treturn (a, b) => {\r\n\t\t\t\treturn inv * \r\n\t\t\t\t(this.chooseValueF(b.index,this.state.sort) - this.chooseValueF(a.index,this.state.sort))\r\n\t\t\t}\r\n\t\tcase 'd': \r\n\t\t\treturn (a, b) => {\r\n\t\t\t\treturn inv * \r\n\t\t\t\t(toDateFi(this.chooseValueF(b.index,'d')).getTime() - toDateFi(this.chooseValueF(a.index,'d')).getTime())\r\n\t\t\t}\r\n\t\tcase 'g':\r\n\t\t\treturn (a, b) => {\r\n\t\t\t\t var textA = this.chooseValueF(a.index,'g').toUpperCase()\r\n\t\t\t\t var textB = this.chooseValueF(b.index,'g').toUpperCase()\r\n\t\t\t\t return inv * \r\n\t\t\t\t ((textA < textB) ? -1 : (textA > textB) ? 1 : 0)\r\n\t\t\t}\r\n\t\tdefault: return (a, b) => {return 0}\r\n\t\t}\r\n\t}\r\n\t\t\r\n\taddR(copyLast = true) {\r\n\t\tvar defaults = this.getDefaultR(copyLast)\r\n    \tvar valuesCopy = copyArray(this.state.values)\r\n    \tvar errorsCopy = copyArray(this.state.errors)\r\n    \tvar count = 1\r\n    \t\r\n    \tif(this.state.recurring.recur) {\r\n    \t\tcount = this.state.recurring.times\r\n    \t}\r\n\t\t\r\n\t\tfor(var i=0; i<count; i++) {\r\n\t\t\tdefaults = copyPayment(defaults, [])\r\n\t\t\tdefaults.id = tempId--\r\n\t\t\tdefaults.index = valuesCopy.length\r\n\t\t\tdefaults.l = false\r\n\t\t\tdefaults.check = false\r\n\t\t\t\t\r\n\t\t\tif(this.state.recurring.recur) {\r\n\t\t\t\trecurrent(defaults, i, this.state.recurring.span.value)\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvaluesCopy.push(defaults)\r\n\t\t\tthis.sortedValues.push(defaults)\r\n\t\t\terrorsCopy.push(this.validateR(defaults)) \r\n\t\t}\r\n\t\tthis.setState({\r\n\t\t\t\t\trecurring : { ...this.state.recurring, recur: false },\r\n    \t\t    \tvalues : valuesCopy,\r\n    \t\t    \terrors : errorsCopy,\r\n    \t})\r\n    }\r\n\t\r\n\tsetRecurring() {\r\n\t\tthis.setState({\r\n\t\t\trecurring : { ...this.state.recurring, recur: !this.state.recurring.recur }\r\n    \t})\r\n\t}\r\n\t\r\n\tsetRecurringTimes(times) {\r\n\t\tthis.setState({\r\n\t\t\trecurring : { ...this.state.recurring, times: times }\r\n    \t})\r\n\t}\r\n\t\r\n\tsetRecurringSpan(span) {\r\n\t\tthis.setState({\r\n\t\t\trecurring : { ...this.state.recurring, span: span }\r\n    \t})\r\n\t}\r\n\t\r\n\tgetDefaultR(copyLast) {\r\n\t\tvar last = defaultValues\r\n\t\tif (copyLast && this.sortedValues.length){\r\n\t\t\tlast = this.sortedValues[this.sortedValues.length - 1]\r\n\t\t} else {\r\n\t\t\tlast.d = dateFormat(this.props.defaultDate, \"dd.mm.yyyy\")\r\n\t\t}\r\n\r\n\t\tvar res = {...last}\r\n\t\treturn res\r\n\t}\r\n    \r\n    removeR(index) {\r\n    \tthis.state.values.splice(index, 1)\r\n        var values_copy = copyArray(this.state.values)\r\n        this.state.errors.splice(index, 1)\r\n    \tvar errors_copy = copyArray(this.state.errors)\r\n\r\n    \t//reindex:\r\n    \tfor(var ix=index ; ix<values_copy.length ;ix++) {\r\n    \t\tvalues_copy[ix].index--\r\n    \t\terrors_copy[ix].index--\r\n    \t}\r\n    \tthis.setState({\r\n    \t\t    \tvalues : values_copy,\r\n    \t\t    \terrors : errors_copy,\r\n    \t})\r\n    }\r\n    \r\n    validateR(v) {\r\n\t   var res = {}\r\n\t   fields.forEach( (field) => {\r\n\t\t   \tres[field] = validators[field](v[field])\r\n    \t})\r\n    \treturn res\r\n    }\r\n    \r\n    readOnlyR(index, field) {\r\n\t\tif(index<0) return false  //mask-controls are never readOnly (-1 =checkbox -2 =mask value)\r\n\t\treturn this.state.masked[field] ||\t//this col is masked?\r\n\t\t\t   this.state.deleted[index] || //marked as to be deleted?\t\t\t\r\n\t\t\t   this.state.values[index].l  //locked?\r\n\t}\r\n    \r\n    isPersistedR(index) {\r\n\t\treturn this.state.values[index].id >=0\r\n\t}\r\n    \r\n    disabledCheckR(index) {\r\n\t\treturn !this.isPersistedR(index) ||\r\n\t\t\t   this.state.deleted[index] \t//marked as to be deleted?\t\t\t\r\n    }\r\n\r\n    renderPaymentR(index) {\r\n    \treturn(\r\n    \t<tr key={index}>\r\n\t \t\t{['check', 'l', ...fields].map( (f) => { \r\n\t \t\t\treturn this.td(index, f) \r\n\t \t\t})}\r\n\t      \t<td className={this.tdClassName(index, 'deleted')}>\r\n\t      \t\t{this.renderDeletedContentF(index)}\r\n\t      \t</td>\r\n\t      \t<td>\r\n\t      \t{\tthis.isPersistedR(index) ?\r\n\t            <Button variant=\"primary\" onClick={() => this.showHistory(this.chooseValueF(index, 'id'))} >\r\n\t            \t<FontAwesome name='history' />\r\n\t            </Button>\r\n\t            :\r\n\t            null\r\n\t      \t}\r\n\t      \t</td>\r\n\t\t</tr>)\r\n    }\r\n    \r\n\tresetT() {\r\n\t\tvar state = initState(this.state.initial, checkedSet, this.state.recurring)\r\n\r\n\t\tstate.maskValues.d = dateFormat(this.props.defaultDate, \"dd.mm.yyyy\")\r\n\t\tthis.setState({...state})\r\n\t\tthis.init()\r\n\t}\r\n\t\r\n\tisPristineT() {\r\n\t\tvar pristine = true\r\n    \tthis.state.touched.forEach( (v) => {\r\n    \t\tfields.forEach( (f) => {\r\n    \t\t\tpristine = pristine && !v[f]\r\n    \t\t})\r\n    \t})\r\n\r\n    \treturn pristine &&\r\n    \t\t   (this.state.initial.length === this.state.values.length) && \r\n    \t       !oneIsTrue(this.state.masked) &&\r\n    \t       !this.deleteCount \r\n\t}\r\n\t\r\n\thasErrorsT() {\r\n\t\tvar errors = false\r\n    \tthis.state.errors.forEach( (v) => {\r\n    \t\terrors = errors || oneIsTrue(v) \r\n    \t})\r\n    \treturn errors || oneIsTrue(this.state.maskErrors)\r\n\t}\r\n\t\r\n\tpreInitT(initialPayments) {\r\n\t\treturn preInitFormat(initialPayments, checkedSet)\r\n\t}\r\n\t\r\n\tpreSubmitT() {\r\n\t\tvar created = []\r\n\t\tthis.state.values.forEach((v,index) => {\r\n\t\t\tif(!this.isPersistedR(index)) {\r\n\t\t\t\tvar p={}\r\n\t\t\t\tfields.forEach( (field) =>\r\n\t\t\t\t{\r\n\t\t\t\t\t p[field] = this.chooseValueF(index, field)\r\n\t\t\t\t})\r\n\t\t\t\tcreated.push(p)\r\n\t\t\t}\r\n\t\t}) \r\n\t\t\r\n\t\tvar deleted = []\r\n\t\tthis.state.deleted.forEach((v,i) => {\r\n\t\t\tif(v) {\r\n\t\t\t\tdeleted.push(this.state.values[i].id)\r\n\t\t\t} \r\n\t\t})\r\n\t\t\r\n\t\tvar modified = []\r\n\t\t\r\n\t\tthis.state.values.forEach( (v, index) => {\r\n\t\t\tif(this.isPersistedR(index)) {\r\n\t\t\t\tvar p={}\r\n\t\t\t\tfields.forEach((field) => {\r\n\t\t\t\t\t if(this.touchedF(index, field)) {\r\n\t\t\t\t\t\t p.id = v.id\r\n\t\t\t\t\t\t p[field] = this.chooseValueF(index, field)\r\n\t\t\t\t\t }\r\n\t\t\t\t })\r\n\t\t\t\t if(Object.keys(p).length > 0){\r\n\t\t\t\t\t modified.push(p)\r\n\t\t\t\t }\r\n\t\t\t}\r\n\t\t})\r\n\t\tvar updates = {\r\n\t\t\t\t'created' : preSubmitFormat(created),\r\n\t\t\t\t'deleted' : deleted,\r\n\t\t\t\t'modified' : preSubmitFormat(modified)\r\n\t\t}\r\n\t\t//console.log(JSON.stringify(updates,null,4))\r\n\t\t//\"submit\"\r\n\t\tthis.pristine = null\r\n\t\tthis.props.update(updates)\r\n\t\tthis.showOk()\r\n\t}\r\n\r\n    init() {\r\n        this.deleteCount = 0\r\n        this.pristine = null\r\n        this.errors = null\r\n        this.allChecked = false\r\n    }\r\n\r\n    renderPaymentsHeaderT = () => {\r\n    \tif (!this.state.values || this.state.values.length === 0) { \r\n    \t\treturn (<thead><tr><th /></tr></thead>)\r\n    \t}\r\n    \treturn (\r\n\t\t<thead>\r\n\t  \t\t<tr>\r\n\t  \t\t\t<th className={this.thClassName('check')}>\r\n\t\t  \t\t\t<CheckboxField \r\n\t\t\t\t  \t\tid={'check_all'}\r\n\t\t\t\t  \t\tonValueChanged={this.setValueCheckAllF}\r\n\t\t\t\t  \t\tchecked={this.state.allChecked}\r\n\t\t\t\t  \t\treadOnly={false}\r\n\t\t\t  \t\t\tfield = {'check_all'}\r\n\t\t\t  \t\t\tindex = {-2}\r\n\t\t\t  \t\t\ttouched = {false}\r\n\t\t\t\t  \t/>\r\n\t  \t\t\t</th>\r\n\t\t  \t\t<th className={this.thClassName('l')} />\r\n\t  \t\t\t{this.th('d', 'Date')}\r\n\t\t  \t\t{this.drawBalanceF() ?  this.th('b', 'Balance', false) : null}\r\n\t  \t\t\t{this.th('i', 'Pay')}\r\n\t  \t\t\t{this.th('s', <FontAwesome name='pie-chart' size='lg' />, false)}\r\n\t  \t\t\t{this.th('g', <FontAwesome name='paperclip' size='lg' />)}\r\n\t  \t\t\t{this.th('c', 'Issue')}\r\n\t  \t\t\t{this.th('a', 'Account')}\r\n\t  \t\t\t{this.th('descr', 'Description')}\t\t  \t\t\t\r\n\t  \t\t\t<th className={this.thClassName('deleted')}>\r\n\t  \t\t\t\t<FontAwesome name='trash'  size='lg' />\r\n\t  \t\t\t</th>\r\n\t  \t\t\t<th>\r\n\t  \t\t\t</th>\r\n\t\t\t</tr>\t\t\t\t  \t\t\t\r\n\t\t</thead>)\r\n    }\r\n    \r\n\t  \t\t\t\t\r\n\trenderControls = () => {\r\n\t  \treturn (\r\n\t\t<Panel id=\"ctrls-panel\" expanded={this.state.recurring.recur} onToggle={() => {}}  >\r\n          <Panel.Heading >\r\n            <Panel.Title >\r\n\r\n\t\t\t\t\t<Button onClick={() => this.resetT()} disabled={this.pristine} bsStyle={this.pristine ? \"default\":\"primary\"}>Reset</Button>\r\n\t\t\t\t\t<Button onClick={() => this.preSubmitT()} disabled={this.pristine  || (this.errors != null)} bsStyle={this.pristine ? \"default\":\"primary\"}>Save</Button>\r\n\t\t\t\t\t<Button onClick={() => this.addR(false)}><FontAwesome name='plus' /></Button> \r\n\t\t\t\t\t{ this.state.values.length > 0 ?\r\n\t\t\t\t\t\t\t<Button onClick={() => this.addR()}>Duplicate last</Button>\r\n\t\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\tnull\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t{/*this.pristine ? 'pristine' : 'not pristine'*/}\r\n\t\t\t\t\t{/*this.errors ? ' errors' : ' no errors'*/}\r\n\t\t\t\t\t<span style={{marginTop: \"6px\"}}>\r\n\t\t\t\t\t\t<Panel.Toggle componentClass=\"button\" className=\"link-button\" onClick={this.setRecurring} >\r\n\t\t\t\t\t\t{   (!this.state.values || this.state.values.length === 0) ?\r\n\t\t\t\t\t\t\t''\r\n\t\t\t\t\t\t\t:\r\n\t            \t\t\t' ' + (this.state.recurring.recur ? 'No recur' : 'Recurring...') }\r\n\t            \t\t</Panel.Toggle>\r\n            \t\t</span>\r\n\r\n            </Panel.Title>\r\n          </Panel.Heading>\r\n          <Panel.Collapse>\r\n            <Panel.Body >\r\n            <span style={{display: \"inline-flex\"}}>\r\n            \t<span style={{marginTop: \"6px\"}}>\r\n            Repeat last row &nbsp;\r\n            \t</span>\r\n\t\t\t\t<SimpleSelect\r\n\t\t\t\t\tstyle={{\r\n\t\t\t\t    \twidth: '170px'\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tonValueChange={this.setRecurringSpan}\r\n\t\t\t\t\tplaceholder='choose span'\r\n\t\t\t\t\toptions = {recurSpans}\r\n\t\t\t\t\tvalue = {this.state.recurring.span}\r\n\t\t\t\t\thideResetButton = {true}\r\n\t\t\t\t/>\r\n\t\t\t\t<NumericInput \r\n\t\t\t\t\tid=\"recurringTimes\"\r\n\t\t\t\t\tmin={1} \r\n\t\t\t\t\tstep={1} \r\n\t\t\t\t\tprecision={0} \r\n\t\t\t\t\tmax={365} \r\n\t\t\t\t\tvalue={this.state.recurring.times} \r\n\t\t\t\t\tonChange={this.setRecurringTimes} \r\n\t\t\t\t/> \r\n\t\t\t\t<span style={{marginTop: \"6px\"}}>\r\n\t\t\t\t&nbsp;times.&nbsp;\r\n\t\t\t\t</span>\r\n\t\t\t\t<Button onClick={() => this.addR()}>Ok</Button>\r\n\t\t\t</span>\r\n\r\n            </Panel.Body>\r\n          </Panel.Collapse>\r\n        </Panel>\r\n\t  \t)\r\n\t}\r\n\t  \t\r\n\t/*renderNarrowT  = () => {\r\n\t\treturn(\r\n\t\t\tthis.sortedValues.map(p => {\r\n\t\t\t\treturn(\r\n\t\t\t\t<Table id=\"payments_table_s\" bordered condensed>\r\n\t\t\t\t\t<tbody>\r\n\t\t       \t\t\t<tr  >\r\n       \t\t\t\t\t  <td className=\"field_value\">{this.renderContentF('l', p.index)}</td>\r\n\t                      <td className=\"field_value\">\r\n\t                      \t<span style={{float: 'right'}}>\r\n\t                      \t\t<div style={{\"display\": \"inline-flex\", \"whiteSpace\": \"nowrap\", \"alignItems\": \"center\"}}>\r\n\t                      \t\tmark {this.renderContentF('check', p.index)}\r\n\t                      \t\t<FontAwesome name='remove' style={{'color': 'red'}}/>\r\n\t                      \t\t{this.renderDeletedContentF(p.index)} \r\n\t                      \t\t\r\n\t                      \t\t</div>\r\n\t                      \t</span>\r\n\t                      </td>\r\n\t\t\t            </tr>\r\n\t\t\t\t\t\t<tr  >\r\n\t                      <td className=\"field_name\"><span style={{float: 'right'}}>Date</span></td>\r\n\t                      <td className={this.tdClassName(p.index, 'd')}>{this.renderContentF('d', p.index)}</td>\r\n\t\t\t            </tr>\r\n\t\t\t           \t<tr  >\r\n\t                      <td className=\"field_name\"><span style={{float: 'right'}}>Sum</span></td>\r\n\t                      <td className={this.tdClassName(p.index, 'i')}>{this.renderContentF('i', p.index)}</td>\r\n\t\t\t            </tr>\r\n\t\t\t            <tr>\r\n\t                      <td className=\"field_name\"><span style={{float: 'right'}}>In <FontAwesome name='pie-chart' size='lg' /></span></td>\r\n\t                      <td className={this.tdClassName(p.index, 's')}>{this.renderContentF('s', p.index)}</td>\r\n\t\t\t            </tr>\r\n\t\t\t            <tr>\r\n\t                      <td className=\"field_name\"><span style={{float: 'right'}}>Issue</span></td>\r\n\t                      <td className={this.tdClassName(p.index, 'c')}>{this.renderContentF('c', p.index)}</td>\r\n\t\t\t            </tr>\r\n\t\t\t            <tr>\r\n\t                      <td className=\"field_name\"><span style={{float: 'right'}}><FontAwesome name='paperclip' size='lg' /></span></td>\r\n\t                      <td className={this.tdClassName(p.index, 'g')}>{this.renderContentF('g', p.index)}</td>\r\n\t\t\t            </tr >\t\t\t            \r\n\t\t\t            <tr>\r\n\t                      <td className=\"field_name\"><span style={{float: 'right'}}>Account</span></td>\r\n\t                      <td className={this.tdClassName(p.index, 'd')}>{this.renderContentF('a', p.index)}</td>\r\n\t\t\t            </tr>\r\n\t\t\t            <tr>\r\n\t                      <td className=\"field_name\"><span style={{float: 'right'}}>Descr</span></td>\r\n\t                      <td className={this.tdClassName(p.index, 'descr')}>{this.renderContentF('descr', p.index)}</td>\r\n\t\t\t            </tr >\r\n\t\t\t            \r\n\t\t\t          </tbody>\r\n\t\t            </Table>\r\n\t\t            )}\r\n\t\t\t\t)\r\n\t\t)\r\n\t}*/\r\n\t                      \r\n\trenderNormalT  = () => {\r\n\t\treturn(\r\n\t\t<Table id=\"payments_table\" striped bordered hover condensed>\r\n\t\t\t\t{this.renderPaymentsHeaderT()}\r\n\t\t\t\t<tbody>\r\n\t\t\t\t  \t{this.sortedValues.map((p) => this.renderPaymentR(p.index))}\r\n\t\t\t\t</tbody>\r\n\t\t</Table>\r\n\t\t)\r\n\t}\r\n\t\r\n\trenderPaymentsT = (width) => {\r\n\t\tthis.sortedValues = this.state.values.slice(0)\r\n\t\tif (this.state.sort) this.sortedValues.sort(this.sortersF())\r\n\t\t\r\n\t\treturn (\r\n\t\t<div>\r\n\t\t\t{this.renderControls()}\r\n\t\t\t{/*{width === 'narrow' ? this.renderNarrowT() : this.renderNormalT()}*/}\r\n\t\t\t{this.renderNormalT()}\r\n\t\t</div>\r\n\t\t)\r\n\t}\r\n\t\t\r\n\t\r\n\ttdClassName(index, field) {\r\n\t\treturn field + '_cell' + \r\n\t\t\t   (!this.isPersistedR(index) ? ' newRow' : '') +\r\n\t\t\t   (this.state.deleted[index] ? ' deleted' : '') +\r\n\t\t\t   (this.state.values[index].check ? ' selected' : '') +\r\n\t\t\t   (this.state.errors[index][field] ? ' error' : '')\r\n\t}\r\n\t\r\n\tdrawBalanceF() {\r\n\t\treturn( this.props.queryType === 'a' && this.pristine )\r\n\t}\r\n\t\r\n\ttd(index, field) {\r\n\t\tif( field ==='b' && !this.drawBalanceF()) return\r\n\t\treturn (\r\n\t\t<td key={index+'_'+field} className={this.tdClassName(index, field)}>\r\n\t\t      \t\t{this.renderContentF(field, index)}\t\r\n\t\t</td>)\r\n\t}\r\n\t\r\n\tthClassName(field) {\r\n\t\treturn field + '_header' + \r\n\t\t\t   (this.state.maskErrors[field] ? ' error' : '') + \r\n\t\t\t   (oneIsTrue(this.state.masked) ? ' header_tall' : '')\r\n\t}\r\n\t\r\n\tth(field, label = null, sort = true) {\r\n\t\tif(!sort) {\r\n\t\t\treturn(\r\n\t\t\t<th className={this.thClassName(field)}>\r\n\t  \t\t\t<div>\r\n\t\t  \t\t\t<span style={{display: 'flex'}} >\r\n\t\t  \t\t\t\t<div  style={{marginTop: 8, textDecoration: 'none'}} className=\"link-button\" >\r\n\t\t  \t\t\t\t\t{label !== null ? label : ''}\r\n\t\t  \t\t\t\t</div>\r\n\t\t  \t\t\t</span>\r\n\t\t  \t\t</div>\r\n\t  \t\t</th>)\r\n\t\t}\r\n\t\t\r\n\t\t\r\n\t\tvar arrow = (<FontAwesome name = {this.state.asc ? 'sort-asc' : 'sort-desc'} />)\r\n\r\n\t\tvar sortField = (<div>{this.state.sort === field ? arrow : ''}</div>)\r\n\t\t\r\n\t\tvar labelField = (\r\n\t\t\t\t<div  style={{marginTop: 8}}>\r\n  \t\t\t\t\t<button type=\"button\" className=\"link-button\" onClick={() => {this.setSortF(field)}}>\r\n  \t\t\t\t\t\t{label}\r\n  \t\t\t\t\t</button>\r\n\t\t  \t\t</div>)\r\n\t\treturn(\r\n\t\t<th className={this.thClassName(field)}>\r\n  \t\t\t<div>\r\n\t  \t\t\t<span style={{display: \"flex\"}}>\t\t\t  \t\t\t\t\t\t\r\n\t  \t\t\t\t<div style={{marginTop: 8, paddingRight: 3}}>\r\n\t  \t\t\t\t\t{sortField}\r\n\t  \t\t\t\t</div>\r\n\t  \t\t\t\t{label !== null ? labelField : ''}\r\n\t  \t\t\t\t&nbsp;{this.renderContentF(field, -1)}\r\n\t  \t\t\t</span>\r\n\t  \t\t</div>\r\n\t  \t\t{this.renderContentF(field, -2)}\r\n\t\t</th>)\r\n\t}\r\n\t\r\n\t/*shouldComponentUpdate(nextProps, nextState) {\r\n\t\tconsole.log(\"shouldComponentUpdate :\"+ this.isPristineT())\r\n\t\t\r\n\t\treturn this.isPristineT()\r\n\t}*/\r\n\t\r\n\tcomponentWillReceiveProps(nextprops) {\r\n\t\tthis.init()\r\n\t\t/*this.setState(\r\n\t\t\t\t{...initState(this.preInitT(nextprops.initPayments), checkedSet)}\r\n\t\t)*/\r\n\r\n\r\n\t\tvar state = {...initState(this.preInitT(nextprops.initPayments), checkedSet)}\r\n        this.state.maskValues.d = dateFormat(nextprops.defaultDate, \"dd.mm.yyyy\")\r\n\t\tthis.setState({...state})\r\n\t}\r\n\r\n\tupdateCheckedSet(value, index, values = null) {\r\n\t\tif(index<0 || this.disabledCheckR(index)) return\r\n\t\tvar pos = checkedSet.indexOf(this.state.values[index].id)\r\n\t\tif(value && pos < 0) {\r\n\t\t\tcheckedSet.push(this.state.values[index].id)\r\n\t\t} if(!value && pos > -1) {\r\n\t\t\tcheckedSet.splice( pos, 1 )\r\n\t\t}\r\n\t\tif(values) values[index].check = value\r\n\t}\r\n\t\r\n\tgroupLoad(grp) {\r\n\t\tif(this.pristine && grp && grp.length > 0) this.props.groupLoad(grp)\r\n\t}\r\n\tdayLoad(d) {\r\n\t\tif(this.pristine && d && d.length > 0) this.props.dayLoad(toDateFi(d))\r\n\t}\r\n\tshowHistory(id) {\r\n\t\tthis.props.historyLoad(id)\r\n\t\tthis.setState({ historyShow: true })\r\n\t}\r\n\t\r\n\trender() {\r\n\t\tlet historyClose = () => this.setState({ historyShow: false });\r\n\t\t\r\n\t\tthis.pristine = this.isPristineT()\r\n\t\tthis.errors = this.hasErrorsT()\r\n\t\treturn(\r\n\t\t\t<div>\r\n\t\t        <AlertContainer ref={a => this.msg = a} {...alertOptions} />\r\n\t\t\t    <Media query=\"(max-width: 734px)\">\r\n\t\t\t          {matches =>\r\n\t\t\t            matches ? (\r\n\t\t\t              this.renderPaymentsT('narrow')\r\n\t\t\t            ) : (\r\n\t\t\t              this.renderPaymentsT('wide')\r\n\t\t\t            )\r\n\t\t\t          }\r\n    \t\t\t</Media>\r\n\r\n\t\t\t\t<HistoryModal\r\n\t\t\t\t\tshow={this.state.historyShow}\r\n\t\t\t\t\tonHide={historyClose}\r\n\t\t\t\t/>\r\n\r\n    <FormGroup>\r\n      <ControlLabel>Copyright</ControlLabel>\r\n      <FormControl.Static>jhupli@gmail.com</FormControl.Static>\r\n    </FormGroup>\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t   </div>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nPaymentsEditor.defaultProps = {\r\n\t\tinitPayments: [],\r\n\t\tqueryType: null\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch) {\r\n    return({\r\n        update: (updates) => {\r\n            dispatch(update(updates))\r\n        },\r\n        paymentSelection: (payments) => {\r\n            dispatch(payment_selection(payments))\r\n        },\r\n        groupLoad: (g) => {\r\n            dispatch(group_load(g))\r\n        },\r\n        dayLoad: (d) => {\r\n            dispatch(day_load(d))\r\n        },\r\n        historyLoad: (id) => {\r\n            dispatch(history_load(id))\r\n        },\r\n        calculatorAdd: (p) => {\r\n            dispatch(calc_add(p))\r\n        }\r\n    })\r\n}\r\n\r\nexport default connect(null, mapDispatchToProps)(PaymentsEditor)\r\n\r\n\r\n","import React from 'react';\r\nimport { connect } from 'react-redux'\r\nimport PaymentsEditor from '../paymentsEditor/PaymentsEditor'\r\n\r\nclass Payments extends React.Component {\r\n\tconstructor(props) {\r\n\t    super(props);\r\n\t    this.state = {\r\n\t        payments: [],\r\n\t        balances: [] //TODO: needed?, if not remove from backend too!\r\n\t    }\r\n\t}\r\n\t\r\n\trender() {\r\n\t\treturn(\r\n\t\t\t<PaymentsEditor \r\n\t\t\t\tinitPayments={this.props.payments} \r\n\t\t\t\tqueryType={this.props.queryType} \r\n\t\t\t\tdefaultDate={this.props.defaultDate}/>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nPayments.defaultProps = {\r\n\t\tdefaultDate: new Date()\r\n}\r\n\r\nconst mapStateToProps = (store) => {\r\n    return {\r\n    \tqueryType: store.payments.queryType,\r\n        payments: store.payments.payments,\r\n        balances: store.payments.balances //TODO: needed?, if not remove from backend too!\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps)(Payments)\r\n","import React from 'react'\r\nimport { connect } from 'react-redux'\r\nimport { list_load } from '../../actions/payments'\r\n//import update from 'react-addons-update';\r\n\r\nimport { Badge, Button } from 'react-bootstrap';\r\nclass PaymentSelection extends React.Component {\r\n\t\r\n\tconstructor(props) {\r\n\t    super(props);\r\n\t    this.list = this.list.bind(this);\r\n\t}\r\n\t/*  constructor(props) {\r\n\t\t    super(props);\r\n\t\t    \r\n\t\t    this.state = {\r\n\t\t    \tselection : []\r\n\t\t    }\r\n\t\t    this.select = this.select.bind(this);\r\n\t  }\r\n\t  \r\n\t  \r\n\t  select(payments, selected) {\r\n\t\t  \r\n\t\t  if (!Array.isArray(payments)) {\r\n\t\t\t  payments = [payments]\r\n\t\t  }\r\n\t\t  \r\n\t\t  var new_selection = this.state.selection.slice(0)\r\n\t\t  payments.forEach( (payment) =>  {\r\n\t\t\t  if (selected) {\r\n\t\t\t\t  var index =  new_selection.indexOf(payment)\r\n\t\t\t\t  if (index === -1) {\r\n\t\t\t\t\t  new_selection.push(payment)\r\n\t\t\t\t  }\r\n\t\t\t  } else {\r\n\t\t\t\t  var index =  new_selection.indexOf(payment)\r\n\t\t\t\t  if (index !== -1) {\r\n\t\t\t\t\t  new_selection.splice(index,1)\r\n\t\t\t\t  }\r\n\t\t\t  }\r\n\t\t  })\r\n\t\t  this.setState({\"selection\": new_selection});\r\n\t  }\r\n\t  \r\n\t  componentWillUpdate(nextProps, nextState){\r\n\t\t  if (\r\n\t\t\t\t  nextProps.payment != this.props.payment ||\r\n\t\t\t\t  nextProps.selected != this.props.selected ) {\r\n\t\t\t  \t  this.select(nextProps.payment, nextProps.selected)\r\n\t\t  }\r\n\t  }*/\r\n\t\r\n\t/*componentWillReceiveProps(nextprops) {\r\n\t\tconsole.log(nextprops)\r\n\t\tif (nextprops.payment != this.props.payment) {\r\n\t\t\tvar index =  this.props.payments.indexOf(nextprops.payment);\r\n\t\t\tif (index !== -1) {\r\n\t\t\t\tthis.props.payments.splice( index, 1 );\r\n\t\t\t}\r\n\t\t}\r\n\t}*/\r\n\t\r\n\tlist() {\r\n\t\tthis.props.listLoad(this.props.payments)\r\n\t}\r\n\t\r\n\trender() {\r\n\t\t//if( this.props.payments.length === 0 ) return null\r\n\t    return (\r\n\t     <Button onClick={this.list}><Badge>{this.props.payments.length}</Badge></Button>\r\n\t    );\r\n\t  }\r\n}\r\n\r\n\r\nPaymentSelection.defaultProps = {\r\n\t\tpayments: [],\r\n\t\t//payment: null\r\n};\r\n\r\nconst mapStateToProps = (store) => {\r\n\t  return {\r\n  \t\tpayments: store.payment.payments,\r\n  \t\t//payment: store.payment.payment\r\n\t  }\r\n  }\r\n\r\nfunction mapDispatchToProps(dispatch) {\r\n    return ({\r\n        listLoad: (ids) => {\r\n            dispatch(list_load(ids))\r\n        }       \r\n    })\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(PaymentSelection)\r\n//export default PaymentSelection\r\n","import React from 'react'\r\nimport currencyFormat from './currency'\r\nimport {findInArray, findIndexInArray} from './findInArray'\r\nvar dateFormat = require('dateformat');\r\nfunction accountsTooltipTable(dt, curves, constants, showdate = false) {\r\n\tvar a_table = {};\r\n\t\r\n\tif(curves) {\r\n\t\tvar d = dateFormat(dt, 'yyyymmdd') + 'T00'\r\n\t\tvar ix = findIndexInArray( curves[0], n => { return d === n})\r\n    if (ix < 0) {\r\n      return null\r\n    }\r\n\t\tvar trs = []\r\n\t\t\r\n\t\tcurves.forEach( (c, i) => {\r\n\t\t\tif( i===1 ) {\r\n\t\t\t\ttrs.push(\r\n\t\t\t\t\t\t<tr className='c3-tooltip-name--data2' key={-1}>\r\n\t\t\t                      <td className=\"name\"><span style={{backgroundColor: 'green'}}></span></td>\r\n\t\t\t                      <td className=\"value\" >{currencyFormat(c[ix])}</td>\r\n\t\t\t            </tr>\r\n\t\t\t     )\t\t\t\t\t\r\n\t\t\t}\r\n\t\t\tif( i===2 ) {\r\n\t\t\t\ttrs.push(\r\n\t\t\t\t\t\t<tr className='c3-tooltip-name--data2' key={-2}>\r\n\t\t\t                      <td className=\"name\"><span style={{backgroundColor: 'red'}}></span></td>\r\n\t\t\t                      <td className=\"value\" >{currencyFormat(c[ix])}</td>\r\n\t\t\t            </tr>\r\n\t\t\t     )\t\r\n\t\t\t}\r\n\t\t\tif(i>=3) {\r\n\t\t\t\tvar acc2 = findInArray(constants['acc'], n => { return c[0] === '' + n.value})\r\n\r\n\t\t\t\ttrs.push(\r\n\t\t\t\t\t\t<tr className='c3-tooltip-name--data2' key={acc2.value}>\r\n\t\t\t                      <td className=\"name\"><span style={{backgroundColor: acc2.color}}></span></td>\r\n\t\t\t                      <td className=\"value\" >{currencyFormat(c[ix])}</td>\r\n\t\t\t            </tr>\r\n\t\t\t     )\r\n\t\t\t}\r\n\t\t})\r\n\t\t\r\n\t\ta_table = \r\n\t\t\t        <table className='c3-tooltip'>\r\n\t\t              <tbody>\r\n\t\t              \t  {showdate ? <th colSpan = '2'>{dateFormat(dt, \"dd.mm.yyyy ddd\")}</th>: null}\r\n\t\t              \t  {trs}\r\n\t\t              </tbody>\r\n\t\t            </table>\r\n\t\treturn a_table\r\n\t}\r\n}\r\nexport {accountsTooltipTable}","const NEXTDAY = 'NEXTDAY'\r\nconst nextDayAction = () => (\r\n  { \r\n\ttype: NEXTDAY,\r\n    payload: \r\n    \t{\r\n    \t\tnextday : (new Date()).getTime() //only signal\r\n    \t} \r\n  }\r\n)\r\n\r\nconst PREVDAY = 'PREVDAY'\r\nconst prevDayAction = () => (\r\n  { \r\n\ttype: PREVDAY,\r\n    payload: \r\n    \t{\r\n    \t\tprevday : (new Date()).getTime() //only signal\r\n    \t} \r\n  }\r\n)\r\n\r\nconst TODAY = 'TODAY'\r\nconst todayAction = () => (\r\n  { \r\n\ttype: TODAY,\r\n    payload: \r\n    \t{\r\n    \t\ttoday : (new Date()).getTime() //only signal\r\n    \t} \r\n  }\r\n)\r\n\r\nconst next_day = () => (\r\n    (dispatch) => {\r\n    \tdispatch(nextDayAction())\r\n    }\r\n)\r\n\r\nconst prev_day = () => (\r\n    (dispatch) => {\r\n    \tdispatch(prevDayAction())\r\n    }\r\n)\r\n\r\nconst today = () => (\r\n    (dispatch) => {\r\n    \tdispatch(todayAction())\r\n    }\r\n)\r\n\r\nexport {\r\n\tnext_day,\r\n\tprev_day,\r\n\ttoday,\r\n}\r\n","import React from 'react' // ← Main React library\r\nimport { Button } from 'react-bootstrap';\r\nimport { connect } from 'react-redux'\r\nimport { prev_day } from '../../actions/day'\r\nvar FontAwesome = require('react-fontawesome');\r\n\r\nclass ButtonL extends React.Component{\r\n\tconstructor(props) {\r\n\t    super(props)\r\n\t    this.prevDay = this.prevDay.bind(this)\r\n\t}\r\n\r\n\tprevDay() {\r\n\t\tthis.props.chartPrevDay()\r\n\t}\r\n\r\n\t render(){\r\n\t    return (\r\n\t    <div>\r\n\t     <Button onClick={this.prevDay}>\r\n\t     \t<FontAwesome name='caret-left' />\r\n\t     </Button>\r\n\t    </div>\r\n\t    )\r\n\t}\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch) {\r\n  return ({\r\n    chartPrevDay: () => {\r\n      dispatch(prev_day())\r\n    }\r\n  })\r\n}\r\n\r\nexport default connect(null, mapDispatchToProps)(ButtonL)\r\n","import React from 'react' // ← Main React library\r\nimport { Button } from 'react-bootstrap';\r\nimport { connect } from 'react-redux'\r\nimport { next_day } from '../../actions/day'\r\nvar FontAwesome = require('react-fontawesome');\r\n\r\nclass ButtonR extends React.Component{\r\n\tconstructor(props) {\r\n\t    super(props)\r\n\t    this.nextDay = this.nextDay.bind(this)\r\n\t}\r\n\t\r\n\tnextDay() {\r\n\t\tthis.props.chartNextDay()\r\n\t}\r\n\t\r\n\trender(){\r\n\t    return (\r\n\t    <div>\r\n\t     <Button onClick={this.nextDay}>\r\n\t     \t<FontAwesome name='caret-right' />\r\n\t     </Button>\r\n\t    </div>\r\n\t    )\r\n\t}\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch) {\r\n    return ({\r\n        chartNextDay: () => {\r\n            dispatch(next_day())\r\n        }\r\n    })\r\n}\r\n\r\nexport default connect(null, mapDispatchToProps)(ButtonR)\r\n","import React from 'react' // ← Main React library\r\nimport { Button } from 'react-bootstrap';\r\nimport { connect } from 'react-redux'\r\nimport { today } from '../../actions/day'\r\n\r\nclass ButtonToday extends React.Component{\r\n\tconstructor(props) {\r\n\t    super(props)\r\n\t    this.today = this.today.bind(this)\r\n\t}\r\n\t\r\n\ttoday() {\r\n\t\tthis.props.chartToday()\r\n\t}\r\n\t\r\n\trender(){\r\n\t    return (\r\n\t    <div>\r\n\t     <Button onClick={this.today}>\r\n\t     \tToday\r\n\t     </Button>\r\n\t    </div>\r\n\t    )\r\n\t}\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch) {\r\n    return ({\r\n        chartToday: () => {\r\n            dispatch(today())\r\n        }\r\n    })\r\n}\r\n\r\nexport default connect(null, mapDispatchToProps)(ButtonToday)\r\n","import React from 'react';\r\nimport { connect } from 'react-redux'\r\nimport { Panel, Table, Button } from 'react-bootstrap'\r\nimport CurrencyField from '../editorFields/CurrencyField'\r\nimport './Calculator.css'\r\nimport currencyFormat from '../../util/currency'\r\n\r\nvar FontAwesome = require('react-fontawesome')\r\n\r\nclass Calculator extends React.Component {\r\n\tconstructor(props) {\r\n        super(props)\r\n        this.changeValue = this.changeValue.bind(this)\r\n        this.newRow = this.newRow.bind(this)\r\n        this.clear = this.clear.bind(this)\r\n        this.state = { \r\n        \trows: []\r\n        }\r\n\t}\r\n\t\r\n\tchangeValue(value, field, index) {\r\n\t\tconsole.log('changePropertyF: '+value+' index:'+index)\r\n\t\tvar rows = this.state.rows.slice()\r\n\t\trows[index] = value\r\n\t\tthis.setState({\r\n\t\t\t'rows': rows\r\n\t\t})\r\n    }\r\n\t\r\n\tnewRow() {\r\n\t\tvar rows = this.state.rows.slice()\r\n\t\trows.push('0.00')\r\n\t\t\r\n\t\tthis.setState({\r\n\t\t\t'rows': rows\r\n\t\t})\r\n\t}\r\n\t\r\n\tcomponentWillReceiveProps(nextprops) {\r\n\t\tif(nextprops.ts !== this.props.ts) {\r\n\t\t\tvar rows = this.state.rows.slice()\r\n\t\t\trows.push(nextprops.p)\r\n\t\t\r\n\t\t\tthis.setState({\r\n\t\t\t\t'rows': rows\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\t\r\n\tclear() {\r\n\t\tthis.setState({\r\n\t\t\t'rows': []\r\n\t\t})\r\n\t}\r\n\t\r\n\trender() {\r\n\t\t//if(this.state.rows.length === 0) return null\r\n\t\t\t\r\n\t\tvar sum = 0\r\n\t\tthis.state.rows.map( r => {\r\n\t\t\tsum += Number(r)\r\n\t\t\treturn null\r\n\t\t} )\r\n\t\treturn(\r\n\t\t\t<div >\r\n\t\t\t  <Panel  >\r\n\t\t\t  \t<Panel.Heading style={{padding: \"5px\", height: \"30px\", fontSize: \"15px\"}}>\r\n\t\t\t\t<span className=\"pull-right\" style={{display: \"inline-flex\"}}>  \t\r\n\t\t\t\t\t{currencyFormat(sum)}\r\n\t\t\t\t</span>\r\n\t\t\t  \t</Panel.Heading>\r\n\t\t\t  \t<Panel.Body style={{padding: \"2px\"}}>\r\n\t\t\t  \t{this.state.rows.length === 0 ? null : \r\n\t\t\t  \t<Table id=\"calc_table\" style={{marginBottom: '10px'}} striped hover condensed>\r\n\t\t\t\t<tbody style={{border: 'none'}}>\r\n\t\t\t\t\r\n\t\t\t\t{this.state.rows.map( (row, index) => {\r\n\t\t\t\t\treturn(\r\n\t\t\t\t\t<tr key={'calr'+index}>\t\t\r\n\t\t\t\t\t<td style={{border: 'none', padding: '0px', margin: '0px'}}>\r\n\t\t\t\t\t\r\n\t\t\t  \t\t<CurrencyField \r\n\t\t\t  \t\t\t\tid = 'calcf'\r\n\t\t\t\t\t  \t\tonValueChanged = {this.changeValue}\r\n\t\t\t\t\t  \t\tplaceholder = 'amount'\r\n\t\t\t\t\t  \t\tvalue = {row}\r\n\t\t\t\t\t  \t\treadOnly = {false}\r\n\t\t\t\t  \t\t\tfield = 'calc'\r\n\t\t\t\t  \t\t\tindex = {index}\r\n\t\t\t\t  \t\t\ttouched = {false}\r\n\t\t\t  \t\t/>\r\n\t\t\t  \t\t</td>\r\n\t\t\t  \t\t</tr>\r\n\t\t\t  \t\t\r\n\t\t\t\t\t)})\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t</tbody>\r\n\t\t\t</Table>}\r\n\t          <span className=\"pull-right\" style = {{\"display\": \"inline-flex\", \r\n              \"whiteSpace\": \"nowrap\",\r\n                'marginLeft':'1px'}}>\r\n\t\t\t\t<Button onClick={this.newRow}><FontAwesome name = 'plus' /></Button>\r\n\t\t\t\t{this.state.rows.length === 0 ? null : <Button style= {{fontStyle: 'italic', fontWeight: 'bold'}} onClick={this.clear}>C</Button> }\r\n\t\t\t\t</span>\r\n\t\t\t\t</Panel.Body>\r\n\r\n\t\t\t  </Panel>\r\n\t\t\t</div>\r\n\t\t\t)\r\n\t}\r\n}\r\n\r\nconst mapStateToProps = (store) => {\r\n    return {\r\n        p: store.calculator.p,\r\n        ts: store.calculator.ts\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps)(Calculator)\r\n","import React from 'react' // ← Main React library\r\nimport { connect } from 'react-redux'\r\nimport { Panel, Button } from 'react-bootstrap';\r\nimport Payments from '../payments/payments'\r\nimport PaymentSelection from '../paymentSelection/paymentSelection'\r\nimport Spinner from './Spinner'\r\nimport { get_constants } from '../../actions/constants'\r\nimport { findInArray } from '../../util/findInArray'\r\nimport {accountsTooltipTable} from '../../util/tooltip'\r\nimport ButtonL from '../day/buttonL'\r\nimport ButtonR from '../day/buttonR'\r\nimport ButtonToday from '../day/buttonToday'\r\n\r\nimport { day_load } from '../../actions/payments'\r\nimport { category_load } from '../../actions/payments'\r\nimport { account_load } from '../../actions/payments'\r\n\r\nimport Calculator from '../calculator/calculator'\r\n\r\nimport {prev_in_history, next_in_history} from '../../actions/payments'\r\nimport Media from 'react-media';\r\n\r\n\r\nvar dateFormat = require('dateformat');\r\nvar FontAwesome = require('react-fontawesome');\r\n\r\n\r\nclass DetailsPanel extends React.Component{\r\n\tconstructor(props) {\r\n\tsuper(props);\r\n\tthis.state = {\r\n    \t\taccs: props.getConstants('acc'), // return null, but launches fetch\r\n    \t\tcats: props.getConstants('cat'), // return null, but launches fetch\r\n    \t\trefreshTime: null,\r\n        \tstart: null,\r\n        \tend: null,   \r\n       }\r\n\t   this.defaultDate = new Date()\r\n       this.prevHistory = this.prevHistory.bind(this)\r\n       this.nextHistory = this.nextHistory.bind(this)\r\n\t}\r\n    componentWillReceiveProps(nextProps){\r\n    \tif( nextProps.constants && nextProps.constants['acc']) {\r\n    \t\tthis.setState({\r\n\t\t    \t\taccs : nextProps.constants['acc']\r\n\t\t    })\r\n    \t}\r\n    \tif( nextProps.constants && nextProps.constants['cat']) {\r\n    \t\tthis.setState({\r\n\t\t    \t\taccs : nextProps.constants['cat']\r\n\t\t    })\r\n    \t}\r\n    \t\r\n    \t//range changed: load cat / acc anew\r\n    \tif (this.state.start == null && nextProps.start != null) {\r\n\t    \tthis.setState({\r\n\t\t    \t\tstart : nextProps.start,\r\n\t\t    \t\tend : nextProps.end\t\t\r\n\t\t    })\r\n\t  \t} else if (\r\n        this.state.start != null && nextProps.start != null\r\n        &&\r\n        (\r\n          this.state.start.getMilliseconds() != nextProps.start.getMilliseconds()\r\n          ||\r\n          this.state.end.getMilliseconds() != nextProps.end.getMilliseconds()\r\n        )\r\n      )\r\n\t  \t{\r\n    \t\tthis.setState({\r\n\t\t    \t\tstart : nextProps.start,\r\n\t\t    \t\tend : nextProps.end\t\t\r\n\t\t    })\r\n\r\n    \t\tswitch(this.props.queryType) {\r\n    \t\t\t\t\tcase 'd' : this.props.dayLoad(this.props.params.d)\r\n                     break;\r\n    \t\t\t\t\tcase 'a' :\r\n    \t\t\t\t\t\t\t   this.props.accountLoad(this.props.params.a, nextProps.start, nextProps.end)\r\n    \t\t\t\t\t\t\t   break;\r\n    \t\t\t\t\tcase 'c' : this.props.categoryLoad(this.props.params.c, nextProps.start, nextProps.end)\r\n    \t\t\t\t\t\t\t   break;\r\n    \t\t}\r\n    \t}\r\n    \t\r\n    }\r\n\r\n  prevHistory() {\r\n    this.props.prevInHistory()\r\n  }\r\n\r\n  nextHistory() {\r\n    this.props.nextInHistory()\r\n  }\r\n  render(){\r\n\r\n\r\n\t    var info = '';\r\n\t\tswitch(this.props.queryType) {\r\n\t\t\tcase 'd' : \r\n        info =\r\n          <span style = {{\"display\": \"inline-flex\",\r\n                          \"whiteSpace\": \"nowrap\",\r\n                           \"alignItems\": \"center\",\r\n                           'marginRight':'5px',\r\n                            'marginLeft':'5px'}}>\r\n            <ButtonL />\r\n              <div  style = {{'marginRight':'5px',  'marginLeft':'5px'}} >\r\n                {dateFormat(this.props.params.d, \"dd.mm.yyyy ddd\")}\r\n              </div>\r\n            <ButtonR />\r\n          </span>\r\n\r\n  \t\t\t\tthis.defaultDate = this.props.params.d\r\n\t\t\t\tbreak\r\n\t\t\tcase 'a' :\r\n\t\t\t\tvar acc = findInArray(this.props.constants['acc'], n => { return this.props.params.a === '' + n.value})\r\n\t\t\t\tinfo = \r\n\t\t\t\t<span >\r\n\t\t\t\t\t<span style = {{'marginRight':'5px', 'marginLeft':'5px'}}>\r\n\t\t\t\t\t\tAccount : <FontAwesome name = 'square' style = {{'color': acc.color}} />\r\n\t\t\t\t\t</span>\r\n\t    \t\t\t<span>\r\n\t    \t\t\t\t{acc.label}\r\n\t    \t\t\t</span>\r\n\t    \t\t</span>\r\n\t\t\t\t\r\n\t\t\t\tbreak\r\n\t\t\tcase 'c' : \r\n\t\t\t\tvar cat = findInArray(this.props.constants['cat'], n => { return this.props.params.c === '' + n.value})\r\n\t\t\t\tinfo = \r\n\t\t\t\t<span >\r\n\t\t\t\t\t<span style = {{'marginRight':'5px', 'marginLeft':'5px'}}>\r\n\t\t\t\t\t\tIssue : <FontAwesome name = 'square' style = {{'color': cat.color}} />\r\n\t\t\t\t\t</span>\r\n\t    \t\t\t<span>\r\n\t    \t\t\t\t{cat.label}\r\n\t    \t\t\t</span>\r\n\t    \t\t</span>\r\n\t    \t\t\r\n\t\t\t\tbreak\r\n\t\t\tcase 'g' :\r\n\t\t\t\tinfo = \r\n\t\t\t\t\t<span>\r\n\t\t\t\t\t\t&nbsp;<FontAwesome name='paperclip' size='lg' />  {this.props.params.g}\r\n\t\t\t\t\t</span>\r\n\t\t\t\tbreak\r\n\t\t\tcase 'l' : \r\n\t\t\t\tinfo =\r\n\t\t\t\t    <span>\r\n                       \t&nbsp;<FontAwesome name='check-square' size='lg' />  {this.props.params.g}\r\n                    </span>\r\n\t\t\t\tbreak\r\n\t\t\tdefault: info = '';\r\n\t\t\t\tbreak\r\n\t\t}\r\n\t\tvar a_table = null\r\n\t\t\r\n\t\tif(this.props.queryType === 'd' && this.props.curves) {\r\n\r\n\t\t\ta_table = accountsTooltipTable(this.props.params.d, this.props.curves, this.props.constants)\r\n\t\t\tif(a_table !== null) {\r\n\t\t\t\ta_table =\r\n\t\t\t\t<div style={{paddingBottom: \"4px\"}}>\r\n\t\t\t\t\t{a_table}\r\n\t\t\t    </div>\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n    var hstackfirst = this.props.historystack != null && this.props.historystack.first != null ? this.props.historystack.first : true\r\n    var hstacklast = this.props.historystack != null && this.props.historystack.last != null ? this.props.historystack.last : true\r\n\r\n    var headerNormal =\r\n    \t\t\t\t<Panel.Heading style={{paddingTop: \"5px\", paddingBottom: \"3px\", height: \"45px\"}}>\r\n    \t\t\t\t  \t<div style={{\"display\": \"inline-flex\", \"whiteSpace\": \"nowrap\", \"alignItems\": \"center\", fontSize: \"23px\"}}>\r\n\t\t\t\t  \t\t\t<FontAwesome name='th-list' />&nbsp;<PaymentSelection /><span style={{fontSize: \"15px\"}}>{info}</span><Spinner fetching={this.props.fetching} />\r\n\t\t\t\t  \t\t</div>\r\n\t\t\t\t  \t\t<span className=\"pull-right\" style={{display: \"inline-flex\"}}>\r\n\t\t\t\t\t  \t\t<ButtonToday />\r\n\t\t\t\t\t  \t\t<Button style={{borderRadius: '20px', height: '35px', paddingTop: '2px', color: (hstackfirst ? \"gray\" : \"darkblue\")}} onClick={this.prevHistory} disabled={hstackfirst}><FontAwesome name='arrow-circle-left' size=\"2x\" color=\"blue\" /></Button>\r\n\t\t\t\t\t  \t\t<Button style={{borderRadius: '20px', height: '35px', paddingTop: '2px', color: (hstacklast ? \"gray\": \"darkblue\")}} disabled={hstacklast} onClick={this.nextHistory}><FontAwesome name='arrow-circle-right' size=\"2x\" color=\"blue\" /></Button>\r\n\t\t\t\t\t  \t</span>\r\n\t\t\t\t\t</Panel.Heading>\r\n\t\r\n\tvar headerNarrow =\r\n\t\t\t\t<Panel.Heading style={{paddingTop: \"5px\", paddingBottom: \"3px\", height: \"80px\"}}>\r\n\t\t\t\t  \t<div style={{\"display\": \"inline-flex\", \"whiteSpace\": \"nowrap\", \"alignItems\": \"center\", fontSize: \"23px\"}}>\r\n\t\t\t  \t\t\t<FontAwesome name='th-list' />&nbsp;<PaymentSelection /><span style={{fontSize: \"15px\"}}>{info}</span><PaymentSelection /><Spinner fetching={this.props.fetching} />\r\n\t\t\t  \t\t</div>\r\n\t\t\t  \t\t<span style={{display: \"inline-flex\"}}>\r\n\t\t\t\t  \t\t<ButtonToday />\r\n\t\t\t\t  \t\t<Button style={{borderRadius: '20px', height: '35px', paddingTop: '2px', color: (hstackfirst ? \"gray\" : \"darkblue\")}} onClick={this.prevHistory} disabled={hstackfirst}><FontAwesome name='arrow-circle-left' size=\"2x\" color=\"blue\" /></Button>\r\n\t\t\t\t  \t\t<Button style={{borderRadius: '20px', height: '35px', paddingTop: '2px', color: (hstacklast ? \"gray\": \"darkblue\")}} disabled={hstacklast} onClick={this.nextHistory}><FontAwesome name='arrow-circle-right' size=\"2x\" color=\"blue\" /></Button>\r\n\t\t\t\t  \t</span>\r\n\t\t\t\t</Panel.Heading>\r\n\treturn(\r\n\t\t\t<div>\r\n\t\t\t  <Panel style={{width: '100%', opacity: this.props.fetching ? 0.3 : 1 }}>\r\n\t\t\t  \t<Media query=\"(max-width: 432px)\">\r\n\t\t\t          {matches =>\r\n\t\t\t            matches ? (\r\n\t\t\t              headerNarrow\r\n\t\t\t            ) : (\r\n\t\t\t              headerNormal\r\n\t\t\t            )\r\n\t\t\t          }\r\n    \t\t\t</Media>\r\n\t\t\t  \t\r\n\t\t\t  \t<Panel.Body>\t\t\t\t\t\r\n\t\t\t  \t<table>\r\n\t\t\t  \t  <tbody>\r\n\t\t\t\t  \t  <tr>\r\n\t        \t\t\t<td style={{width: '100%', verticalAlign: 'top'}}>\r\n\t\t        \t\t\t<Payments defaultDate={this.defaultDate}/>\r\n\t\t        \t\t</td>\r\n\t\t        \t\t<td style={{width: '30px', verticalAlign: 'top', paddingLeft: '4px'}}>\r\n\t\t        \t\t{a_table}\r\n\t\t        \t\t<Calculator />\r\n\t\t        \t\t</td>\r\n\t\t        \t   </tr>\r\n\t        \t   </tbody>\r\n        \t      </table>\r\n\t\t\t\t</Panel.Body>\r\n\t\t\t  </Panel>\r\n\t\t\t</div>\t\t\t\t\t\r\n\t\t)\r\n\t}\r\n}\r\n\r\nconst mapStateToProps = (store) => {\r\n    return {\r\n        fetching: store.payments.fetching,\r\n        queryType: store.payments.queryType,\r\n        historystack: store.payments.historystack,\r\n        params: store.payments.params,\r\n        refreshTime:  store.constants.refreshTime,\r\n        constants: store.constants.constants,\r\n        curves: store.chart.curves,\r\n        \r\n        start: store.daterange.s,\r\n        end: store.daterange.e,\r\n    }\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch) {\r\n    return({\r\n        getConstants: (id) => {\r\n        \tget_constants(id, dispatch)\r\n        },\r\n        prevInHistory: () => {\r\n          dispatch(prev_in_history())\r\n        },\r\n        nextInHistory: () => {\r\n          dispatch(next_in_history())\r\n        },\r\n        dayLoad: (d) => {\r\n          dispatch(day_load(d))\r\n        },\r\n        accountLoad: (a, d1, d2) => {\r\n            dispatch(account_load(a, d1, d2))\r\n        },\r\n        categoryLoad: (c, d1, d2) => {\r\n            dispatch(category_load(c, d1, d2))\r\n        },\r\n    })\r\n}\r\nexport default connect(mapStateToProps, mapDispatchToProps)(DetailsPanel)\r\n\r\n","import React from 'react'\r\nimport c3 from 'c3'\r\nimport ReactDOMServer from 'react-dom/server';\r\n\r\nimport {addDays, daydiff} from '../../util/addDays'\r\nimport {accountsTooltipTable} from '../../util/tooltip'\r\n\r\nimport { chart_load } from '../../actions/chart'\r\nimport { day_load, account_load } from '../../actions/payments'\r\n//import initials from '../../util/initials'\r\nimport { connect } from 'react-redux'\r\nimport { get_constants } from '../../actions/constants'\r\nimport { set_daterange, set_todayrange, daterange_next_block, daterange_prev_block } from '../../actions/daterange'\r\n\r\nimport '../../../node_modules/c3/c3.min.css'\r\nimport './style_region.css'\r\n\r\nimport {findInArray} from '../../util/findInArray'\r\n\r\nvar d3 = require('d3');\r\n\r\nvar dateFormat = require('dateformat');\r\nvar selectedDayOrAccount = -1\r\n\r\nvar SELECTONHOVER = false\r\n\r\nclass Chart extends React.Component {\r\n    constructor(props) {\r\n        super(props)\r\n        \r\n        var that = this;\r\n        this.state = {\r\n    \t\t//start: initials.startDate,\r\n        \tstart: null,\r\n    \t\t//end: initials.endDate,\r\n        \tend: null,\r\n    \t\tcurves: null, //Curves\r\n    \t\tconstants: props.getConstants('acc'), // return null, but launches fetch\r\n    \t\trefreshTime: null,\r\n    \t\tselectedType: '',\r\n    \t\tnextday: null,\r\n    \t\tprevday: null,\r\n    \t\ttoday: null,\r\n    \t\tredraw: null\r\n        }\r\n        \r\n        this.boundingRect = null\r\n        this.hahlo_ix = null\r\n        this.hahlo = null\r\n        this.draw = this.draw.bind(this)\r\n        this.dateselect = this.dateselect.bind(this)\r\n        this.paint_dayselection = this.paint_dayselection.bind(this)\r\n        this.nextday = this.nextday.bind(this)\r\n        this.prevday = this.prevday.bind(this)\r\n        this.today = this.today.bind(this)\r\n        this.redraw = this.redraw.bind(this)\r\n        this.legendnames = this.legendnames.bind(this)\r\n        this.onmouseover = this.onmouseover.bind(this)\r\n        this.onmouseover_account = this.onmouseover_account.bind(this)\r\n        this.onmouseout = this.onmouseout.bind(this)\r\n        this.find_ix = this.find_ix.bind(this)\r\n        this.chartDatetoDate = this.chartDatetoDate.bind(this)\r\n        this.tooltip = this.tooltip.bind(this)\r\n        this.c3onRendered = this.c3onRendered.bind(this)\r\n        \r\n        this.timer = null\r\n        this.chart_config = {\r\n        \tonrendered: this.c3onRendered,\r\n            bindto: '#chart',\r\n            /*grid: {\r\n                y: {\r\n                    lines: [{\r\n                        value: 0\r\n                    }]\r\n                }\r\n            },*/\r\n            grid: {\r\n                x: {\r\n                    show: true\r\n                },\r\n                y: {\r\n                    show: true,\r\n                    lines: [{\r\n                        value: 0\r\n                    }]\r\n                }\r\n            },\r\n            tooltip: {\r\n                grouped: true, // Default true\r\n                /*format: {\r\n                \tvalue: function (value, ratio, id, index) { return currencyFormat(value) },\r\n                \tname: function (name, ratio, id, index) { return '' }\r\n                },*/\r\n                \r\n            \r\n              \tcontents: function (d, defaultTitleFormat, defaultValueFormat, color) {\r\n            \t  \treturn that.tooltip(d)\r\n                }\r\n            },\r\n            /*regions: [\r\n                {start:\"20180202T12\", end: \"20180203T12\"},\r\n                {start:2, end:4, class:'foo'}\r\n            ],*/\r\n            data: {\r\n                x: 'x',\r\n                onmouseover: function (c) { \r\n    \t\t        \tif (SELECTONHOVER) {\r\n    \t\t        \t\tthat.onmouseover(c)\r\n    \t\t        \t}\r\n    \t\t    },\r\n                onclick: this.onmouseover,\r\n                xFormat: '%Y%m%dT%H',\r\n                columns: null,\r\n                transition: {\r\n                    duration: 500\r\n                },\r\n                names : {},\r\n                colors : {},\r\n                types : {},\r\n                type: 'bar',\r\n                groups: [\r\n                    ['E', 'I']\r\n                ],\r\n                selection: {}\r\n            },\r\n            axis: {\r\n                x: {\r\n                    type: 'timeseries',\r\n                    tick: {\r\n                    \tculling: {\r\n                    \t\tmax: 10 // the number of tick texts will be adjusted to less than this value note: does not work?\r\n                    \t},\r\n                        //format: x => {return dateFormat(x, \"dd.mm.yyyy ddd\")}\r\n                    \tformat: x => {return dateFormat(x, \"dd.mm\")}\r\n                    }\r\n                }\r\n            },\r\n            legend: {\r\n                item: {\r\n                    onclick: function(a) {\r\n //                       console.log(\"LEGEND\")\r\n //                       console.log(a)\r\n                    \tthat.onmouseover_account(a)\r\n                    },\r\n                    onmouseover: function(a) {\r\n//                        console.log(a)\r\n                        //magic copied from caller to do the default behaviour (i.e. dim other curves and focus the selected curve) :\r\n                        if (!this.transiting && this.isTargetToShow(a)) {\r\n                            this.api.focus(a)\r\n                        }\r\n                        //magic ends here\r\n                        if (SELECTONHOVER) {\r\n                        \tthat.onmouseover_account(a)\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n       //this.props.chartLoad(this.state.start ,this.state.end)\r\n    }\r\n    \r\n    tooltip(dt) {\r\n\t\tvar a_table = accountsTooltipTable(dt[0].x, this.props.curves, this.props.constants, true)\r\n\t\treturn ReactDOMServer.renderToStaticMarkup(a_table)\r\n    }\r\n    \r\n    onmouseout() {\r\n        if (this.timer) {\r\n            clearTimeout(this.timer)\r\n        }\r\n    }\r\n    \r\n    onmouseover(d) {\r\n    \t//console.log(d)\r\n    \tif(SELECTONHOVER) {\r\n\t    \t\tif(d.id === \"I\" && daydiff(d.x, this.selectedDate) !== 0) {\r\n\t    \t\t if (this.timer) {\r\n\t    \t       \tclearTimeout(this.timer)\r\n\t    \t    }\r\n\t    \t\tvar f = () => {\r\n\t    \t\t\tthis.dateselect(d.x)\r\n\t    \t\t}\r\n\t    \t\t\r\n\t    \t\t//console.log(\"FIRE:\" + d.id+ \" \" + d.x + \" \" + this.selectedDate)\r\n\t\t        this.timer = setTimeout(f, 300)\r\n\t    \t}\r\n    \t} else {\r\n    \t\tthis.dateselect(d.x)\r\n    \t}\r\n    \t/*\r\n    \tif (this.timer) {\r\n    \t       \tclearTimeout(this.timer)\r\n    \t    }\r\n\r\n\r\n       if (d.id === \"I\") { //this is because event will be trigger for all curves and we want to load day only once\r\n\t    \tvar f = () => {\r\n\t    \t\tthis.dateselect(d.x)\r\n\t    \t}\r\n\r\n\t           console.log(\"FIRE:\" + d.id+ \" \" + d.x)\r\n\t           this.timer = setTimeout(f, 300)\r\n       }*/\r\n    }\r\n    \r\n   \r\n    \r\n    chartDatetoDate(d) {\r\n    \tvar year = d.substring(0,4)\r\n    \tvar month = d.substring(4,6) - 1\r\n    \tvar day = d.substring(6,8)\r\n    \treturn new Date(year, month, day)\r\n    }\r\n\r\n    find_ix(d) {\r\n    \tif(!this.chart_config.data.columns) return null;\r\n\r\n    \tvar ix = daydiff(this.chartDatetoDate(this.chart_config.data.columns[0][1]), d)\r\n    \treturn ix\r\n    }\r\n\r\n    \r\n    nextday() {\r\n    \tif(this.selectedDate) {\r\n    \t\tthis.dateselect(addDays(this.selectedDate, 1))\r\n    \t}\r\n    }\r\n    \r\n    prevday() {\r\n    \tif(this.selectedDate) {\r\n    \t\tthis.dateselect(addDays(this.selectedDate, -1))\r\n    \t}\r\n    }\r\n\r\n    today() {\r\n\t\tvar now = new Date()\r\n\t\tthis.props.daterangeToday()\r\n\t\tthis.dateselect(now)\r\n    }\r\n    \r\n    redraw() {\r\n    \tthis.draw()\r\n    }\r\n    \r\n    onmouseover_account(a) {\r\n    \tif (a === \"I\" || a === \"E\") return;\r\n        //magic copied from caller to do the default behaviour (i.e. dim other curves and focus the selected curve) :\r\n       /* if (!this.transiting && this.isTargetToShow(a)) {\r\n            this.api.focus(a)\r\n        }*/\r\n        //magic ends\r\n    \tvar that = this\r\n        var f = () => {\r\n\r\n            this.props.accountLoad(a, that.props.start ,that.props.end)\r\n        }\r\n        this.timer = setTimeout(f, 300)\r\n    }\r\n    \r\n    dateselect(d) {\r\n    \t\t\tthis.selectedDate = d\r\n    \t\t\t//CHG-13this.legendnames(this.props.curves, this.props.constants)\r\n            \t//vähän vois kyl kauniimmaks laittaa:\r\n    \t\t\tvar ix = this.find_ix(d)\r\n    \t\t\tif(null !== ix && ix === -1)  {\r\n    \t\t\t\t//console.log(\"vasemmalta yli \"+ix)\r\n    \t\t\t\tthis.props.daterangePrevBlock()\r\n    \t\t\t\tix = this.chart_config.data.columns[0].length - 2\r\n    \t\t\t\t//console.log(\"vasemmalta yli \"+ix)\r\n    \t\t\t}\r\n    \t\t\tif(null != ix && ix === this.chart_config.data.columns[0].length - 1)  {\r\n    \t\t\t\t//console.log(\"oikealta yli \"+ix)\r\n    \t\t\t\tthis.props.daterangeNextBlock()\r\n    \t\t\t\tix = 0\r\n    \t\t\t}\r\n\r\n                this.props.dayLoad(d, ix)\r\n                this.paint_dayselection()\r\n\r\n    }\r\n   \r\n    paint_dayselection() {\r\n\t        if(this.hahlo_ix != null) {\r\n\t          //console.log(\"gray repaint:\"+dateFormat(this.selectedDate, \"yyyymmdd\"))\r\n    \t\t\t//dayselection : changing the initial\r\n    \t\t\tvar alku = dateFormat(addDays(this.selectedDate,-1), \"yyyymmdd\") + \"T20\"\r\n    \t\t\tvar loppu = dateFormat(this.selectedDate, \"yyyymmdd\") + \"T4\"\r\n    \t\t\tthis.chart_config.regions[this.hahlo_ix].start = alku\r\n    \t\t\tthis.chart_config.regions[this.hahlo_ix].end = loppu\r\n    \t\t\tc3.generate(this.chart_config)\r\n\t\t\t}\r\n    }\r\n    \r\n    render() {\r\n    \t//var width = document.getElementById('chart').getBoundingClientRect().width\r\n    \t//console.log(\"render()\")\r\n        return ( \r\n        \t<div id = \"chart\" onMouseOut = {() => this.onmouseout()} />\r\n        )\r\n   }\r\n \r\n    draw() {\r\n    \tthis.boundingRect = document.getElementById('chart').getBoundingClientRect()\r\n    \t//console.log(\"draw() width = \" + this.boundingRect)\r\n    \t\r\n    \tif(!this.chart_config.data.columns) {\r\n    \t\t//console.log(\"draw() nothing yet\")\r\n    \t\treturn //data not yet there\r\n    \t}\r\n    \t/* red / white backgrounds here*/\r\n       if(!this.chart_config.regions) {\r\n    \t   //init with white\r\n    \t   this.chart_config.regions = []\r\n    \t   for(var x=1; x<(this.chart_config.data.columns[0].length); x++) { //x date \r\n    \t\t   \r\n    \t\t   for(var y=3; y<this.chart_config.data.columns.length; y++) { //y accounts start with 3 \r\n    \t\t\t\tvar alku = dateFormat(addDays(this.chartDatetoDate(this.chart_config.data.columns[0][x]),-1), \"yyyymmdd\") + \"T12\"\r\n    \t\t\t\tvar loppu = dateFormat(this.chartDatetoDate(this.chart_config.data.columns[0][x]), \"yyyymmdd\") + \"T12\"\r\n\r\n    \t\t\t\tthis.chart_config.regions.push( \r\n\t                    {\"start\": alku, \"end\": loppu, class: this.chart_config.data.columns[y][x] < 0 ? \"red\" : \"white\"}\r\n\t                 )\t\t\r\n    \t\t   }\r\n    \t   }\r\n    \t   if(this.selectedDate) {\r\n    \t   //initial dayselection as last in array:\r\n    \t\t   //console.log(\"gray:\"+dateFormat(this.selectedDate, \"yyyymmdd\"))\r\n\t    \t   this.hahlo_ix = this.chart_config.regions.length\r\n\t    \t   var alku1 = dateFormat(addDays(this.selectedDate,-1), \"yyyymmdd\") + \"T20\"\r\n\t    \t   var loppu1 = dateFormat(this.selectedDate, \"yyyymmdd\") + \"T4\"\r\n\t    \t   this.chart_config.regions.push( \r\n\t\t            {\"start\": alku1, \"end\": loppu1, class: \"gray\"}\r\n\t\t       )\r\n    \t   }\r\n       }\r\n        c3.generate(this.chart_config)\r\n   }\r\n   \r\n   c3onRendered() {\r\n    \t//console.log(\"c3onRendered() width = \" + this.boundingRect)\r\n    \tthis.chart_config.data.columns[0].forEach((el, i) => {\r\n    \t\tif(i>0) {\r\n    \t\t\tvar svg = d3.selectAll('#chart').select('.c3-event-rect-'+(i-1))\r\n    \t\t\tvar dd=this.chartDatetoDate(el)\r\n    \t\t\tsvg[0][0].onclick = () => {\r\n    \t\t\t\tthis.dateselect(dd)\r\n    \t\t\t}\r\n    \t\t}\r\n    \t})\r\n    }\r\n    \r\n    componentWillReceiveProps(nextProps) {\r\n    \t//var width = document.getElementById('chart').getBoundingClientRect().width\r\n    \t//console.log(\"componentWillReceiveProps() width = \" + width)\r\n    \tif(nextProps.nextday !== this.props.nextday) {\r\n    \t\t//console.log('N')\r\n    \t\tthis.nextday()\r\n    \t}\r\n    \tif(nextProps.prevday !== this.props.prevday) {\r\n    \t\t//console.log('P')\r\n    \t\tthis.prevday()\r\n    \t}\r\n    \tif(nextProps.today !== this.props.today) {\r\n    \t\t//console.log('T')\r\n    \t\tthis.today()\r\n    \t}\r\n    \tif(nextProps.redraw !== this.props.redraw) {\r\n    \t\t//console.log('RD')\r\n    \t\tthis.redraw()\r\n    \t}\r\n    \t\r\n    \tif(nextProps.selectedType !== this.props.selectedType) {\r\n    \t\t//console.log('TY')\r\n    \t\tselectedDayOrAccount = -1 //reset\r\n    \t}\r\n    \t\r\n    \tif(nextProps.selectedType === 'd') {\r\n    \t\tthis.selectedDate = nextProps.params.d\r\n    \t\tthis.paint_dayselection()\r\n    \t}\r\n    \t\t\r\n    \t\r\n    \t\r\n    \tif( nextProps.constants && nextProps.constants[this.props.constants_id]) {\r\n    \t\t//console.log('C')\r\n    \t\tvar constants = nextProps.constants[this.props.constants_id]\r\n    \t\tvar selectedItem = findInArray(constants, c => { return c.value === nextProps.selectedValue })\r\n\t    \tvar validConstants = constants.filter(  c => { return (c.valid || c === selectedItem) })\r\n\t    \tthis.setState({\r\n\t\t    \t\tselectedValue : selectedItem,\r\n\t\t    \t\t'items' : validConstants\t\t\r\n\t\t    })\r\n    \t}\r\n    \t\r\n        if (\r\n        \t// eslint-disable-next-line\t\r\n        \t\t!(this.state.start == nextProps.start) //note 'undefined == null' yields true but 'undefined !== null' as well\r\n        \t|| \r\n        \t// eslint-disable-next-line\r\n        \t\t!(this.state.end == nextProps.end)) { \r\n        \t//console.log('R')\r\n        \t//selected date span changed?\r\n        \tthis.setState({\r\n\t\t    \t\tstart : nextProps.start,\r\n\t\t    \t\tend : nextProps.end\t\t\r\n\t\t    })\r\n            this.props.chartLoad(nextProps.start, nextProps.end)\r\n        } else if (nextProps.curves !== this.props.curves || nextProps.refreshTime !== this.props.refreshTime) {\r\n        \t//console.log('CU')\r\n        \t//TODO jäi tähän laita värit ja nimet tilit on jo account#ssa\r\n        \tthis.chart_config.data.names = {}\r\n        \tthis.chart_config.data.types = {}\r\n        \tthis.chart_config.data.colors = {}\r\n        \tthis.chart_config.data.columns = nextProps.curves //curves updated\r\n        \tthis.chart_config.regions = null \r\n        \tthis.legendnames(nextProps.curves, nextProps.constants)\r\n        \t//this.chart_config.data.names['I'] ='Income'\r\n        \tthis.chart_config.data.colors['I'] ='green'\r\n        \t//this.chart_config.data.names['E'] ='Exp'\r\n        \tthis.chart_config.data.colors['E'] ='red'\r\n//        \tvar max = 0, min = 0\r\n        \tif (nextProps.curves) {\r\n        \t\t//console.log(\"curves 1\")\r\n        \t\tvar f = n =>  { return key === '' + n.value}\r\n\t        \tfor(var i=3; i<nextProps.curves.length; i++) {\r\n\t        \t\tvar key = nextProps.curves[i][0]\r\n\t        \t\tvar acc = findInArray(nextProps.constants['acc'], f)\r\n\t        \t\tthis.chart_config.data.colors[key] = acc.color\r\n\t        \t\tthis.chart_config.data.types[key] = 'spline'\r\n\t        \t}\r\n\t            this.draw()\r\n        \t}\r\n        } \r\n    }\r\n    \r\n    \r\n    legendnames(curves, constants) {\r\n    \t//heihei ihan karmeen näköstä koodia\r\n    \tthis.chart_config.data.names['I'] ='Income'\r\n    \tthis.chart_config.data.names['E'] ='Exp'\r\n        if (curves) {\r\n        \t\tvar f = n => { return key === ''+n.value}\r\n\t        \tfor(var i=3; i<curves.length; i++) {\r\n\t        \t\tvar key = curves[i][0]\r\n\t        \t\tvar acc = findInArray(constants['acc'], f)\r\n\t        \t\tthis.chart_config.data.names[key] = acc.label\r\n\t        \t}\r\n        }\r\n    } \r\n}\r\n\r\nconst mapStateToProps = (store) => {\r\n    return {\r\n        start: store.daterange.s,\r\n        end: store.daterange.e,\r\n        curves: store.chart.curves,\r\n        nextday: store.day.nextday,\r\n        prevday: store.day.prevday,\r\n        today: store.day.today,\r\n        redraw: store.chart.redraw,\r\n        refreshTime:  store.constants.refreshTime,\r\n        constants: store.constants.constants,\r\n        selectedType: store.payments.queryType,\r\n        params: store.payments.params,\r\n    }\r\n}\r\n\r\n\r\nfunction mapDispatchToProps(dispatch) {\r\n    return ({\r\n        chartLoad: (s, e) => {\r\n        \tselectedDayOrAccount = -1; //reset\r\n            dispatch(chart_load(s, e))\r\n        },\r\n        dayLoad: (d, index) => {\r\n        \tif (index === selectedDayOrAccount) return;\r\n        \tselectedDayOrAccount = index;\r\n            dispatch(day_load(d))\r\n        },\r\n        accountLoad: (a, d1, d2) => {\r\n        \tif (a === selectedDayOrAccount) return;\r\n        \tselectedDayOrAccount = a;\r\n            dispatch(account_load(a, d1, d2))\r\n        },\r\n        getConstants: (id) => {\r\n        \tget_constants(id, dispatch)\r\n        },\r\n        daterangeToday: () => {\r\n            dispatch(set_todayrange())\r\n        },\r\n        daterangeNextBlock: () => {\r\n            dispatch(daterange_next_block())\r\n        },\r\n        daterangePrevBlock: () => {\r\n            dispatch(daterange_prev_block())\r\n        },\r\n        setDateRange: (start, end) => {\r\n            dispatch(set_daterange(start, end))\r\n        }\r\n    })\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Chart)","import React from 'react' // ← Main React library\r\nimport { Panel } from 'react-bootstrap';\r\n\r\nimport Chart from '../chart/chart'\r\n//import Buttons from '../chart/buttons'\r\n//import Spinner from './Spinner'\r\nimport { connect } from 'react-redux'\r\n//var dateFormat = require('dateformat');\r\n\r\n//var FontAwesome = require('react-fontawesome');\r\n\r\nclass ChartPanel extends React.Component{\r\n\trender(){\r\n//\t\tvar dates = \" \" + dateFormat(this.props.start, \"dd.mm.yyyy ddd\") + \" - \" + dateFormat(this.props.end, \"dd.mm.yyyy ddd\")\r\n\t\treturn(\r\n\t\t<div>\r\n\t\t\t<Panel style={{ opacity: this.props.fetching ? 0.3 : 1 }}>\r\n\t\t\t{/*\r\n\t\t\t  \t<Panel.Heading style={{paddingTop: \"6px\", paddingBottom: \"3px\", height: \"45px\", fontSize: \"23px\"}}>\r\n\t\t\t  \t\t<FontAwesome name='bar-chart' /> <span style={{fontSize: \"15px\"}}>{dates}</span><Spinner fetching={this.props.fetching} />\r\n\t\t\t  \t\t\t<span className=\"pull-right\">\r\n\t\t\t\t  \t\t\t<Buttons />\r\n\t\t\t\t  \t    </span>\r\n\t\t\t  \t</Panel.Heading> */}\r\n\t\t\t  \t<Panel.Body>\r\n\t\t\t  \t\t<Chart />\r\n\t\t\t\t</Panel.Body>\r\n\t\t\t  </Panel>\r\n\t\t</div>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nconst mapStateToProps = (store) => {\r\n    return {\r\n        fetching: store.chart.fetching,\r\n        start: store.daterange.s,\r\n        end: store.daterange.e\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps)(ChartPanel)","import {addDays} from './addDays'\r\n\r\nconst initials = {\r\n\t\tstartDate: addDays(new Date(),- 10),\r\n\t\tendDate: addDays(new Date(), 10)\r\n}\r\n\r\nexport default initials","import React from 'react'\r\nimport c3 from 'c3'\r\n\r\nimport '../../../node_modules/c3/c3.min.css'\r\n\r\nimport { pie_load } from '../../actions/pie'\r\nimport { category_load } from '../../actions/payments'\r\nimport { connect } from 'react-redux'\r\nimport currencyFormat from '../../util/currency'\r\nimport initials from '../../util/initials'\r\nimport { get_constants } from '../../actions/constants'\r\n\r\nimport { findInArray } from '../../util/findInArray'\r\n\r\nimport Media from 'react-media';\r\n\r\nimport './pie.css'\r\n\r\n//require('default-passive-events')\r\n\r\nvar d3 = require('d3');\r\n\r\n\r\n    \r\nvar SELECTONHOVER = false\r\nvar names = {}\r\n\r\nclass Pie extends React.Component {\r\n\r\n    constructor(props) {\r\n        super(props)\r\n        var that = this;\r\n        this.state = {\r\n        \tconstants: props.getConstants('cat'), // return null, but launches fetch\r\n    \t\trefreshTime: null,\r\n    \t\tredraw: null\r\n        }\r\n\r\n        this.draw = this.draw.bind(this)\r\n        this.redraw = this.redraw.bind(this)\r\n        this.onmouseover = this.onmouseover.bind(this)\r\n        this.onmouseout = this.onmouseout.bind(this)\r\n        this.c3onRendered = this.c3onRendered.bind(this)\r\n        this.d3onMouseI = this.d3onMouseI.bind(this)\r\n        this.d3onMouseOutI = this.d3onMouseOutI.bind(this)\r\n        this.d3onMouseE = this.d3onMouseE.bind(this)\r\n        this.d3onMouseOutE = this.d3onMouseOutE.bind(this)\r\n        this.getBoudingRect = this.getBoudingRect.bind(this)\r\n        \r\n        this.timer = null\r\n        this.chart_config = {\r\n        \t\tonrendered: this.c3onRendered,\r\n        \t\tsum_i: 0,\r\n        \t\tsum_e: 0,\r\n    \t\t    bindto: '#pie',\r\n    \t\t    tooltip: {\r\n    \t\t        format: {\r\n    \t\t            //TODO make a util function to format a sum:\r\n    \t\t            value: function (value, ratio, id) {\r\n    \t\t            \t/*if (id.startsWith(\"p\")) {*/\r\n    \t\t            \tif (id.substr(0,1) === \"p\") {\r\n    \t\t            \t\treturn value + \"  (\" + currencyFormat(value*100/that.chart_config.sum_i) + \"%)\"\r\n    \t\t            \t}else{\r\n    \t\t            \t\treturn -value + \"  (\" + currencyFormat(-value*100/that.chart_config.sum_e) + \"%)\";\r\n    \t\t        \t\t    \r\n    \t\t            \t}\r\n    \t\t            }\r\n    \t\t        }\r\n    \t\t    },\r\n    \t\t    data: {\r\n                    names: {},\r\n    \t\t        columns: [],\r\n    \t\t        colors: {},\r\n    \t\t        order: null,\r\n    \t\t        onclick: function (c) { \r\n    \t\t        \tthat.onmouseover(c.id)\r\n    \t\t        },\r\n    \t\t        onmouseover: function (c) { \r\n    \t\t        \tif (SELECTONHOVER) {\r\n    \t\t        \t\tthat.onmouseover(c.id)\r\n    \t\t        \t}\r\n    \t\t        }, \t\t        \r\n    \t\t        type: 'pie'\r\n    \t\t    },\r\n    \t\t    pie: {\r\n    \t\t        label: {\r\n    \t\t            format: function (value, ratio, id) {\r\n    \t\t            \t//console.log(value)\r\n    \t\t            \t//console.log(ratio)\r\n    \t\t            \t//console.log(id)\r\n    \t\t            \t//console.log(names[id])\r\n    \t\t                return names[id];\r\n    \t\t            }\r\n    \t\t        }\r\n    \t\t    },\r\n                legend: {\r\n                \tshow: true,\r\n                    item: {\r\n                        onclick: function(c) {\r\n                        \tthat.onmouseover(c)\r\n                        },\r\n                        onmouseover: function(c) {\r\n                            //magic copied from caller to do the default behaviour (i.e. dim other curves and focus the selected curve) :\r\n                            if (!this.transiting && this.isTargetToShow(c)) {\r\n                                this.api.focus(c)\r\n                            }\r\n                            //magic ends here\r\n                            if (SELECTONHOVER) {\r\n                            \tthat.onmouseover(c)\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n    \t\t}\r\n    }\r\n\r\n    onmouseout() {\r\n        if (this.timer) {\r\n            clearTimeout(this.timer)\r\n        }\r\n    }\r\n\r\n    onmouseover(c) {\r\n            var f = () => {\r\n                this.props.categoryLoad(c.substring(1), this.props.start, this.props.end)\r\n            }\r\n            this.timer = setTimeout(f, 300)\r\n    }\r\n    \r\n    getBoudingRect() {\r\n    \tvar br = document.getElementById(this.chart_config.bindto.substring(1)).getBoundingClientRect()\r\n    \tvar doc = document.documentElement\r\n    \tvar left = (window.pageXOffset || doc.scrollLeft) - (doc.clientLeft || 0)\r\n    \tvar top = (window.pageYOffset || doc.scrollTop)  - (doc.clientTop || 0)\r\n    \treturn {\r\n    \t\t\"left\": left + br.left,\r\n    \t\t\"top\" : top + br.top\r\n    \t}\r\n    \t\r\n    }\r\n    d3onMouseI() {\r\n    \tvar br = this.getBoudingRect()\r\n    \td3.select('#incomes')\r\n    \t.style(\r\n    \t\t\t{\"display\": \"inline\", \"left\": -60 + br.left + \"px\", top: 150 + br.top + \"px\"}\r\n    \t)\r\n    }\r\n    \r\n    d3onMouseOutI() {\r\n    \td3.select('#incomes')\r\n    \t.style(\r\n    \t\t\t{\"display\": \"none\"}\r\n    \t)\r\n    }\r\n    \r\n    d3onMouseE() {\r\n    \tvar br = this.getBoudingRect()\r\n    \td3.select('#expences')\r\n    \t.style(\r\n    \t\t\t{\"display\": \"inline\", \"left\": br.left + 'px', top: 150 + br.top + 'px'}\r\n    \t)\r\n    }\r\n    \r\n    d3onMouseOutE() {\r\n    \td3.select('#expences')\r\n    \t.style(\r\n    \t\t\t{\"display\": \"none\"}\r\n    \t)\r\n    }\r\n    \r\n    c3onRendered() {\r\n    \t\r\n    \tvar INNER_ARC = 0\r\n    \tvar OUTER_ARC = this.lessThan700 ? this.lessThan450 ? 8 : 20 : 40\r\n   \r\n    \tvar total  = this.chart_config.sum_i - this.chart_config.sum_e\r\n    \tif( total === 0 ) return\r\n    \tvar middlepoint = (-this.chart_config.sum_e/total)*2*Math.PI\r\n\r\n\tvar arc_minus = d3.svg.arc()\r\n\t.innerRadius(INNER_ARC)\r\n\t.outerRadius(OUTER_ARC)\r\n\t.startAngle(0)\r\n\t.endAngle(middlepoint);\r\n\t\r\n\t var arc_plus = d3.svg.arc()\r\n\t.innerRadius(INNER_ARC)\r\n\t.outerRadius(OUTER_ARC)\r\n\t.startAngle(middlepoint)\r\n\t.endAngle(2*Math.PI);\r\n\t \r\n\t var arc_space = d3.svg.arc()\r\n\t.innerRadius(OUTER_ARC)\r\n\t.outerRadius(OUTER_ARC + 1)\r\n\t.startAngle(0)\r\n\t.endAngle(2*Math.PI);\r\n\t \r\n    var svg = d3.selectAll(\"#pie\").select(\".c3-chart-arcs\")\r\n    \t\r\n    svg\r\n    .append(\"svg:path\")\r\n    .attr(\"id\", \"arc-minus\")\r\n    .style(\"stroke-width\", 0)\r\n    .attr(\"d\", arc_minus)\r\n    .on({\r\n        \"click\": this.d3onMouseE,\r\n        \"mouseover\": this.d3onMouseE,\r\n        \"mouseout\": this.d3onMouseOutE\t\r\n    })\r\n \r\n     svg\r\n    .append(\"svg:path\")\r\n    .attr(\"id\", \"arc-plus\")\r\n    .style(\"stroke-width\", 0)\r\n    .attr(\"d\", arc_plus)    \r\n    .on({\r\n        \"click\": this.d3onMouseI,\r\n        \"mouseover\": this.d3onMouseI,\r\n        \"mouseout\": this.d3onMouseOutI\r\n    })\r\n    \r\n    svg\r\n    .append(\"svg:path\")\r\n    .attr(\"id\", \"arc-space\")\r\n    .style(\"stroke-width\", 0)\r\n    .attr(\"d\", arc_space)    \r\n\r\n    }\r\n    \r\n    draw() {\r\n         c3.generate(this.chart_config)\r\n    }\r\n\r\n    redraw() {\r\n    \tthis.draw()\r\n    }\r\n    \r\n    componentWillReceiveProps(nextProps) {\r\n        if (this.props.start !== nextProps.start || this.props.end !== nextProps.end) { //selected date span changed?\r\n            this.props.pieLoad(nextProps.start, nextProps.end)\r\n        } else {\r\n\r\n        \tvar colors = {}\r\n        \tvar columns = []\r\n        \tvar sum_i = 0\r\n        \tvar sum_e = 0\r\n        \tvar id = null\r\n        \t\r\n\r\n        \t\r\n        \t\r\n        \tif (nextProps.slices) {\r\n\t        \tnextProps.slices.forEach(\r\n\t        \t\t(s) => {\r\n\t        \t\t\tvar cat = findInArray(nextProps.constants['cat'], n => { return s.c === n.value})\r\n\t        \t\t\t/* var cat = nextProps.constants['cat'].find( \r\n\t\t        \t\t\tn => { return s.c == n.value}\r\n\t        \t\t\t )*/\r\n\t        \t\t\tif (s.sl<0) {\r\n\t        \t\t\t\tsum_e += s.sl\r\n\t        \t\t\t\tid = 'n' + s.c\r\n\t        \t\t\t\t//names[id] = 'nimi' + s.c\r\n\t        \t\t\t\tnames[id] = cat.label\r\n\t        \t\t\t\t//colors[id] = 'red'\r\n\t        \t\t\t\tcolors[id] = cat.color\r\n\t        \t\t\t\tcolumns.push([id, -s.sl])\r\n\t        \t\t\t}else{\r\n\t        \t\t\t\tsum_i += s.sl\r\n\t        \t\t\t\tid = 'p' + s.c\r\n\t        \t\t\t\t//names[id] = 'nimi' + s.c\r\n\t        \t\t\t\tnames[id] = cat.label\r\n\t        \t\t\t\t//colors[id] = 'green'\r\n\t        \t\t\t\tcolors[id] = cat.color\r\n\t        \t\t\t\tcolumns.push([id, s.sl])\r\n\t        \t\t\t}\r\n\t        \t\t}\r\n\t        \t)\r\n\t        \tthis.chart_config.sum_i = sum_i\r\n\t        \tthis.chart_config.sum_e = sum_e\r\n\t            this.chart_config.data.names = names\r\n\t            this.chart_config.data.colors = colors\r\n\t            this.chart_config.data.columns = columns\r\n\t            this.draw()\r\n        \t}\r\n        }\r\n    }\r\n\r\n    render() {\r\n        return (\r\n        \t<div>\r\n        \t\r\n    \t        <Media query=\"(max-width: 699px)\">\r\n    \t\t\t\t{matches => this.lessThan700 = matches }\r\n    \t\t\t</Media>\r\n     \t        <Media query=\"(max-width: 449px)\">\r\n    \t\t\t\t{matches => this.lessThan450 = matches }\r\n    \t\t\t</Media>\r\n    \t\t\t\r\n        \t<div id = \"pie\" onMouseOut = {() => this.onmouseout()} />\r\n        \t<table id=\"incomes\" className=\"c3-tooltip\" style={{display: \"none\", position: \"absolute\"}}>\r\n        \t<tbody>\r\n        \t\t<tr>\r\n        \t\t\t<td >\r\n        \t\t\t\t<span style={{backgroundColor : \"green\"}} /> Income total\r\n        \t\t\t</td>\r\n        \t\t\t<td >\r\n        \t\t\t\t{currencyFormat(this.chart_config.sum_i)}\r\n        \t\t\t</td>\r\n        \t\t</tr>\r\n        \t</tbody>\r\n        \t</table>\r\n        \t<table id=\"expences\" className=\"c3-tooltip\" style={{display: \"none\", position: \"absolute\"}}>\r\n        \t<tbody>\r\n        \t\t<tr>\r\n        \t\t\t<td >\r\n        \t\t\t\t<span style={{backgroundColor : \"red\"}} /> Expences total\r\n        \t\t\t</td>\r\n        \t\t\t<td >\r\n        \t\t\t\t{currencyFormat(this.chart_config.sum_e)}\r\n        \t\t\t</td>\r\n        \t\t</tr>\r\n        \t</tbody>\r\n        \t</table>        \t\r\n        \t</div>\r\n\r\n        )\r\n    }\r\n}\r\n\r\nPie.defaultProps = {\r\n    \tstart: initials.startDate,\r\n    \tend: initials.endDate,\r\n        slices: null\r\n}\r\nconst mapStateToProps = (store) => {\r\n    return {\r\n        start: store.daterange.s,\r\n        end: store.daterange.e,\r\n        slices: store.pie.slices,\r\n        refreshTime:  store.constants.refreshTime,\r\n        redraw: store.pie.redraw,\r\n        constants: store.constants.constants\r\n    }\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch) {\r\n    return ({\r\n        pieLoad: (s, e) => {\r\n            dispatch(pie_load(s, e))\r\n        },\r\n        categoryLoad: (c, d1, d2) => {\r\n            dispatch(category_load(c, d1, d2))\r\n        },\r\n        getConstants: (id) => {\r\n        \tget_constants(id, dispatch)\r\n        }       \r\n    })\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Pie)","import React from 'react' // ← Main React library\r\nimport { Panel } from 'react-bootstrap';\r\nimport Pie from '../pie/pie'\r\n//import Spinner from './Spinner'\r\nimport { connect } from 'react-redux'\r\n//var dateFormat = require('dateformat');\r\n\r\n//var FontAwesome = require('react-fontawesome');\r\n\r\nclass PiePanel extends React.Component{\r\n\trender(){\r\n\t\t//var dates = \" \" + dateFormat(this.props.start, \"dd.mm.yyyy ddd\") + \" - \" + dateFormat(this.props.end, \"dd.mm.yyyy ddd\")\r\n\r\n\t\treturn(\r\n\t\t\t<div>\r\n\t\t\t\t<Panel style={{ opacity: this.props.fetching ? 0.3 : 1 }} >\r\n\t\t\t\t{/*\r\n\t\t\t  \t<Panel.Heading style={{paddingTop: \"6px\", paddingBottom: \"3px\", height: \"45px\", fontSize: \"23px\"}}><FontAwesome name='pie-chart' /> <span style={{fontSize: \"15px\"}}>{dates}</span><Spinner fetching={this.props.fetching} />\r\n\t\t\t  \t</Panel.Heading> */}\r\n\t\t\t  \t\t<Panel.Body>\t\t\t\t\t\r\n\t\t\t  \t\t<Pie />\r\n\t\t\t\t</Panel.Body>\r\n\t\t\t  </Panel>\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nconst mapStateToProps = (store) => {\r\n    return {\r\n        fetching: store.pie.fetching,\r\n        start: store.daterange.s,\r\n        end: store.daterange.e\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps)(PiePanel)\r\n","import {load as loadcategories} from './categories'\r\nimport {load as loadaccounts} from './accounts'\r\nimport {load as loadauditlog} from './auditlog'\r\n\r\n\r\nconst SHOW_VIEW = 'SHOW_VIEW'\r\n\t\r\n\r\nconst naviShowViewRequestAction = (view) => ({\r\n    type: SHOW_VIEW,\r\n    payload: {\r\n    \t\"view\": view\r\n    }\r\n})\r\n\r\nconst show_view = (view) => (\r\n    (dispatch: Redux.Dispatch) => {\r\n    \tif(view === 'c') {\r\n    \t\tdispatch(loadcategories())\r\n    \t}\r\n    \tif(view === 'a') {\r\n    \t\tdispatch(loadaccounts())\r\n    \t}\r\n    \tif(view === 'l') {\r\n    \t\tdispatch(loadauditlog())\r\n    \t}\r\n        dispatch(naviShowViewRequestAction(view))\r\n    }\r\n )\r\n\r\nexport {\r\n    show_view\r\n}","import React from 'react' // ← Main React library\r\n//import { Grid, Row, Col, Tabs, Tab} from 'react-bootstrap';\r\n\r\nimport Categories from '../categories/categories'\r\nimport Accounts from '../accounts/accounts'\r\nimport Logs from '../logs/logs'\r\n\r\nimport RangePanel from './RangePanel'\r\nimport DetailsPanel from './DetailsPanel'\r\nimport ChartPanel from './ChartPanel'\r\nimport PiePanel from './PiePanel'\r\n\r\nimport { connect } from 'react-redux'\r\nimport { show_view } from '../../actions/navi'\r\nimport { chart_redraw } from '../../actions/chart'\r\nimport { pie_redraw } from '../../actions/pie'\r\nimport { minibars_redraw } from '../../actions/minibars'\r\n/*\r\n<Tabs defaultActiveKey={2} id=\"uncontrolled-tab-example\">\r\n  <Tab eventKey={1} title=\"Tab 1\">\r\n    Tab 1 content\r\n  </Tab>\r\n  <Tab eventKey={2} title=\"Tab 2\">\r\n    Tab 2 content\r\n  </Tab>\r\n  <Tab eventKey={3} title=\"Tab 3\" disabled>\r\n    Tab 3 content\r\n  </Tab>\r\n</Tabs>;\r\n*/\r\n\r\nconst Acc = () => (\r\n\t\t\t\t\t<Accounts />\r\n)\r\n\r\nconst Cat = () => (\r\n\r\n\t\t\t\t\t<Categories />\r\n)\r\n\r\nconst Log = () => (\r\n\t\t\t\t\t<Logs />\r\n)\r\n\r\nclass Content extends React.Component {\r\n\t/*constructor(props) {\r\n\t\tsuper(props)\r\n\t\tthis.handleSelect = this.handleSelect.bind(this)\r\n\t}*/\r\n\t\r\n\t/*handleSelect(key) {\r\n\t\tif(key === 1) {\r\n\t\t\t\tvar that = this\r\n\t\t\t\tvar f = () => {\r\n\t    \t\t\tthat.props.minibarsRedraw()\r\n\t    \t\t}\r\n\t\t        setTimeout(f, 0)\r\n\t\t}\r\n\t\tif(key === 2) {\r\n\t\t\t\tvar that = this\r\n\t\t\t\tvar f = () => {\r\n\t    \t\t\tthat.props.chartRedraw()\r\n\t    \t\t\tthat.props.pieRedraw()\r\n\t    \t\t}\r\n\t\t        setTimeout(f, 0)\r\n\t\t}\r\n\t}*/\r\n   \r\n\tcomponentWillReceiveProps(nextProps) {\r\n\t\tif(this.props.view !== 'main' && nextProps.view === 'main') {\r\n\t\t\t//refresh c3-views (bug in lib)\r\n\t\t\tthis.props.minibarsRedraw()\r\n\t\t\tthis.props.chartRedraw()\r\n\t    \tthis.props.pieRedraw()\r\n\t\t}\r\n\t}\r\n\trender() {\r\n\t\tvar main = \r\n\t\t\t<div>\r\n\t\t\t\t<div style={{width: '100%'}}>\r\n\t\t\t\t\t<RangePanel />\r\n\t\t\t\t</div>\r\n\t\t\t\t<div style={{width: '100%'}}>\r\n\t\t\t\t\t<div style={{width: '100%', \"display\": \"inline-flex\", \"whiteSpace\": \"nowrap\"}}>\r\n\t\t\t\t\t\t<div style={{width: '75%', paddingRight: '2px'}}>\r\n\t\t\t\t\t\t\t<ChartPanel />\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div style={{width: '25%', paddingLeft: '2px'}}>\r\n\t\t\t\t\t\t\t<PiePanel />\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<DetailsPanel />\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\treturn(\r\n\t\t\t\t<div style={{padding: '15px'}}> \r\n\t\t\t\t\t<div style={{display : (this.props.view === 'main') ? '' : 'none'}}>\r\n\t\t\t\t\t\t\t{main}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div style={{display : (this.props.view === 'a') ? '' : 'none'}}>\r\n\t\t\t\t\t\t\t<Acc />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div style={{display : (this.props.view === 'c') ? '' : 'none'}}>\r\n\t\t\t\t\t\t\t<Cat /> \r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div style={{display : (this.props.view === 'l') ? '' : 'none'}}>\r\n\t\t\t\t\t\t\t<Log /> \r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nContent.defaultProps = {\r\n\t\tview: 'main'\r\n}\r\n\r\nconst mapStateToProps = (store) => {\r\n    return {\r\n        view: store.navi.view\r\n    }\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch) {\r\n    return ({\r\n        showView: (view) => {\r\n            dispatch(show_view(view))\r\n        },\r\n        chartRedraw: () => {\r\n            dispatch(chart_redraw())\r\n        },\r\n        pieRedraw: () => {\r\n            dispatch(pie_redraw())\r\n        },\r\n        minibarsRedraw: () => {\r\n            dispatch(minibars_redraw())\r\n        }\r\n    })\r\n}\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Content)\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\r\n","import React from 'react'\r\nimport { Alert, Button } from 'react-bootstrap'\r\nimport { connect } from 'react-redux'\r\n\r\nclass ErrorMessage extends React.Component {\r\n    constructor(props) {\r\n        super(props)\r\n\r\n        this.dismiss = this.dismiss.bind(this)\r\n        this.show = this.show.bind(this)\r\n\r\n        this.state = {\r\n            show: false\r\n        }\r\n    }\r\n\r\n    dismiss() {\r\n        this.setState({ show: false })\r\n    }\r\n\r\n    show() {\r\n        this.setState({ show: true })\r\n    }\r\n\r\n    componentWillReceiveProps(nextProps) {\r\n        if (nextProps.when !== this.props.when) {\r\n            this.show()\r\n        }\r\n    }\r\n\r\n    render() {\r\n\r\n        if (!this.state.show) return null;\r\n\r\n        const { status, msg } = this.props\r\n        return (\r\n\r\n       <Alert bsStyle=\"danger\" onDismiss={this.dismiss}>\r\n\t\t    <h4>We've got an error!</h4>\r\n\t\t    Server returned:\r\n\t\t    <ul>\r\n\t\t        <li>Status: {status}</li>\r\n\t\t        <li>Message: {msg}</li>\r\n\t\t    </ul>\r\n\t\t    <hr />\r\n\t\t    <p>\r\n\t        \t<Button onClick={this.dismiss}>Close</Button>\r\n\t        </p>\r\n\t\t</Alert>\r\n\t\t)\r\n    }\r\n\r\n}\r\n\r\nErrorMessage.defaultProps = {\r\n    when: 0\r\n}\r\n\r\nconst mapStateToProps = (store) => {\r\n    return {\r\n        status: store.errorMessage.status,\r\n        msg: store.errorMessage.msg,\r\n        when: store.errorMessage.when\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps)(ErrorMessage)","import axios from 'axios'\r\n\r\nconst VERSIONINFO_REQUEST = 'VERSIONINFO_REQUEST'\r\nconst VersionInfoRequestAction = () => {\r\n    return {\r\n        type: VERSIONINFO_REQUEST\r\n    }\r\n}\r\n\r\nconst VERSIONINFO_RESPONSE = 'VERSIONINFO_RESPONSE'\r\nconst VersionInfoResponseAction = (version) => {\r\n    return {\r\n        type: VERSIONINFO_RESPONSE,\r\n        payload: {\r\n            'version': version\r\n        }\r\n    }\r\n}\r\n\r\nconst versionInfo = () => (\r\n    (dispatch) => {\r\n        dispatch(VersionInfoRequestAction())\r\n        axios.get('http://localhost:8080/version?ts='+Date.now(), {\r\n                port: 8080\r\n            })\r\n            .then(function(response) {\r\n                dispatch(VersionInfoResponseAction(response.data))\r\n            })\r\n            .catch(function(error) {\r\n\t\t\t\tdispatch(VersionInfoResponseAction('Unavailable'))\r\n            }\r\n        )\r\n    }\r\n )\r\n\r\n export {\r\n    versionInfo\r\n}","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { connect } from 'react-redux'\r\nimport { versionInfo } from '../../actions/versionInfo'\r\n\r\nclass VersionInfo extends React.Component {\r\n    constructor(props) {\r\n        super(props)\r\n        this.props.versionInfo()\r\n    }\r\n  \r\n    render() {\r\n\t    return (\r\n\t      <div >\r\n\t      \t{this.props.version}\r\n\t      </div>\r\n\t    );\r\n    }\r\n}\r\n\r\nconst mapStateToProps = (store) => {\r\n    return {\r\n        version: store.versionInfo.version\r\n    }\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch) {\r\n    return ({\r\n        \"versionInfo\": () => {\r\n            dispatch(versionInfo())\r\n        }\r\n    })\r\n}\r\n\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(VersionInfo)\r\n","import React from 'react'\r\nimport { connect } from 'react-redux'\r\nimport { Button, Modal, FormGroup, FormControl, InputGroup} from 'react-bootstrap';\r\nimport LogEntry from '../logs/logEntry'\r\nimport './style.css'\r\nimport AlertContainer from 'react-alert'\r\nimport alertOptions from '../../util/alertoptions'\r\nclass GroupId extends React.Component {\r\n\r\n\tconstructor(props) {\r\n        super(props)\r\n        this.generatedOk = this.generatedOk.bind(this)\r\n        this.copy = this.copy.bind(this)\r\n\t}\r\n\r\n    copy() {\r\n        var copyText = document.getElementById(\"groupid\");\r\n             copyText.select();\r\n             copyText.setSelectionRange(0, 99999)\r\n             document.execCommand(\"copy\");\r\n    }\r\n\r\n    generatedOk() {\r\n        this.msg.show('COPIED ON CLIPBOARD', {\r\n          time: 2000,\r\n          type: 'success',\r\n          icon: <img src=\"yes.png\" alt=\"save ok\" />\r\n        })\r\n    }\r\n\r\n  render() {\r\n    var {show, onHide} = {...this.props}\r\n\tvar props = {show, onHide}\r\n\treturn (\r\n\t<div>\r\n\t    <AlertContainer ref={a => this.msg = a} {...alertOptions} />\r\n      <Modal\r\n        {...props}\r\n        size=\"lg\"\r\n        aria-labelledby=\"contained-modal-title-vcenter\"\r\n        centered=\"true\"\r\n        dialogClassName=\"modal-20w\"\r\n      >\r\n        <Modal.Header closeButton>\r\n          <Modal.Title id=\"contained-modal-title-vcenter\">\r\n            Unused group-id\r\n          </Modal.Title>\r\n        </Modal.Header>\r\n        <Modal.Body>\r\n          <FormGroup>\r\n            <InputGroup>\r\n              <FormControl type=\"text\" defaultValue={this.props.g} id=\"groupid\"></FormControl>\r\n                <InputGroup.Button>\r\n                  <Button onClick={() => {this.copy(); this.props.onHide(); this.generatedOk(); }} >Copy</Button>\r\n                </InputGroup.Button>\r\n            </InputGroup>\r\n          </FormGroup>\r\n\r\n        </Modal.Body>\r\n        <Modal.Footer>\r\n          <Button onClick={this.props.onHide} bsStyle=\"primary\">Close</Button>\r\n        </Modal.Footer>\r\n      </Modal>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (store) => {\r\n    return {\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps)(GroupId)","import {axios_get} from './axios';\r\n\t\r\nconst NEW_GROUP_REQUEST = 'NEW_GROUP_REQUEST'\r\nconst newGroupRequestAction = () => ({\r\n    type: NEW_GROUP_REQUEST\r\n})\r\n\r\nconst NEW_GROUP_RESPONSE = 'NEW_GROUP_RESPONSE'\r\nconst newGroupResponseAction = (g) => ({\r\n    type: NEW_GROUP_RESPONSE,\r\n    payload: {\r\n        \"g\": g\r\n    }\r\n})\r\n\r\n const new_group = () => (\r\n    (dispatch) => {\r\n        dispatch(newGroupRequestAction())\r\n        axios_get('group/newid',\r\n            null,\r\n            response => {\r\n               dispatch(newGroupResponseAction(response.data))\r\n            },\r\n            dispatch\r\n        )\r\n    }\r\n )\r\n \r\nexport {\r\n    new_group\r\n}","import React from 'react';\r\nimport { Navbar, /*NavItem,*/ Nav, NavDropdown, MenuItem} from 'react-bootstrap';\r\nimport { connect } from 'react-redux'\r\nimport VersionInfo from '../versionInfo/versionInfo'\r\nimport GroupId from '../groupid/GroupId';\r\nimport AlertContainer from 'react-alert'\r\nimport alertOptions from '../../util/alertoptions'\r\n\r\nimport { show_view } from '../../actions/navi'\r\nimport { new_group } from '../../actions/group'\r\n\r\nconst copy = require('clipboard-copy')\r\n\r\n\r\nclass MenuBar extends React.Component{\r\n\tconstructor(props) {\r\n        super(props)\r\n        //this.generatedOk = this.generatedOk.bind(this)\r\n        this.generateGroup = this.generateGroup.bind(this)\r\n        this.showGropId = this.showGropId.bind(this)\r\n        this.state = {groupIdShow: false}\r\n\t}\r\n\t\r\n\t/*generatedOk(g) {\r\n\t\tthis.msg.show('NEW GROUPID ON CLIPBOARD', {\r\n\t      time: 2000,\r\n\t      type: 'success',\r\n\t      icon: <img src=\"yes.png\" alt=\"save ok\" />\r\n\t    })\r\n\t }*/\r\n\t\r\n\tgenerateGroup(){\r\n\t\tthis.props.newGroup()\r\n\t}\r\n\t\r\n\tcomponentWillReceiveProps(nextprops) {\r\n\t\tif( nextprops.g !== this.props.g) {\r\n\t\t\t//copy(nextprops.g)\r\n\t\t\tthis.showGropId()\r\n\t\t\t//this.generatedOk(nextprops.g)\r\n\t\t}\r\n\t}\r\n\r\n\tshowGropId() {\r\n    \t\tthis.setState({ groupIdShow: true })\r\n    }\r\n\r\n\trender(){\r\n\t\tlet close = () => this.setState({ groupIdShow: false });\r\n\t\treturn(\r\n\t\t\t<div>\r\n\t\t\t\t<AlertContainer ref={a => this.msg = a} {...alertOptions} />\r\n\t\t\t\t<Navbar style={{marginBottom: '0px'}}>\r\n\t\t\t\t    <Navbar.Header>\r\n\t\t\t\t        <Navbar.Brand>\r\n\t\t\t\t        \t<span style = {{\"display\": \"inline-flex\", \"whiteSpace\": \"nowrap\"}}>\r\n\t\t\t\t        \t\tOnassis&nbsp;<VersionInfo />\r\n\t\t\t\t        \t</span>\r\n\t\t\t\t        </Navbar.Brand>\r\n\t\t\t\t        <Navbar.Toggle /> \r\n\t\t\t\t    </Navbar.Header>\r\n\t\t\t\t    <Navbar.Collapse>\r\n\t\t\t\t        <Nav>\r\n\t\t\t\t            {/*<NavItem eventKey={1} href=\"#\">View</NavItem>*/}\r\n\t\t\t\t            <NavDropdown eventKey={3} title=\"View\" id=\"basic-nav-dropdown\">\r\n\t\t\t\t                <MenuItem eventKey={3.1} onSelect={(e) => {this.props.showView('main')}}>\r\n\t\t\t\t                \t{this.props.view === 'main' ? 'X' : '' } Main\r\n\t\t\t\t                </MenuItem>\r\n\t\t\t\t                <MenuItem eventKey={3.2} onSelect={(e) => {this.props.showView('c')}}>\r\n\t\t\t\t                \t{this.props.view === 'c' ? 'X' : '' } Issues\r\n\t\t\t\t                </MenuItem>\r\n\t\t\t\t                <MenuItem eventKey={3.3} onSelect={(e) => {this.props.showView('a')}}>\r\n\t\t\t\t                \t{this.props.view === 'a' ? 'X' : '' } Accounts\r\n\t\t\t\t                </MenuItem>\r\n\t\t\t\t                <MenuItem divider />\r\n\t\t\t\t                <MenuItem eventKey={3.4} onSelect={(e) => {this.props.showView('l')}}>\r\n\t\t\t\t                \t{this.props.view === 'l' ? 'X' : '' } Logs\r\n\t\t\t\t                </MenuItem>\r\n\t\t\t\t                \t{/*\r\n\t\t\t\t                <MenuItem divider />\r\n\t\t\t\t                <MenuItem eventKey={3.5}> Settings </MenuItem>*/}\r\n\t\t\t\t            </NavDropdown>\r\n\r\n\t\t\t\t            <NavDropdown eventKey={4} title=\"Util\" id=\"basic-nav-dropdown\">\r\n\t\t\t\t                <MenuItem eventKey={4.1} onSelect={(e) => {this.generateGroup()}}>\r\n\t\t\t\t                \t Generate unused groupid\r\n\t\t\t\t                </MenuItem>\r\n\t\t\t\t            </NavDropdown>\r\n\r\n\t\t\t\t        </Nav>\r\n\t\t\t\t        {/*\r\n\t\t\t\t        <Nav pullRight>\r\n\t\t\t\t            <NavItem eventKey={2} href=\"#\"> Logout </NavItem>\r\n\t\t\t\t        </Nav>*/}\r\n\t\t\t\t    </Navbar.Collapse>\r\n\t\t\t\t</Navbar>\r\n                <GroupId\r\n                    g={this.props.g}\r\n                    show={this.state.groupIdShow}\r\n                    onHide={close}\r\n                />\r\n\t\t\t</div>\r\n\r\n\t\t)\r\n\t}\r\n}\r\n\r\nMenuBar.defaultProps = {\r\n\t\tview: 'main'\r\n}\r\n\r\nconst mapStateToProps = (store) => {\r\n    return {\r\n        view: store.navi.view,\r\n        g: store.group.g\r\n    }\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch) {\r\n    return ({\r\n        showView: (view) => {\r\n            dispatch(show_view(view))\r\n        },\r\n        newGroup: () => {\r\n            dispatch(new_group())\r\n        }\r\n    })\r\n}\r\nexport default connect(mapStateToProps, mapDispatchToProps)(MenuBar)","import axios from 'axios'\r\n\r\nconst PING_REQUEST = 'PING_REQUEST'\r\nconst PingRequestAction = () => {\r\n    return {\r\n        type: PING_REQUEST\r\n    }\r\n}\r\n\r\nconst PING_RESPONSE = 'PING_RESPONSE'\r\nconst PingResponseAction = (status) => {\r\n    return {\r\n        type: PING_RESPONSE,\r\n        payload: {\r\n            up: status\r\n        }\r\n    }\r\n}\r\n\r\nconst ping = () => (\r\n    (dispatch) => {\r\n        dispatch(PingRequestAction())\r\n        axios.get('http://localhost:8080/ping?ts='+Date.now(), {\r\n                port: 8080\r\n            })\r\n            .then(function(response) {\r\n                dispatch(PingResponseAction(true))\r\n            })\r\n            .catch(function(error) {\r\n\t\t\t\tdispatch(PingResponseAction(false))\r\n            }\r\n        )\r\n    }\r\n )\r\n\r\nconst noping = () => (\r\n    (dispatch) => {\r\n\t\t\t\tdispatch(PingResponseAction(false))\r\n    }\r\n )\r\n\r\n    \r\n\r\n export {\r\n    ping,\r\n    noping\r\n}","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { connect } from 'react-redux'\r\nimport { ping } from '../../actions/ping'\r\n\r\nclass Ping extends React.Component {\r\n    constructor(props) {\r\n        super(props)\r\n        this.timer = null\r\n    }\r\n    \r\n    componentDidMount() {\r\n        var f = () => {\r\n        \tthis.props.ping()\r\n        }\r\n        this.timer = setInterval(f, 5000)\r\n    }\r\n  \r\n    render() {\r\n    // Render nothing if the \"show\" prop is false\r\n    if(!this.props.show) {\r\n      return null;\r\n    }\r\n\r\n    // The gray background\r\n    const backdropStyle = {\r\n      position: 'fixed',\r\n      top: 0,\r\n      bottom: 0,\r\n      left: 0,\r\n      right: 0,\r\n      backgroundColor: 'rgba(0,0,0,0.3)',\r\n      padding: 50,\r\n      zIndex: 1000\r\n    };\r\n\r\n    // The modal \"window\"\r\n    const modalStyle = {\r\n      backgroundColor: '#fff',\r\n      borderRadius: 5,\r\n      maxWidth: 500,\r\n      minHeight: 300,\r\n      margin: '0 auto',\r\n      padding: 30\r\n    };\r\n\r\n    return (\r\n      <div style={backdropStyle} >\r\n        <div style={modalStyle} >\r\n        \tWaiting for service to be available...\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nPing.defaultProps = {\r\n\t\tshow: false\r\n}\r\n\r\nPing.propTypes = {\r\n  show: PropTypes.bool\r\n}\r\n\r\nconst mapStateToProps = (store) => {\r\n    return {\r\n        show: (store.ping.length === 0 ? false : !store.ping.up)\r\n    }\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch) {\r\n    return ({\r\n        \"ping\": () => {\r\n            dispatch(ping())\r\n        }\r\n    })\r\n}\r\n\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Ping)\r\n","import React from 'react' // ← Main React library\r\nimport KeyboardEventHandler from 'react-keyboard-event-handler';\r\nimport Content from './Content'\r\nimport ErrorMessage from './ErrorMessage'\r\nimport MenuBar from '../navi/MenuBar'\r\nimport Ping from '../ping/ping'\r\nimport { connect } from 'react-redux'\r\nimport { today, prev_day, next_day } from '../../actions/day'\r\nimport { daterange_prev_block, daterange_next_block } from '../../actions/daterange'\r\n\r\n//CHG-10 import { set_daterange } from '../../actions/daterange'\r\n\r\nconst Keydetect = (props) => (<div>\r\n  <KeyboardEventHandler\r\n    handleKeys={['shift+left', 'left', 'shift+right', 'right']}\r\n    onKeyEvent={(key, e) => {\r\n        switch(key) {\r\n            case 'shift+left' : props.daterange_prev_block(); break;\r\n            case 'left' : props.prev_day(); break;\r\n            case 'shift+right' : props.daterange_next_block(); break;\r\n            case 'right' : props.next_day(); break;\r\n        }\r\n        }}\r\n    />\r\n</div>);\r\n\r\nclass Onassis extends React.Component{\r\n\tcomponentDidMount() {\r\n\t\t//this.props.setDateRange(addDays(new Date(),-10), addDays(new Date(),+10))\r\n\t\tthis.props.today()\r\n\t}\r\n\r\n\trender(){\r\n\t    return (\r\n\t    \t<div>\r\n\t    \t <Keydetect\r\n\t    \t    daterange_prev_block={this.props.daterange_prev_block}\r\n\t    \t    daterange_next_block={this.props.daterange_next_block}\r\n\t    \t    prev_day={this.props.prev_day}\r\n\t    \t    next_day={this.props.next_day}/>\r\n\t    \t <Ping />\r\n\t    \t <MenuBar />\r\n\t    \t <ErrorMessage />\r\n\t    \t <Content /> \r\n\t\t\t {/*\r\n\t\t\t\t<FooterInstance />\r\n\t\t\t*/}\r\n\t\t</div>\r\n\t    )\r\n    }\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch) {\r\n    return ({\r\n        today: () => {\r\n            dispatch(today())\r\n        },\r\n        prev_day: () => {\r\n            dispatch(prev_day())\r\n        },\r\n        next_day: () => {\r\n            dispatch(next_day())\r\n        },\r\n        daterange_prev_block: () => {\r\n                    dispatch(daterange_prev_block())\r\n                },\r\n        daterange_next_block: () => {\r\n            dispatch(daterange_next_block())\r\n        },\r\n        /* //CHG-10 ,\r\n        setDateRange: (start, end) => {\r\n            dispatch(set_daterange(start, end))\r\n        }*/\r\n    })\r\n}\r\n\r\nexport default connect(null, mapDispatchToProps)(Onassis)\r\n","import React from 'react' // ← Main React library\r\nimport { render } from 'react-dom' // ← Main react library\r\nimport { Provider } from 'react-redux' //← Bridge React and Redux\r\nimport { createStore, applyMiddleware } from 'redux' // ← Main Redux library\r\nimport thunk from 'redux-thunk'\r\n\r\n//import { MediaQueryProvider } from 'react-media-query-hoc';\r\n\r\n\r\n//import ReduxFormTutorial from './reduxFormTut'\r\n//import ExamplePage from './components/exampleForm3/ExamplePage'\r\n//import FormPage from './components/editpayments/FormPage'\r\n//import AddPage from './components/payments/add/AddPage'\r\n\r\nimport rootReducer from './reducers'\r\nimport Onassis  from './components/main/Onassis'\r\nimport { composeWithDevTools } from 'redux-devtools-extension';\r\n\r\nconst middleware = [\r\n  thunk,\r\n];\r\n\r\nconst store = createStore(rootReducer, composeWithDevTools(\r\n  applyMiddleware(...middleware),\r\n  // other store enhancers if any:\r\n  //window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__()\r\n));\r\n\r\n\r\n\r\n\r\n//var FontAwesome = require('react-fontawesome');\r\n//import AddOne from './AddOne'\r\n//import ContactPageContainer from './ContactPageContainer'\r\n//import './index.css';\r\n//var jquery = require('jquery')\r\n\r\n\r\n//var store = createStore(rootReducer)\r\n//var store = createStore(rootReducer,\r\n\t//\tapplyMiddleware(thunk)\r\n    //,\r\n    //window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__())\r\n\t\t//,\t\twindow.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__())\r\n\r\n\r\nwindow.reduxStore = store\r\n\r\n/*\r\nrender(\r\n\t\t <MediaQueryProvider>\r\n\t\t \t<Provider store={store}>\r\n\t\t\t\t<Onassis />\t\r\n\t\t\t</Provider>\r\n\t\t </MediaQueryProvider>,\r\n  document.getElementById('root')\r\n);*/\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\r\nrender(\r\n\t\t \t<Provider store={store}>\r\n\t\t\t\t<Onassis />\t\r\n\t\t\t</Provider>,\r\n  document.getElementById('root')\r\n);\r\n"],"sourceRoot":""}