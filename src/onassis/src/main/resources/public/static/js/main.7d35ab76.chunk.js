(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{139:function(e,t,n){},237:function(e,t,n){e.exports=n(595)},271:function(e,t,n){},457:function(e,t,n){},519:function(e,t,n){},521:function(e,t,n){},524:function(e,t){var n={convert:function(e){return e.constructor===Date?e:e.constructor===Array?new Date(e[0],e[1],e[2]):e.constructor===Number?new Date(e):e.constructor===String?new Date(e):"object"===typeof e?new Date(e.year,e.month,e.date):NaN},compare:function(e,t){return isFinite(e=this.convert(e).valueOf())&&isFinite(t=this.convert(t).valueOf())?(e>t)-(e<t):NaN},inRange:function(e,t,n){return isFinite(e=this.convert(e).valueOf())&&isFinite(t=this.convert(t).valueOf())&&isFinite(n=this.convert(n).valueOf())?t<=e&&e<=n:NaN}};e.exports=n},545:function(e,t,n){},560:function(e,t,n){},571:function(e,t,n){},573:function(e,t,n){},576:function(e,t,n){},578:function(e,t,n){},595:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(18),s=n(13),l=n(48),c=n(226),o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"PING_RESPONSE":return Object.assign({},e,{up:t.payload.up});default:return e}},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"DATE_RANGE_SELECTED":return Object.assign({},e,{s:t.payload.s,e:t.payload.e});default:return e}},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"MINIBARS_REQUEST":return Object.assign({},e,{fetching:!0});case"MINIBARS_RESPONSE":return Object.assign({},e,{balances:t.payload.balances,fetching:!1});case"MINIBARS_REDRAW":return Object.assign({},e,{redraw:t.payload.redraw});default:return e}},h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CHART_REQUEST":return Object.assign({},e,{fetching:!0});case"CHART_RESPONSE":return Object.assign({},e,{curves:t.payload.curves,fetching:!1});case"CHART_NEXTDAY":return Object.assign({},e,{nextday:t.payload.nextday});case"CHART_PREVDAY":return Object.assign({},e,{prevday:t.payload.prevday});case"CHART_TODAY":return Object.assign({},e,{today:t.payload.today});case"CHART_REDRAW":return Object.assign({},e,{redraw:t.payload.redraw});default:return e}},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"PIE_REQUEST":return Object.assign({},e,{fetching:!0});case"PIE_RESPONSE":return Object.assign({},e,{slices:t.payload.slices,fetching:!1});case"PIE_REDRAW":return Object.assign({},e,{redraw:t.payload.redraw});default:return e}},m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"PAYMENTS_REQUEST":return Object.assign({},e,{fetching:!0});case"PAYMENTS_RESPONSE":return Object.assign({},e,{fetching:!1,queryType:t.payload.queryType,params:t.payload.params,payments:t.payload.payments,balances:t.payload.balances,historystack:t.payload.historystack});default:return e}},f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOCK_PAYMENT_RESPONSE":return Object.assign({},e,{payment:t.payload.payment});case"LOCK_PAYMENT_REQUEST":return Object.assign({},e,{lock_payment_request:t.payload.lock_payment_request,locked:t.payload.locked});case"PAYMENT_SELECTION":return Object.assign({},e,{payments:t.payload.payments});default:return e}},b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CONSTANTS_REFRESH":return Object.assign({},e,{refreshTime:t.payload.refreshTime,constants:t.payload.constants});default:return e}},y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ACCOUNTS_REQUEST":return Object.assign({},e,{fetching:!0});case"ACCOUNTS_RESPONSE":return Object.assign({},e,{fetching:!1,accounts:t.payload.accounts});default:return e}},v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CATEGORIES_REQUEST":return Object.assign({},e,{fetching:!0});case"CATEGORIES_RESPONSE":return Object.assign({},e,{fetching:!1,categories:t.payload.categories});default:return e}},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SHOW_VIEW":return Object.assign({},e,{view:t.payload.view});default:return e}},O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"AUDITLOG_REQUEST":return Object.assign({},e,{fetching:!0});case"AUDITLOG_RESPONSE":return Object.assign({},e,{fetching:!1,logentries:t.payload.logentries,firstpage:t.payload.firstpage,lastpage:t.payload.lastpage});default:return e}},E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SHOW_ERROR":return Object.assign({},e,{status:t.payload.status,msg:t.payload.msg,when:t.payload.when});default:return e}},j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"NEW_GROUP_REQUEST":return Object.assign({},e,{fetching:!0});case"NEW_GROUP_RESPONSE":return Object.assign({},e,{fetching:!1,g:t.payload.g});default:return e}},k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CALC_ADD_REQUEST":return Object.assign({},e,{p:t.payload.p,ts:Date.now()});default:return e}},C=Object(l.combineReducers)({ping:o,daterange:u,minibars:d,chart:h,pie:p,payments:m,payment:f,constants:b,accounts:y,categories:v,navi:g,auditlog:O,errorMessage:E,group:j,calculator:k}),w=n(5),x=n(6),_=n(8),R=n(7),T=n(9),S=n(604),F=n(68),N=n(21),D=n(1),P=n(160),V=n(596),A=n(69),M=n.n(A),I=function(e,t){return function(n){n(function(e,t,n){return{type:"SHOW_ERROR",payload:{status:e,msg:t,when:n}}}(e,t,Date.now()))}},L=function(e,t){e.response&&e.response.data?t(I(e.response.status,e.response.data.error_message)):t(I("not known",e.message))};var H="http://"+function(e){var t=document.createElement("a");return t.href=e,t}(document.URL).hostname+":8080/";function U(e,t){return e+"?"+(null==t?"":t+"&")+"ts="+Date.now()}function Y(e,t,n,a){var r=U(e,t);M.a.get(H+r).then(n).catch(function(e){L(e,a)})}function B(e,t,n,a){var r=U(e,null);M.a.get(H+r,t).then(n).catch(function(e){L(e,a)})}function W(e,t,n,a){M.a.post(H+e,t).then(n).catch(function(e){L(e,a)})}var z=n(265),q={},G=function(e,t){q[e]=null,Q(e,t)},Q=function(e,t){if(!q[e]){var n=z("GET",H+"constants?id="+e+"&ts="+Date.now()),a=JSON.parse(n.getBody("utf8"));q[e]=a}var r;return t((r=q,{type:"CONSTANTS_REFRESH",payload:{refreshTime:(new Date).getTime(),constants:r}})),null},K=function(e){return function(t){t(function(e){return{type:"CATEGORIES_UPDATE_REQUEST",payload:{updates:e}}}(e)),W("cat/update",e,function(e){t({type:"CATEGORIES_UPDATE_RESPONSE"}),t(J()),G("cat",t)},t)}},J=function(){return function(e){e({type:"CATEGORIES_REQUEST"}),Y("cat/list",null,function(t){e({type:"CATEGORIES_RESPONSE",payload:{categories:t.data}})},e)}},X=function(e){function t(e){var n;return Object(w.a)(this,t),(n=Object(_.a)(this,Object(R.a)(t).call(this,e))).state={currencyValue:e.value},n.onChange=n.onChange.bind(Object(D.a)(Object(D.a)(n))),n.handleFocus=n.handleFocus.bind(Object(D.a)(Object(D.a)(n))),n}return Object(T.a)(t,e),Object(x.a)(t,[{key:"handleFocus",value:function(e){e.target.select()}},{key:"onChange",value:function(e){var t=this.props,n=t.onValueChanged,a=t.field,r=t.index,i=function(e){if(!e)return e;"-"!==e&&"+"!==e||(e+="0");var t=e.lastIndexOf("+"),n=e.lastIndexOf("-");return""===(e=e.replace(/[^\d]/g,""))&&(e="0"),(e=""+parseInt(e,10)).length<3&&(e="00".slice(-3+e.length)+e),(t>=n?"+":"-")+e.slice(0,-2)+"."+e.slice(-2)}(e.target.value);this.setState({currencyValue:i}),n(i,a,r)}},{key:"componentWillReceiveProps",value:function(e){this.setState({currencyValue:e.value})}},{key:"render",value:function(){var e=this.props,t=e.id,n=e.readOnly,a=e.placeholder,i=e.touched,s=e.fontSize;return r.a.createElement("div",null,r.a.createElement("input",{onFocus:this.handleFocus,autoComplete:"off",id:t,disabled:n,value:this.state.currencyValue,onChange:this.onChange,placeholder:n?"":a,type:"text",className:"form-control",style:{fontSize:s,textAlign:"right",color:this.state.currencyValue&&"-"===this.state.currencyValue.substr(0,1)?"red":"green",display:"inline",width:"85px",backgroundColor:i?"lightyellow":""}}))}}]),t}(r.a.Component);X.defaultProps={id:null,onValueChanged:null,placeholder:"",value:"",readOnly:!1,field:null,index:null,touched:!1,fontSize:"inherit"};var Z=X,$=(n(271),function(e){function t(){return Object(w.a)(this,t),Object(_.a)(this,Object(R.a)(t).apply(this,arguments))}return Object(T.a)(t,e),Object(x.a)(t,[{key:"render",value:function(){var e=this.props,t=e.id,n=e.readOnly,a=e.field,i=e.index,s=e.onValueChanged,l=e.touched,c=e.checked;return r.a.createElement("div",null,r.a.createElement("span",{style:{display:"flex",width:"20px"}},r.a.createElement("div",null,r.a.createElement("input",{name:t,type:"checkbox",disabled:n,id:t,checked:c,onChange:function(e){return s(e.target.checked,a,i)},style:n?{backgroundColor:"lightgray",borderColor:"lightgray"}:l?{backgroundColor:"darkKhaki",borderColor:"darkKhaki"}:{}}))))}}]),t}(r.a.Component));$.defaultProps={id:null,onValueChanged:null,checked:!0,readOnly:!1,field:null,index:null,touched:!1};var ee=$,te=n(25),ne=function(e){function t(e){var n;return Object(w.a)(this,t),(n=Object(_.a)(this,Object(R.a)(t).call(this,e))).state={txtValue:e.value},n.onChange=n.onChange.bind(Object(D.a)(Object(D.a)(n))),n}return Object(T.a)(t,e),Object(x.a)(t,[{key:"onChange",value:function(e){var t=this.props,n=t.onValueChanged,a=t.field,r=t.index;this.setState({txtValue:e.target.value}),n(e.target.value,a,r)}},{key:"componentWillReceiveProps",value:function(e){this.setState({txtValue:e.value})}},{key:"render",value:function(){var e=this,t=this.props,n=t.id,a=t.placeholder,i=t.readOnly,s=t.touched,l=t.linkCb,c=t.maxLength,o=l&&this.state.txtValue&&this.state.txtValue.length>0?r.a.createElement(P.a,{bsSize:"small",onClick:function(){l(e.state.txtValue)}},r.a.createElement(te,{name:"caret-right"})):null;return r.a.createElement("div",null,r.a.createElement("span",{style:{display:"inline-flex"}},r.a.createElement("input",{maxLength:c,id:n,value:this.state.txtValue,disabled:i,style:{backgroundColor:s?"lightyellow":""},placeholder:i?"":a,type:"text",onChange:this.onChange,className:"form-control"}),o))}}]),t}(r.a.Component);ne.defaultProps={id:null,placeholder:"",onValueChanged:null,value:"",readOnly:!1,field:null,index:null,touched:!1,linkCb:null,maxLength:255};var ae=ne,re=n(15),ie=n.n(re),se=n(229),le=function(e){function t(e){var n;return Object(w.a)(this,t),(n=Object(_.a)(this,Object(R.a)(t).call(this,e))).handleClick=function(){n.props.readOnly||n.setState({displayColorPicker:!n.state.displayColorPicker})},n.handleClose=function(){n.setState({displayColorPicker:!1})},n.handleChange=function(e){var t=n.props,a=t.onValueChanged,r=t.field,i=t.index;n.setState({color:e.hex,displayColorPicker:!n.state.displayColorPicker}),a(e.hex,r,i)},n.state={displayColorPicker:!1,color:e.color},n}return Object(T.a)(t,e),Object(x.a)(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({color:e.color})}},{key:"render",value:function(){var e=ie()({default:{color:{width:"28px",height:"24px",borderRadius:"4px",background:this.state.color},swatch:{padding:"5px",background:this.props.touched?"lightyellow":"#fff",borderRadius:"4px",boxShadow:"0 0 0 1px rgba(0,0,0,"+(this.props.readOnly?"0":".1")+")",display:"inline-block",cursor:this.props.readOnly?"":"pointer"},popover:{position:"relative",zIndex:"2"},cover:{position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}}});return r.a.createElement("div",null,r.a.createElement("div",{style:e.swatch,onClick:this.handleClick},r.a.createElement("div",{style:e.color})),this.state.displayColorPicker?r.a.createElement("div",{style:e.popover},r.a.createElement("div",{style:e.cover,onClick:this.handleClose}),r.a.createElement(se.SketchPicker,{color:this.state.color,onChange:this.handleChange})):null)}}]),t}(r.a.Component);le.defaultProps={id:null,onValueChanged:null,color:"red",readOnly:!1,field:null,index:null,touched:!1};var ce=le,oe=(n(457),n(139),n(50)),ue=n.n(oe),de={offset:14,position:"bottom right",theme:"light",time:5e3,transition:"scale"};var he=function(e){return parseFloat(Math.round(100*e)/100).toFixed(2)},pe=["color","descr","i","active"],me={id:null,i:"+0.00",active:!0,descr:"",color:"blue"},fe={i:function(e){return null},active:function(e){return null},descr:function(e){return""!==e?null:"required"},color:function(e){return""!==e?null:"required"}};function be(e){var t=function(e){var t=[];return e.forEach(function(e){t.push(ge(e))}),t}(e);return t.forEach(function(e){e.i=(e.i>=0?"+":"")+he(e.i)}),t}function ye(e){return e.forEach(function(e){e.i&&(e.i=parseFloat(e.i))}),e}function ve(e){return{id:e,i:e,active:e,descr:e,color:e}}function ge(e){return{index:arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,id:e.id,i:e.i,active:e.active,descr:e.descr,color:e.color}}function Oe(e){var t={values:[],initial:[],errors:[],touched:[],deleted:[],sort:null,asc:!0};return e.forEach(function(e,n){t.values.push(ge(e,n)),t.initial.push(ge(e)),t.errors.push(ve(null)),t.touched.push(ve(!1)),t.deleted.push(!1)}),t}function Ee(e){return e.splice(0)}var je=n(25),ke=-1,Ce=function(e){function t(e){var n;return Object(w.a)(this,t),(n=Object(_.a)(this,Object(R.a)(t).call(this,e))).renderCategoriesT=function(){return n.sortedValues=n.state.values.slice(0),n.state.sort&&n.sortedValues.sort(n.sortersF()),r.a.createElement("div",null,r.a.createElement(S.a,{id:"accs-panel"},r.a.createElement(S.a.Heading,null,r.a.createElement(S.a.Title,null,r.a.createElement(P.a,{onClick:function(){return n.resetT()},disabled:n.pristine,bsStyle:n.pristine?"default":"primary"},"Reset"),r.a.createElement(P.a,{onClick:function(){return n.preSubmitT()},disabled:n.pristine||null!=n.errors,bsStyle:n.pristine?"default":"primary"},"Save"),r.a.createElement(P.a,{onClick:function(){return n.addR()}},"Add"))),r.a.createElement(S.a.Body,null,r.a.createElement(V.a,{id:"categories_table",striped:!0,bordered:!0,hover:!0,condensed:!0},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{className:n.thClassName("color")}),n.th("descr","Name"),n.th("i","Default"),n.th("active","Active"),r.a.createElement("th",{className:n.thClassName("deleted")},r.a.createElement(je,{name:"remove",style:{color:"red"}})))),r.a.createElement("tbody",null,n.sortedValues.map(function(e){return n.renderCategoryR(e.index)}))))))},n.showOk=n.showOk.bind(Object(D.a)(Object(D.a)(n))),n.changePropertyF=n.changePropertyF.bind(Object(D.a)(Object(D.a)(n))),n.changePropertyDeletedF=n.changePropertyDeletedF.bind(Object(D.a)(Object(D.a)(n))),n.setValueF=n.setValueF.bind(Object(D.a)(Object(D.a)(n))),n.validateF=n.validateF.bind(Object(D.a)(Object(D.a)(n))),n.touchedF=n.touchedF.bind(Object(D.a)(Object(D.a)(n))),n.isDifferentFromInitialF=n.isDifferentFromInitialF.bind(Object(D.a)(Object(D.a)(n))),n.chooseValueF=n.chooseValueF.bind(Object(D.a)(Object(D.a)(n))),n.renderContentF=n.renderContentF.bind(Object(D.a)(Object(D.a)(n))),n.renderDeletedContentF=n.renderDeletedContentF.bind(Object(D.a)(Object(D.a)(n))),n.setSortF=n.setSortF.bind(Object(D.a)(Object(D.a)(n))),n.sortersF=n.sortersF.bind(Object(D.a)(Object(D.a)(n))),n.addR=n.addR.bind(Object(D.a)(Object(D.a)(n))),n.getDefaultR=n.getDefaultR.bind(Object(D.a)(Object(D.a)(n))),n.removeR=n.removeR.bind(Object(D.a)(Object(D.a)(n))),n.validateR=n.validateR.bind(Object(D.a)(Object(D.a)(n))),n.readOnlyR=n.readOnlyR.bind(Object(D.a)(Object(D.a)(n))),n.isPersistedR=n.isPersistedR.bind(Object(D.a)(Object(D.a)(n))),n.renderCategoryR=n.renderCategoryR.bind(Object(D.a)(Object(D.a)(n))),n.resetT=n.resetT.bind(Object(D.a)(Object(D.a)(n))),n.isPristineT=n.isPristineT.bind(Object(D.a)(Object(D.a)(n))),n.hasErrorsT=n.hasErrorsT.bind(Object(D.a)(Object(D.a)(n))),n.preInitT=n.preInitT.bind(Object(D.a)(Object(D.a)(n))),n.preSubmitT=n.preSubmitT.bind(Object(D.a)(Object(D.a)(n))),n.init=n.init.bind(Object(D.a)(Object(D.a)(n))),n.renderCategoriesT=n.renderCategoriesT.bind(Object(D.a)(Object(D.a)(n))),n.tdClassName=n.tdClassName.bind(Object(D.a)(Object(D.a)(n))),n.td=n.td.bind(Object(D.a)(Object(D.a)(n))),n.thClassName=n.thClassName.bind(Object(D.a)(Object(D.a)(n))),n.th=n.th.bind(Object(D.a)(Object(D.a)(n))),n.init(),n.state=Object(N.a)({},Oe(n.preInitT(e.initCategories))),n}return Object(T.a)(t,e),Object(x.a)(t,[{key:"changePropertyF",value:function(e,t,n){if(this.isPersistedR(n)){var a=Ee(this.state.touched);a[n][t]=this.isDifferentFromInitialF(e,t,n),this.setState({touched:a})}this.validateF(t,e,n),this.setValueF(e,t,n)}},{key:"changePropertyDeletedF",value:function(e,t,n){if(this.isPersistedR(n)){this.deleteCount+=e?1:-1;var a=Ee(this.state.deleted);a[n]=e,this.setState({deleted:a})}else this.removeR(n)}},{key:"setValueF",value:function(e,t,n){var a=Ee(this.state.values);a[n][t]=e,this.setState({values:a})}},{key:"validateF",value:function(e,t,n){var a=this.state.errors[n][e];if(fe[e](t)!==a){var r=Ee(this.state.errors);r[n][e]=fe[e](t),this.setState({errors:r})}}},{key:"touchedF",value:function(e,t){return!(e<0)&&(!this.state.deleted[e]&&(!!this.isPersistedR(e)&&this.state.touched[e][t]))}},{key:"isDifferentFromInitialF",value:function(e,t,n){return e!==this.state.initial[n][t]}},{key:"chooseValueF",value:function(e,t){return this.state.deleted[e]?this.state.initial[e][t]:this.state.values[e][t]}},{key:"renderContentF",value:function(e,t){var n,a=this.chooseValueF(t,e);switch(e){case"i":return r.a.createElement("div",null,r.a.createElement(Z,{id:"icat_"+t,onValueChanged:this.changePropertyF,placeholder:"amount",value:a,readOnly:this.readOnlyR(t,"i"),field:"i",index:t,touched:this.touchedF(t,"i")}));case"active":return r.a.createElement("div",null,r.a.createElement(ee,{id:"activecat_"+t,onValueChanged:this.changePropertyF,checked:a,readOnly:this.isPersistedR(t)&&(n=this.state.touched[t],n.i||n.descr||n.color),field:"active",index:t,touched:this.touchedF(t,"active")}));case"descr":return r.a.createElement("div",null,r.a.createElement(ae,{id:"descrcat_"+t,onValueChanged:this.changePropertyF,value:a,readOnly:this.readOnlyR(t,"descr"),field:"descr",index:t,touched:this.touchedF(t,"descr"),placeholder:"name",maxLength:30}));case"color":return r.a.createElement("div",null,r.a.createElement(ce,{id:"colorcat_"+t,onValueChanged:this.changePropertyF,color:a,readOnly:this.readOnlyR(t,"color"),field:"color",index:t,touched:this.touchedF(t,"color")}));default:return console.log("UNKONWN field: "+e),null}}},{key:"renderDeletedContentF",value:function(e){var t=this;if(!this.isPersistedR(e))return r.a.createElement("button",{type:"button",className:"form-control",onClick:function(){return t.changePropertyDeletedF(!0,"deleted",e)}},r.a.createElement(je,{name:"remove",style:{color:"red"}}))}},{key:"setSortF",value:function(e){this.state.sort&&this.state.sort===e?this.state.sort===e&&this.state.asc?this.setState({asc:!1}):this.setState({sort:null}):this.setState({sort:e,asc:!0})}},{key:"sortersF",value:function(){var e=this,t=this.state.asc?-1:1;switch(this.state.sort){case"i":return function(n,a){return t*(e.chooseValueF(a.index,e.state.sort)-e.chooseValueF(n.index,e.state.sort))};case"descr":return function(n,a){var r=e.chooseValueF(n.index,"descr").toUpperCase(),i=e.chooseValueF(a.index,"descr").toUpperCase();return t*(r<i?-1:r>i?1:0)};case"active":return function(e,n){return t*(e.active&&n.active?0:e.active?1:-1)};default:return function(e,t){return 0}}}},{key:"addR",value:function(){var e=this.getDefaultR(),t=Ee(this.state.values);t.push(e),this.sortedValues.push(e);var n=Ee(this.state.errors);n.push(this.validateR(e)),this.setState({values:t,errors:n})}},{key:"getDefaultR",value:function(){var e=me;this.sortedValues.length&&(e=this.sortedValues[this.sortedValues.length-1]);var t=Object(N.a)({},e);return t.index=this.state.values.length,t.id=ke--,t.l=!1,t.check=!1,t}},{key:"removeR",value:function(e){this.state.values.splice(e,1);var t=Ee(this.state.values);this.state.errors.splice(e,1);for(var n=Ee(this.state.errors),a=e;a<t.length;a++)t[a].index--,n[a].index--;this.setState({values:t,errors:n})}},{key:"validateR",value:function(e){var t={};return pe.forEach(function(n){t[n]=fe[n](e[n])}),t}},{key:"readOnlyR",value:function(e,t){return this.state.deleted[e]||!this.state.values[e].active&&this.isPersistedR(e)}},{key:"isPersistedR",value:function(e){return this.state.values[e].id>=0}},{key:"renderCategoryR",value:function(e){var t=this;return r.a.createElement("tr",{key:e},Object(F.a)(pe).map(function(n){return t.td(e,n)}),r.a.createElement("td",{className:this.tdClassName(e,"deleted")},this.renderDeletedContentF(e)))}},{key:"resetT",value:function(){var e=Oe(this.state.initial);this.setState(Object(N.a)({},e)),this.init()}},{key:"isPristineT",value:function(){var e=!0;return this.state.touched.forEach(function(t){pe.forEach(function(n){e=e&&!t[n]})}),e&&this.state.initial.length===this.state.values.length&&!this.deleteCount}},{key:"hasErrorsT",value:function(){var e=!1;return this.state.errors.forEach(function(t){var n;e=e||((n=t).i||n.active||n.descr||n.color)}),e}},{key:"preInitT",value:function(e){return be(e)}},{key:"showOk",value:function(){this.msg.show("SAVED SUCCESSFULLY",{time:2e3,type:"success",icon:r.a.createElement("img",{src:"yes.png",alt:"save ok"})})}},{key:"preSubmitT",value:function(){var e=this,t=[];this.state.values.forEach(function(n,a){if(!e.isPersistedR(a)){var r={};pe.forEach(function(t){r[t]=e.chooseValueF(a,t)}),t.push(r)}});var n=[];this.state.deleted.forEach(function(t,a){t&&n.push(e.state.values[a].id)});var a=[];this.state.values.forEach(function(t,n){if(e.isPersistedR(n)){var r={};pe.forEach(function(a){e.touchedF(n,a)&&(r.id=t.id,r[a]=e.chooseValueF(n,a))}),Object.keys(r).length>0&&a.push(r)}});var r={created:ye(t),deleted:n,modified:ye(a)};console.log(JSON.stringify(r,null,4)),this.pristine=null,this.props.update(r)}},{key:"init",value:function(){this.deleteCount=0,this.pristine=null,this.errors=null,this.allChecked=!1}},{key:"tdClassName",value:function(e,t){return t+"_cell"+(this.isPersistedR(e)?"":" newRow")+(this.state.deleted[e]?" deleted":"")+(this.state.errors[e][t]?" error":"")}},{key:"td",value:function(e,t){return r.a.createElement("td",{key:e+"_"+t,className:this.tdClassName(e,t)},this.renderContentF(t,e))}},{key:"thClassName",value:function(e){return e+"_header"}},{key:"th",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=r.a.createElement(je,{name:this.state.asc?"sort-asc":"sort-desc"}),i=r.a.createElement("div",null,this.state.sort===e?a:""),s=r.a.createElement("div",{style:{marginTop:8}},r.a.createElement("button",{type:"button",className:"link-button",onClick:function(){t.setSortF(e)}},n));return r.a.createElement("th",{className:this.thClassName(e)},r.a.createElement("div",null,r.a.createElement("span",{style:{display:"flex"}},r.a.createElement("div",{style:{marginTop:8,paddingRight:3}},i),null!==n?s:"")))}},{key:"componentWillReceiveProps",value:function(e){this.isPristineT()||null!=this.pristine||this.showOk(),this.init(),this.setState(Object(N.a)({},Oe(this.preInitT(e.initCategories))))}},{key:"render",value:function(){var e=this;return this.pristine=this.isPristineT(),this.errors=this.hasErrorsT(),r.a.createElement("div",null,r.a.createElement(ue.a,Object.assign({ref:function(t){return e.msg=t}},de)),this.renderCategoriesT())}}]),t}(r.a.Component);Ce.defaultProps={initCategories:[]};var we=Object(s.b)(null,function(e){return{update:function(t){e(K(t))}}})(Ce),xe=function(e){function t(){return Object(w.a)(this,t),Object(_.a)(this,Object(R.a)(t).apply(this,arguments))}return Object(T.a)(t,e),Object(x.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(S.a,null,r.a.createElement(S.a.Heading,{style:{paddingTop:"4px",paddingBottom:"3px",height:"45px",fontSize:"23px"}},r.a.createElement("span",{style:{display:"flow-root",alignItems:"center"}},"Categories")),r.a.createElement(S.a.Body,null,r.a.createElement(we,{initCategories:this.props.categories}))))}}]),t}(r.a.Component),_e=Object(s.b)(function(e){return{categories:e.categories.categories}})(xe),Re=n(32),Te=function(e,t){return{type:"CHART_REQUEST",payload:{s:e,e:t}}},Se=function(e){return{type:"CHART_RESPONSE",payload:{curves:e}}},Fe=null;function Ne(e){e(Te(Fe.s,Fe.e)),B("chart",{params:Fe},function(t){e(Se(t.data))},e)}var De=function(e,t){return function(n){Fe={s:Re(e,"yyyy-mm-dd"),e:Re(t,"yyyy-mm-dd")},Ne(n)}},Pe=function(){return function(e){console.assert(Fe),Ne(e)}},Ve=function(){return function(e){e({type:"CHART_NEXTDAY",payload:{nextday:(new Date).getTime()}})}},Ae=function(){return function(e){e({type:"CHART_PREVDAY",payload:{prevday:(new Date).getTime()}})}},Me=function(){return function(e){e({type:"CHART_TODAY",payload:{today:(new Date).getTime()}})}},Ie=function(){return function(e){e({type:"CHART_REDRAW",payload:{redraw:(new Date).getTime()}})}},Le=function(e){return function(t){t(function(e){return{type:"ACCOUNTS_UPDATE_REQUEST",payload:{updates:e}}}(e)),W("acc/update",e,function(e){t({type:"ACCOUNTS_UPDATE_RESPONSE"}),t(He()),G("acc",t),t(Pe())},t)}},He=function(){return function(e){e({type:"ACCOUNTS_REQUEST"}),Y("acc/list",null,function(t){e({type:"ACCOUNTS_RESPONSE",payload:{accounts:t.data}})},e)}},Ue=(n(519),["color","descr","credit","active"]),Ye={id:null,credit:!1,active:!0,descr:"",color:"blue"},Be={credit:function(e){return null},active:function(e){return null},descr:function(e){return""!==e?null:"required"},color:function(e){return""!==e?null:"required"}};function We(e){return function(e){var t=[];return e.forEach(function(e){t.push(Ge(e))}),t}(e)}function ze(e){return e}function qe(e){return{id:e,credit:e,active:e,descr:e,color:e}}function Ge(e){return{index:arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,id:e.id,credit:e.credit,active:e.active,descr:e.descr,color:e.color}}function Qe(e){var t={values:[],initial:[],errors:[],touched:[],deleted:[],sort:null,asc:!0};return e.forEach(function(e,n){t.values.push(Ge(e,n)),t.initial.push(Ge(e)),t.errors.push(qe(null)),t.touched.push(qe(!1)),t.deleted.push(!1)}),t}function Ke(e){return e.splice(0)}var Je=n(25),Xe=-1,Ze=function(e){function t(e){var n;return Object(w.a)(this,t),(n=Object(_.a)(this,Object(R.a)(t).call(this,e))).renderAccountsT=function(){return n.sortedValues=n.state.values.slice(0),n.state.sort&&n.sortedValues.sort(n.sortersF()),r.a.createElement("div",null,r.a.createElement(S.a,{id:"accs-panel"},r.a.createElement(S.a.Heading,null,r.a.createElement(S.a.Title,null,r.a.createElement(P.a,{onClick:function(){return n.resetT()},disabled:n.pristine,bsStyle:n.pristine?"default":"primary"},"Reset"),r.a.createElement(P.a,{onClick:function(){return n.preSubmitT()},disabled:n.pristine||null!=n.errors,bsStyle:n.pristine?"default":"primary"},"Save"),r.a.createElement(P.a,{onClick:function(){return n.addR()}},"Add"))),r.a.createElement(S.a.Body,null,r.a.createElement(V.a,{id:"accounts_table",striped:!0,bordered:!0,hover:!0,condensed:!0},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{className:n.thClassName("color")}),n.th("descr","Name"),n.th("credit","Credit"),n.th("active","Active"),r.a.createElement("th",{className:n.thClassName("deleted")},r.a.createElement(Je,{name:"remove",style:{color:"red"}})))),r.a.createElement("tbody",null,n.sortedValues.map(function(e){return n.renderAccountR(e.index)}))))))},n.showOk=n.showOk.bind(Object(D.a)(Object(D.a)(n))),n.changePropertyF=n.changePropertyF.bind(Object(D.a)(Object(D.a)(n))),n.changePropertyDeletedF=n.changePropertyDeletedF.bind(Object(D.a)(Object(D.a)(n))),n.setValueF=n.setValueF.bind(Object(D.a)(Object(D.a)(n))),n.validateF=n.validateF.bind(Object(D.a)(Object(D.a)(n))),n.touchedF=n.touchedF.bind(Object(D.a)(Object(D.a)(n))),n.isDifferentFromInitialF=n.isDifferentFromInitialF.bind(Object(D.a)(Object(D.a)(n))),n.chooseValueF=n.chooseValueF.bind(Object(D.a)(Object(D.a)(n))),n.renderContentF=n.renderContentF.bind(Object(D.a)(Object(D.a)(n))),n.renderDeletedContentF=n.renderDeletedContentF.bind(Object(D.a)(Object(D.a)(n))),n.setSortF=n.setSortF.bind(Object(D.a)(Object(D.a)(n))),n.sortersF=n.sortersF.bind(Object(D.a)(Object(D.a)(n))),n.addR=n.addR.bind(Object(D.a)(Object(D.a)(n))),n.getDefaultR=n.getDefaultR.bind(Object(D.a)(Object(D.a)(n))),n.removeR=n.removeR.bind(Object(D.a)(Object(D.a)(n))),n.validateR=n.validateR.bind(Object(D.a)(Object(D.a)(n))),n.readOnlyR=n.readOnlyR.bind(Object(D.a)(Object(D.a)(n))),n.isPersistedR=n.isPersistedR.bind(Object(D.a)(Object(D.a)(n))),n.renderAccountR=n.renderAccountR.bind(Object(D.a)(Object(D.a)(n))),n.resetT=n.resetT.bind(Object(D.a)(Object(D.a)(n))),n.isPristineT=n.isPristineT.bind(Object(D.a)(Object(D.a)(n))),n.hasErrorsT=n.hasErrorsT.bind(Object(D.a)(Object(D.a)(n))),n.preInitT=n.preInitT.bind(Object(D.a)(Object(D.a)(n))),n.preSubmitT=n.preSubmitT.bind(Object(D.a)(Object(D.a)(n))),n.init=n.init.bind(Object(D.a)(Object(D.a)(n))),n.renderAccountsT=n.renderAccountsT.bind(Object(D.a)(Object(D.a)(n))),n.tdClassName=n.tdClassName.bind(Object(D.a)(Object(D.a)(n))),n.td=n.td.bind(Object(D.a)(Object(D.a)(n))),n.thClassName=n.thClassName.bind(Object(D.a)(Object(D.a)(n))),n.th=n.th.bind(Object(D.a)(Object(D.a)(n))),n.init(),n.state=Object(N.a)({},Qe(n.preInitT(e.initAccounts))),n}return Object(T.a)(t,e),Object(x.a)(t,[{key:"changePropertyF",value:function(e,t,n){if(this.isPersistedR(n)){var a=Ke(this.state.touched);a[n][t]=this.isDifferentFromInitialF(e,t,n),this.setState({touched:a})}this.validateF(t,e,n),this.setValueF(e,t,n)}},{key:"changePropertyDeletedF",value:function(e,t,n){if(this.isPersistedR(n)){this.deleteCount+=e?1:-1;var a=Ke(this.state.deleted);a[n]=e,this.setState({deleted:a})}else this.removeR(n)}},{key:"setValueF",value:function(e,t,n){var a=Ke(this.state.values);a[n][t]=e,this.setState({values:a})}},{key:"validateF",value:function(e,t,n){var a=this.state.errors[n][e];if(Be[e](t)!==a){var r=Ke(this.state.errors);r[n][e]=Be[e](t),this.setState({errors:r})}}},{key:"touchedF",value:function(e,t){return!(e<0)&&(!this.state.deleted[e]&&(!!this.isPersistedR(e)&&this.state.touched[e][t]))}},{key:"isDifferentFromInitialF",value:function(e,t,n){return e!==this.state.initial[n][t]}},{key:"chooseValueF",value:function(e,t){return this.state.deleted[e]?this.state.initial[e][t]:this.state.values[e][t]}},{key:"renderContentF",value:function(e,t){var n,a=this.chooseValueF(t,e);switch(e){case"credit":return r.a.createElement("div",null,r.a.createElement(ee,{id:"creditacc_"+t,onValueChanged:this.changePropertyF,checked:a,readOnly:this.readOnlyR(t,"credit"),field:"credit",index:t,touched:this.touchedF(t,"credit")}));case"active":return r.a.createElement("div",null,r.a.createElement(ee,{id:"activeacc_"+t,onValueChanged:this.changePropertyF,checked:a,readOnly:this.isPersistedR(t)&&(n=this.state.touched[t],n.credit||n.descr||n.color),field:"active",index:t,touched:this.touchedF(t,"active")}));case"descr":return r.a.createElement("div",null,r.a.createElement(ae,{id:"descracc_"+t,onValueChanged:this.changePropertyF,value:a,readOnly:this.readOnlyR(t,"descr"),field:"descr",index:t,touched:this.touchedF(t,"descr"),placeholder:"name",maxLength:30}));case"color":return r.a.createElement("div",null,r.a.createElement(ce,{id:"coloracc_"+t,onValueChanged:this.changePropertyF,color:a,readOnly:this.readOnlyR(t,"color"),field:"color",index:t,touched:this.touchedF(t,"color")}));default:return console.log("UNKONWN field: "+e),null}}},{key:"renderDeletedContentF",value:function(e){var t=this;if(!this.isPersistedR(e))return r.a.createElement("button",{type:"button",className:"form-control",onClick:function(){return t.changePropertyDeletedF(!0,"deleted",e)}},r.a.createElement(Je,{name:"remove",style:{color:"red"}}))}},{key:"setSortF",value:function(e){this.state.sort&&this.state.sort===e?this.state.sort===e&&this.state.asc?this.setState({asc:!1}):this.setState({sort:null}):this.setState({sort:e,asc:!0})}},{key:"sortersF",value:function(){var e=this,t=this.state.asc?-1:1;switch(this.state.sort){case"i":return function(n,a){return t*(e.chooseValueF(a.index,e.state.sort)-e.chooseValueF(n.index,e.state.sort))};case"descr":return function(n,a){var r=e.chooseValueF(n.index,"descr").toUpperCase(),i=e.chooseValueF(a.index,"descr").toUpperCase();return t*(r<i?-1:r>i?1:0)};case"credit":return function(e,n){return t*(e.credit&&n.credit?0:e.credit?1:-1)};case"active":return function(e,n){return t*(e.active&&n.active?0:e.active?1:-1)};default:return function(e,t){return 0}}}},{key:"addR",value:function(){var e=this.getDefaultR(),t=Ke(this.state.values);t.push(e),this.sortedValues.push(e);var n=Ke(this.state.errors);n.push(this.validateR(e)),this.setState({values:t,errors:n})}},{key:"getDefaultR",value:function(){var e=Ye;this.sortedValues.length&&(e=this.sortedValues[this.sortedValues.length-1]);var t=Object(N.a)({},e);return t.index=this.state.values.length,t.id=Xe--,t.l=!1,t.check=!1,t}},{key:"removeR",value:function(e){this.state.values.splice(e,1);var t=Ke(this.state.values);this.state.errors.splice(e,1);for(var n=Ke(this.state.errors),a=e;a<t.length;a++)t[a].index--,n[a].index--;this.setState({values:t,errors:n})}},{key:"validateR",value:function(e){var t={};return Ue.forEach(function(n){t[n]=Be[n](e[n])}),t}},{key:"readOnlyR",value:function(e,t){return this.state.deleted[e]||!this.state.values[e].active&&this.isPersistedR(e)}},{key:"isPersistedR",value:function(e){return this.state.values[e].id>=0}},{key:"renderAccountR",value:function(e){var t=this;return r.a.createElement("tr",{key:e},Object(F.a)(Ue).map(function(n){return t.td(e,n)}),r.a.createElement("td",{className:this.tdClassName(e,"deleted")},this.renderDeletedContentF(e)))}},{key:"resetT",value:function(){var e=Qe(this.state.initial);this.setState(Object(N.a)({},e)),this.init()}},{key:"isPristineT",value:function(){var e=!0;return this.state.touched.forEach(function(t){Ue.forEach(function(n){e=e&&!t[n]})}),e&&this.state.initial.length===this.state.values.length&&!this.deleteCount}},{key:"hasErrorsT",value:function(){var e=!1;return this.state.errors.forEach(function(t){var n;e=e||((n=t).credit||n.active||n.descr||n.color)}),e}},{key:"preInitT",value:function(e){return We(e)}},{key:"showOk",value:function(){this.msg.show("SAVED SUCCESSFULLY",{time:2e3,type:"success",icon:r.a.createElement("img",{src:"yes.png",alt:"save ok"})})}},{key:"preSubmitT",value:function(){var e=this,t=[];this.state.values.forEach(function(n,a){if(!e.isPersistedR(a)){var r={};Ue.forEach(function(t){r[t]=e.chooseValueF(a,t)}),t.push(r)}});var n=[];this.state.deleted.forEach(function(t,a){t&&n.push(e.state.values[a].id)});var a=[];this.state.values.forEach(function(t,n){if(e.isPersistedR(n)){var r={};Ue.forEach(function(a){e.touchedF(n,a)&&(r.id=t.id,r[a]=e.chooseValueF(n,a))}),Object.keys(r).length>0&&a.push(r)}});var r={created:ze(t),deleted:n,modified:ze(a)};this.pristine=null,this.props.update(r)}},{key:"init",value:function(){this.deleteCount=0,this.pristine=null,this.errors=null,this.allChecked=!1}},{key:"tdClassName",value:function(e,t){return t+"_cell"+(this.isPersistedR(e)?"":" newRow")+(this.state.deleted[e]?" deleted":"")+(this.state.errors[e][t]?" error":"")}},{key:"td",value:function(e,t){return r.a.createElement("td",{key:e+"_"+t,className:this.tdClassName(e,t)},this.renderContentF(t,e))}},{key:"thClassName",value:function(e){return e+"_header"}},{key:"th",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=r.a.createElement(Je,{name:this.state.asc?"sort-asc":"sort-desc"}),i=r.a.createElement("div",null,this.state.sort===e?a:""),s=r.a.createElement("div",{style:{marginTop:8}},r.a.createElement("button",{type:"button",className:"link-button",onClick:function(){t.setSortF(e)}},n));return r.a.createElement("th",{className:this.thClassName(e)},r.a.createElement("div",null,r.a.createElement("span",{style:{display:"flex"}},r.a.createElement("div",{style:{marginTop:8,paddingRight:3}},i),null!==n?s:"")))}},{key:"componentWillReceiveProps",value:function(e){this.isPristineT()||null!=this.pristine||this.showOk(),this.init(),this.setState(Object(N.a)({},Qe(this.preInitT(e.initAccounts))))}},{key:"render",value:function(){var e=this;return this.pristine=this.isPristineT(),this.errors=this.hasErrorsT(),r.a.createElement("div",null,r.a.createElement(ue.a,Object.assign({ref:function(t){return e.msg=t}},de)),this.renderAccountsT())}}]),t}(r.a.Component);Ze.defaultProps={initAccounts:[]};var $e=Object(s.b)(null,function(e){return{update:function(t){e(Le(t))}}})(Ze),et=function(e){function t(e){var n;return Object(w.a)(this,t),(n=Object(_.a)(this,Object(R.a)(t).call(this,e))).state={accounts:[]},n}return Object(T.a)(t,e),Object(x.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(S.a,null,r.a.createElement(S.a.Heading,{style:{paddingTop:"4px",paddingBottom:"3px",height:"45px",fontSize:"23px"}},r.a.createElement("span",{style:{display:"flow-root",alignItems:"center"}},"Accounts")),r.a.createElement(S.a.Body,null,r.a.createElement($e,{initAccounts:this.props.accounts}))))}}]),t}(r.a.Component),tt=Object(s.b)(function(e){return{accounts:e.accounts.accounts}})(et),nt=(n(521),n(25)),at=function(e){function t(){return Object(w.a)(this,t),Object(_.a)(this,Object(R.a)(t).apply(this,arguments))}return Object(T.a)(t,e),Object(x.a)(t,[{key:"render",value:function(){var e=r.a.createElement(nt,{name:"spinner",spin:!0});return this.props.fetching?e:""}}]),t}(r.a.Component),rt=function(e,t,n){return{type:"AUDITLOG_RESPONSE",payload:{logentries:e,firstpage:t,lastpage:n}}},it=function(e){return function(t){t({type:"AUDITLOG_REQUEST"}),Y("history",null!=e?"id="+e:"",function(e){var n=!0;51===e.data.length&&(n=!1,e.data.pop()),t(rt(e.data,!0,n))},t)}},st=function(e){return function(t){t({type:"AUDITLOG_REQUEST"}),Y("history","s="+e,function(e){var n=!0;51===e.data.length&&(n=!1,e.data.pop()),t(rt(e.data,!1,n))},t)}},lt=function(e){return function(t){t({type:"AUDITLOG_REQUEST"}),Y("history","e="+e,function(e){var n=!0;51===e.data.length&&(n=!1,e.data.shift()),t(rt(e.data,n,!1))},t)}},ct=n(25),ot=function(e){function t(e){var n;return Object(w.a)(this,t),(n=Object(_.a)(this,Object(R.a)(t).call(this,e))).next=n.next.bind(Object(D.a)(Object(D.a)(n))),n.prev=n.prev.bind(Object(D.a)(Object(D.a)(n))),n}return Object(T.a)(t,e),Object(x.a)(t,[{key:"next",value:function(){if(this.props.logentries&&0!==this.props.logentries.length){var e=this.props.logentries[this.props.logentries.length-1],t=e.hs[e.rownr].hd;this.props.next(t)}}},{key:"prev",value:function(){if(this.props.logentries&&0!==this.props.logentries.length){var e=this.props.logentries[0],t=e.hs[e.rownr].hd;this.props.prev(t)}}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(P.a,{onClick:this.prev,disabled:this.props.firstpage},r.a.createElement(ct,{name:"caret-left"})),r.a.createElement(P.a,{onClick:this.next,disabled:this.props.lastpage},r.a.createElement(ct,{name:"caret-right"})),r.a.createElement(P.a,{href:"http://localhost:8080/log"},r.a.createElement(ct,{name:"download"})))}}]),t}(r.a.Component);var ut=Object(s.b)(function(e){return{logentries:e.auditlog.logentries,firstpage:e.auditlog.firstpage,lastpage:e.auditlog.lastpage}},function(e){return{next:function(t){e(st(t))},prev:function(t){e(lt(t))}}})(ot),dt=n(32);function ht(e){var t=e.split("."),n=t[0],a=t[1]-1,r=t[2];return new Date(r,a,n)}function pt(e){var t=new Date(e),n="00"+t.getDate();n=n.substr(n.length-2);var a="00"+(t.getMonth()+1);a=a.substr(a.length-2);var r="00"+t.getHours();r=r.substr(r.length-2);var i="00"+t.getMinutes();i=i.substr(i.length-2);var s="00"+t.getSeconds();s=s.substr(s.length-2);var l="000"+t.getMilliseconds();return l=l.substr(l.length-3),n+"."+a+"."+t.getFullYear()+" "+r+":"+i+":"+s+"."+l}function mt(e,t){switch(t){case"w":return pt(e.hd);case"op":switch(e.op){case"C":return"creation";case"U":return"modification";case"D":return"deletion";default:return console.log("UNKONWN op:"+e.op),null}case"d":return function(e){var t=e.split("-"),n=t[2],a=t[1]-1,r=t[0];return dt(new Date(r,a,n),"dd.mm.yyyy")}(e.d);case"i":return he(e.i);case"s":return e.s?"X":"-";case"g":return e.g;case"c":return e.c_descr;case"a":return e.a_descr;case"descr":return e.descr;default:return console.log("UNKONWN field: "+t),null}}var ft=["d","i","s","g","c","a","descr"],bt=function(e){function t(e){var n;return Object(w.a)(this,t),(n=Object(_.a)(this,Object(R.a)(t).call(this,e))).renderLogHeaderT=function(){return r.a.createElement("thead",null,r.a.createElement("tr",null,n.th("w","When"),n.th("op","What"),n.th("d","Date"),n.th("i","Pay"),n.th("s","s"),n.th("g","Ref"),n.th("c","Issue"),n.th("a","Account"),n.th("descr","Desc.")))},n.renderLogHeaderT=n.renderLogHeaderT.bind(Object(D.a)(Object(D.a)(n))),n.renderLogR=n.renderLogR.bind(Object(D.a)(Object(D.a)(n))),n.renderContentF=n.renderContentF.bind(Object(D.a)(Object(D.a)(n))),n.tdClassName=n.tdClassName.bind(Object(D.a)(Object(D.a)(n))),n.td=n.td.bind(Object(D.a)(Object(D.a)(n))),n.thClassName=n.thClassName.bind(Object(D.a)(Object(D.a)(n))),n.th=n.th.bind(Object(D.a)(Object(D.a)(n))),n}return Object(T.a)(t,e),Object(x.a)(t,[{key:"renderContentF",value:function(e){return r.a.createElement("div",null,e)}},{key:"thClassName",value:function(e){return e+"_header"}},{key:"th",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=r.a.createElement("div",null,t);return r.a.createElement("th",{className:this.thClassName(e)},r.a.createElement("div",null,r.a.createElement("span",{style:{display:"flex"}},null!==t?n:"")))}},{key:"renderLogR",value:function(e,t){var n=this;return r.a.createElement("tr",{key:e.hs[t].id+"_"+e.hs[t].rownr},["w","op"].concat(ft).map(function(a){return n.td(e,t,a)}))}},{key:"tdClassName",value:function(e,t,n){var a=n+"_cell";return"U"===e.hs[t].op&&ft.indexOf(n)>-1&&e.hs[t][n]!==e.hs[t-1][n]&&(a+=" updatedRow"),(t===e.rownr||this.props.singleEntry)&&(a+=" actualRow"),a}},{key:"td",value:function(e,t,n){var a=mt(e.hs[t],n);return r.a.createElement("td",{key:e.hs[t].id+"_"+t+"_"+n,className:this.tdClassName(e,t,n)},this.renderContentF(a))}},{key:"render",value:function(){var e=this;if(null==this.props.logEntry)return null;var t=this.props.logEntry;return r.a.createElement(V.a,{id:"auditlog_table",key:"al_table_"+t.id,striped:!0,bordered:!0,hover:!0,condensed:!0},this.renderLogHeaderT(),r.a.createElement("tbody",null,t.hs.map(function(n,a){return e.renderLogR(t,a)})))}}]),t}(r.a.Component),yt=function(e){function t(e){var n;return Object(w.a)(this,t),(n=Object(_.a)(this,Object(R.a)(t).call(this,e))).renderLogEntry=n.renderLogEntry.bind(Object(D.a)(Object(D.a)(n))),n}return Object(T.a)(t,e),Object(x.a)(t,[{key:"renderLogEntry",value:function(e){return e.rownr<0?null:r.a.createElement(S.a,{key:"al_panel_"+e.hs[0].id+"_"+e.rownr},r.a.createElement(S.a.Heading,null,r.a.createElement(S.a.Title,null,mt(e.hs[e.rownr],"op")," at ",pt(e.hs[e.rownr].hd)," ( id: ",e.hs[0].id," )")),r.a.createElement(S.a.Body,null,r.a.createElement(bt,{logEntry:e})))}},{key:"render",value:function(){var e=this,t=this.props.logentries||[];return r.a.createElement("div",null,t.map(function(t){return e.renderLogEntry(t)}))}}]),t}(r.a.Component),vt=function(e){function t(){return Object(w.a)(this,t),Object(_.a)(this,Object(R.a)(t).apply(this,arguments))}return Object(T.a)(t,e),Object(x.a)(t,[{key:"render",value:function(){var e=this.props.logentries||[];return r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement(S.a,null,r.a.createElement(S.a.Heading,{style:{paddingTop:"6px",paddingBottom:"3px",height:"45px",fontSize:"23px"}},"Audit Log ",r.a.createElement(at,{fetching:this.props.fetching}),r.a.createElement("span",{className:"pull-right"},r.a.createElement(ut,null))))),r.a.createElement(yt,{logentries:e}),r.a.createElement("div",null,r.a.createElement(S.a,null,r.a.createElement(S.a.Heading,{style:{paddingTop:"6px",paddingBottom:"3px",height:"45px",fontSize:"23px"}},r.a.createElement("span",{className:"pull-right"},r.a.createElement(ut,null))))))}}]),t}(r.a.Component),gt=Object(s.b)(function(e){return{logentries:e.auditlog.logentries,fetching:e.auditlog.fetching}})(vt),Ot=function(e){function t(){return Object(w.a)(this,t),Object(_.a)(this,Object(R.a)(t).apply(this,arguments))}return Object(T.a)(t,e),Object(x.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(gt,{logentries:this.props.auditlog}))}}]),t}(r.a.Component),Et=Object(s.b)(function(e){return{auditlog:e.auditlog.logentries}})(Ot);function jt(e,t){var n=new Date(e);return n.setDate(n.getDate()+t),n}function kt(e,t){var n=new Date(e);return n.setMonth(n.getMonth()+t),n}function Ct(e,t){var n=new Date(e),a=new Date(t);return Math.floor((Date.UTC(a.getFullYear(),a.getMonth(),a.getDate())-Date.UTC(n.getFullYear(),n.getMonth(),n.getDate()))/864e5)}function wt(e,t){return 1===e.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()&&t.getDate()===xt(e.getMonth(),e.getYear())}function xt(e,t){return new Date(t,e+1,0).getDate()}var _t,Rt,Tt=function(e,t){return function(n){_t=e,Rt=t,n(function(e,t,n){return{type:"DATE_RANGE_SELECTED",payload:{s:e,e:t}}}(e,t))}},St=function(){return function(e){if(wt(_t,Rt)){var t=kt(_t,1),n=new Date(t);return t.setDate(1),n.setDate(xt(n.getMonth(),n.getYear())),void e(Tt(t,n))}var a=Ct(_t,Rt);e(Tt(jt(_t,a+1),jt(Rt,a+1)))}},Ft=function(){return function(e){if(wt(_t,Rt)){var t=kt(_t,-1),n=new Date(t);return t.setDate(1),n.setDate(xt(n.getMonth(),n.getYear())),void e(Tt(t,n))}var a=Ct(Rt,_t);e(Tt(jt(_t,a-1),jt(Rt,a-1)))}},Nt=function(){return function(e){var t=new Date(0),n=new Date;t.setFullYear(n.getFullYear()),t.setMonth(n.getMonth()),t.setDate(1),t.setHours(0);var a=new Date(t);a.setDate(xt(a.getMonth(),a.getYear())),e(Tt(t,a))}},Dt=0,Pt=function(e){return function(t){Dt=e,t({type:"MINIBARS_REQUEST",payload:null}),B("minibars",{params:{cat:e}},function(e){var n={data:e.data,balance:0};t(function(e){return{type:"MINIBARS_RESPONSE",payload:{balances:e}}}(n))},t)}},Vt=function(){return function(e){e({type:"MINIBARS_REDRAW",payload:{redraw:(new Date).getTime()}})}};n(140);var At=n(524),Mt=n(32),It=n(102);function Lt(e){return parseFloat(Math.round(100*e)/100).toFixed(2)}var Ht=function(){var e,t,n,a,r,i,s,l,c,o,u,d,h,p,m,f,b,y,v,g,O,E="dd.mm.yyyy ddd",j="mmm",k="mmm yyyy",C="red",w="green",x="blue",_="white",R="pink",T="gray",S="cadetblue",F="lightblue",N="lightblue",D="black",P="lightblue",V=null,A=3,M=.8,I=null,L=null,H=null;var U="_div_minibar",Y="_tip_div_minibar",B="_tip_i_div_minibar",W="_day_text",z="_b_text",q="_b_color",G="_i_text",Q="_leadin_minibar",K="_zero_leadin_minibar",J="_zero_leadin_text_minibar",X="_max_text_minibar",Z="_min_text_minibar",$="_month_minibar",ee="_slot_bg_minibar",te="_i_minibar",ne="_e_minibar",ae="_b_minibar",re="_b_prev_minibar",ie="_b_next_minibar",se="_zero_minibar",le=null;function ce(){t=A*M,b=function(){console.assert(le[0].columns[0].d,"d must be defined"),console.assert(le[le.length-1].columns[0].d,"d must be defined");var e=ue(le[0].columns[0].d),t=ue(le[le.length-1].columns[0].d);return e+"-"+t}(),i=null}function oe(e){return"_"+V+"_"+e.getDate()+"_"+(e.getMonth()+1)+"_"+e.getFullYear()}function ue(e){return"_"+V+"_"+(e.getMonth()+1)+"_"+e.getFullYear()}function de(e){return!I||L||At.compare(e.d,I)?(t=e,I&&L&&t.d&&At.inRange(t.d,I,L)?T:function(e){if(e.smallestb<0)return R;return _}(e)):S;var t}function he(e){return e.getMonth()%2?N:F}function pe(e){var t=function(e){return Math.round(e).toPrecision(3)}(e),n=It.formatPrefix(t);return""+n.scale(t)+("y"===n.symbol?"":n.symbol)}function me(e){var t=ue(e.d),n=document.getElementById(oe(e.d)+ee).getBoundingClientRect(),a=document.documentElement,r=0,i=-((window.pageYOffset||a.scrollTop)-(a.clientTop||0));It.select("#"+t+B).style("display",0===e.i&&0===e.e?"none":"table-row"),It.select("#"+t+Y).style({display:"inline",left:n.left-r+A+"px",top:n.top-i+.75*l+"px",position:"absolute"}),It.select("#"+t+W).text(Mt(e.d,E)),It.select("#"+t+z).text(Lt(e.b)),It.select("#"+t+q).style("background-color",function(e){return e.i+e.e<0?C:w}(e)),It.select("#"+t+G).text(Lt(e.i+e.e))}function fe(e,t){var n=It.min([e,t]),a=It.max([e,t]);I=n,L=a}var be=864e5;function ye(e,t){var n=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()),a=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate());return Math.floor((a-n)/be)}function ve(e){document.body.style.cursor=e}var ge={click:function(e){if(null==I||I&&L)I=e.d,L=null,ve("col-resize"),Ce();else if(null==L){if(I&&Math.abs(ye(I,e.d))>O)return;L=e.d,ve("pointer"),fe(I,L),Ce(),H(I,L)}me(e),It.select("#"+oe(e.d)+ee).attr("fill",S)},mouseover:function(e,t){me(e),It.select("#"+oe(e.d)+ee).attr("fill",S),I&&!L&&Math.abs(ye(I,e.d))>O?ve("not-allowed"):ve(I&&!L?"col-resize":"pointer")},mouseout:function(e){!function(e){It.select("#"+ue(e.d)+Y).style("display","none")}(e),It.select("#"+oe(e.d)+ee).attr("fill",de(e))}};function Oe(i){var c=ue(i.columns[0].d),u=i.columns.length*A+n,b=It.select("#"+V),y={click:function(){var e,t;e=i.columns[0].d,t=i.columns[i.columns.length-1].d,I=e,L=t,Ce(),H(I,L)},mouseover:function(){var e;e=i.columns[0].d,It.select("#"+ue(e)+$).attr("fill",S)},mouseout:function(){var e;e=i.columns[0].d,It.select("#"+ue(e)+$).attr("fill",he(e))}},v=b.append("div").attr("id",c+U).style({width:u+"px",height:f+"px",float:"left","background-color":"white","border-style":"solid","border-width":e+"px","border-color":"magenta","margin-top":"5px"}),O=b.append("div").attr("id",c+Y).style({display:"none",position:"absolute","pointer-events":"none",top:"0px",left:"0px"}).append("table").attr("class","c3-tooltip").append("tbody");O.append("tr").append("th").attr({id:c+W,colspan:"2"}).text("CCC");var E=O.append("tr").attr("class","c3-tooltip-name--data2");E.append("td").attr("class","name").append("span").style("background-color",x),E.append("td").attr("class","value").attr("id",c+z).text("");var _=O.append("tr").attr("id",c+B).attr("class","c3-tooltip-name--data1");_.append("td").attr("class","name").append("span").attr("id",c+q).style("background-color","white"),_.append("td").attr("class","value").attr("id",c+G).text("");var R=v.append("svg").attr({id:c+Q,width:"0px",height:f});R.append("line").attr({x1:r-.5*n,x2:r-.5*n,y1:d,y2:m,stroke:P,"stroke-width":n}),R.append("line").attr({id:c+K,x1:r-7,x2:r,y1:h-g(0)+s+n,y2:h-g(0)+s+n,stroke:"black","stroke-width":a}),R.append("text").text("").attr({id:c+X,x:r-10,y:d+12,"text-anchor":"end","font-family":"sans-serif","font-size":"12px",fill:"black"}),R.append("text").text("").attr({id:c+Z,x:r-10,y:h,"text-anchor":"end","font-family":"sans-serif","font-size":"12px",fill:"black"});var T,F=v.append("svg").style({cursor:"inherit"}).attr({width:u,height:f,fill:"red"}).on({mouseout:function(){ve("default")}});F.append("rect").attr({id:c+$,y:p,x:0,width:u-n,height:o,fill:he(i.columns[0].d)}).style("cursor","pointer").on(y),F.append("text").text((T=i.columns[0].d,0===T.getMonth()?Mt(T,k):Mt(T,j))).attr({x:3,y:p+15,"text-anchor":"start","font-family":"sans-serif","font-size":"12px",fill:D}).style("cursor","pointer").on(y),F.selectAll().data(i.columns).enter().append("rect").attr({id:function(e){return console.assert(e.d,"d must be defined"),oe(e.d)+ee},x:function(e,t){return t*A},y:d,width:A,height:l,fill:function(e){return de(e)}}).on(ge),F.selectAll().data(i.columns).enter().append("rect").attr({id:function(e){return oe(e.d)+te},x:function(e,t){return(t+(1-M)/2)*A},y:function(e){return h-g(e.i)+s+n},width:t,height:function(e){return g(e.i)-g(0)},fill:w}).on(ge),F.selectAll().data(i.columns).enter().append("rect").attr({id:function(e){return oe(e.d)+ne},x:function(e,t){return(t+(1-M)/2)*A},y:h-g(0)+s+n,width:t,height:function(e){return g(0)-g(e.e)},fill:C}).on(ge),F.selectAll().data(i.columns).enter().append("line").attr({id:function(e){return oe(e.d)+se},x1:function(e,t){return t*A},x2:function(e,t){return(t+1)*A},y1:h-g(0)+s+n,y2:h-g(0)+s+n,stroke:"black","stroke-width":a}).on(ge),F.selectAll().data(i.columns).enter().append("line").attr({id:function(e){return oe(e.d)+re},x1:function(e,t){return(t-(null!=e.prev_b?.5:-.5))*A},x2:function(e,t){return(t+.5)*A},y1:function(e){return h-g(null!=e.prev_b?e.prev_b:e.b)+s+n},y2:function(e,t){return h-g(e.b)+s+n},stroke:x,"stroke-width":a}).on(ge),F.selectAll().data(i.columns).enter().append("line").attr({id:function(e){return oe(e.d)+ie},x1:function(e,t){return(t+.5)*A},x2:function(e,t){return(t+(null!=e.next_b?1.5:.5))*A},y1:function(e){return h-g(e.b)+s+n},y2:function(e,t){return h-g(null!=e.next_b?e.next_b:e.b)+s+n},stroke:x,"stroke-width":a}).on(ge),A>4&&F.selectAll().data(i.columns).enter().append("circle").style("shape-rendering","auto").attr({id:function(e){return oe(e.d)+ae},cx:function(e,t){return(t+.5)*A},cy:function(e){return h-g(e.b)+s+n},r:1.5,fill:x}).on(ge),F.append("line").attr({x1:-2,x2:u+2,y1:d+.5*n,y2:d+.5*n,stroke:P,"stroke-width":n}),F.append("line").attr({x1:u-.5*n,x2:u-.5*n,y1:d,y2:m,stroke:P,"stroke-width":n})}function Ee(e){var t=ue(e.columns[0].d),a=document.getElementById(t+U).getBoundingClientRect().left,s=e.columns.length*A+n;i||(i=a),It.select("#"+t+U).style({width:s+(a<=i?r:0)+"px"}),It.select("#"+t+Q).attr({width:(a<=i?r:0)+"px"}),It.select("#"+t+X).text(pe(v)),It.select("#"+t+Z).text(pe(y))}function je(e){var t=ue(e.columns[0].d);It.select("#"+t+K).transition().attr({y1:h-g(0)+s+n,y2:h-g(0)+s+n}),It.select("#"+t+J).transition().attr({y:h-g(0)+3+s+n}),e.columns.forEach(function(e){var t=oe(e.d);It.select("#"+t+te).datum(function(t){return t.i=e.i,t.e=e.e,t.b=e.b,t.smallestb=e.smallestb,t.prev_b=e.prev_b,t.next_b=e.next_b,t}).transition().attr({y:function(e){return h-g(e.i)+s+n},height:function(e){return g(e.i)-g(0)}}),It.select("#"+t+ee).transition().attr({fill:function(e){return de(e)}}),It.select("#"+t+ne).transition().attr({y:h-g(0)+s+n,height:function(e){return g(0)-g(e.e)}}),It.select("#"+t+ae).transition().attr({cy:function(e){return h-g(e.b)+s+n}}),It.select("#"+t+se).transition().attr({y1:h-g(0)+s+n,y2:h-g(0)+s+n}),It.select("#"+t+re).transition().attr({y1:function(e){return h-g(null!=e.prev_b?e.prev_b:e.b)+s+n},y2:function(e){return h-g(e.b)+s+n}}),It.select("#"+t+ie).transition().attr({y1:function(e){return h-g(e.b)+s+n},y2:function(e){return h-g(null!=e.next_b?e.next_b:e.b)+s+n}})})}var ke={balance:0,data:[{d:new Date,b:0,e:0,i:0,smallestb:0}]};function Ce(){if(le)for(var e=0,t=le.length;e<t;e++)je(le[e]),Ee(le[e])}function we(){It.select("#"+V).selectAll("div").remove();for(var e=0,t=le.length;e<t;e++)Oe(le[e]),Ee(le[e])}return{resize:function(){ce(),we()},config:function(t){V||(console.assert(t,"not a valid config"),function(t){V?console.assert(!t.bindto||V===t.bindto,"bindto can be defined only once"):(console.assert(t.bindto,"bindto is mandatory"),V=t.bindto),e=t.div_border_width||e||0,r=t.leadin_width||r||45,n=t.line_width||n||1,a=t.b_line_width||a||.2,s=t.top_margin||s||10,l=t.datearea_height||l||80,c=t.center_margin||c||0,o=t.month_height||o||20,u=t.bottom_margin||u||3,f=(m=(p=(h=(d=s)+l)+c)+o)+u,H=t.select,O=t.max_selection_days||90,b="NONE"}(t))},generate:function(e){if(e&&e.data){e.data.length||(e=ke),console.assert(V,"config must be called first!"),le=function(e){var t=-1!==e[0].a,n=[];if(!e||!e.length)return n;if("string"===typeof e[0].d)for(var a=0,r=e.length;a<r;a++)e[a].d=new Date(e[a].d);function i(e,t){return new Date(t,e+1,0).getDate()}console.assert(e[0].d,"d is mandatory");for(var s=e[0].d.getMonth()-1,l=e[0].d.getFullYear(),c=e[0].d.getDate()-1,o=0,u=0,d=null,h=0,p=e.length;h<p;h++){var m=e[h];console.assert(m.d,"d is mandatory");var f=m.d.getMonth(),b=m.d.getFullYear(),y=m.d.getDate();for(console.assert(f>=0&&f<12&&y>0&&y<=31&&372*l+31*s+c<372*b+31*f+y,"input array must be ascending"),c=y;s!==f||l!==b;){12===++s&&(l++,s=0),d=[];for(var v=1,g=i(s,l);v<=g;v++)d.push({i:0,e:0,d:new Date(l,s,v),b:o,smallestb:u});n.push({columns:d,range_text:s+1+"/"+l})}console.assert(null!=m.b,"b is mandatory"),console.assert(null!=m.smallestb,"smallestb is mandatory"),console.assert(null!=m.i,"i is mandatory"),console.assert(m.i>=0,"i must be positive"),console.assert(null!=m.e,"e is mandatory"),console.assert(m.e<=0,"i must be negative"),t?(o=m.b,u=m.smallestb):u=o=Math.round(100*(o+m.i+m.e))/100;for(var O=m.d.getDate(),E=d.length;O<E;O++)d[O].b=o,d[O].smallestb=u;d[m.d.getDate()-1].i=m.i,d[m.d.getDate()-1].e=m.e,d[m.d.getDate()-1].b=o,d[m.d.getDate()-1].smallestb=u}for(var j=0,k=n.length;j<k;j++)for(var C=0,w=n[j].columns.length;C<w;C++){var x=n[j].columns[C];j||C?j+1===k&&C+1===w?x.next_b=null:C?C+1===w&&(x.next_b=n[j+1].columns[0].b):x.prev_b=n[j-1].columns[n[j-1].columns.length-1].b:x.prev_b=null,"undefined"===typeof x.prev_b&&(x.prev_b=n[j].columns[C-1].b),"undefined"===typeof x.next_b&&(x.next_b=n[j].columns[C+1].b)}d=[];var _=new Date(n[0].columns[0].d);_.setMonth(_.getMonth()-1);for(var R=1,T=i(s=_.getMonth(),l=_.getFullYear());R<=T;R++)d.push({i:0,e:0,d:new Date(l,s,R),b:0,smallestb:0});n.unshift({columns:d,range_text:s+1+"/"+l}),d=[];var S=n[n.length-1].columns[n[n.length-1].columns.length-1];S.next_b=S.b;var F=new Date(S.d);F.setDate(1),F.setMonth(F.getMonth()+1);for(var N=1,D=i(s=F.getMonth(),l=F.getFullYear());N<=D;N++)d.push({i:0,e:0,d:new Date(l,s,N),b:S.b,smallestb:S.smallestb,prev_b:S.b,next_b:S.b});return d[d.length-1].next_b=null,n.push({columns:d,range_text:s+1+"/"+l}),n}(e.data);var t=b;ce(),function(){y=It.min([0,le[0].columns[0].b]),v=It.max([0,le[0].columns[0].b]);for(var e=0,t=le.length;e<t;e++)y=It.min([y,It.min(le[e].columns,function(e){return console.assert(null!=e.i&&null!=e.e&&null!=e.b&&e.d,"i, e, b and d must be defined"),console.assert(e.i>=0&&e.e<=0,"i must be positive, e must be negative"),It.min([e.i,e.e,e.b])})]),v=It.max([v,It.max(le[e].columns,function(e){return It.max([e.i,e.e,e.b])})]);0===y&&0===v&&(v=100),g=It.scale.linear().domain([y,v]).range([d+n,h])}(),t===b?Ce():we()}},select:function(e,t){e&&t?(fe(e,t),Ce()):console.assert(null!=e&&null!=t)}}}();window.addEventListener("resize",function(e){Ht.resize()});var Ut=function(e){function t(e){var n;return Object(w.a)(this,t),(n=Object(_.a)(this,Object(R.a)(t).call(this,e))).state={start:new Date,end:new Date,balances:null,redraw:null},n.select=n.select.bind(Object(D.a)(Object(D.a)(n))),n.redraw=n.redraw.bind(Object(D.a)(Object(D.a)(n))),e.load(),n}return Object(T.a)(t,e),Object(x.a)(t,[{key:"componentDidMount",value:function(){var e={max_selection_days:400,bindto:this.props.name,select:this.select};this.minibars=Ht,this.minibars.config(e)}},{key:"select",value:function(e,t){this.su=!1,this.props.setDateRange(new Date(e),new Date(t),"rangePicker1")}},{key:"redraw",value:function(){this.minibars.generate(this.props.balances),this.minibars.select(this.props.start,this.props.end)}},{key:"componentWillReceiveProps",value:function(e){this.minibars.generate(e.balances),this.minibars.select(e.start,e.end)}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{id:this.props.name}))}}]),t}(r.a.Component);var Yt=Object(s.b)(function(e){return{start:e.daterange.s,end:e.daterange.e,balances:e.minibars.balances,redraw:e.minibars.redraw}},function(e){return{load:function(){e(Pt(0))},setDateRange:function(t,n,a){e(Tt(t,n,a))}}})(Ut),Bt=n(25),Wt=function(e){function t(e){var n;return Object(w.a)(this,t),(n=Object(_.a)(this,Object(R.a)(t).call(this,e))).prevBlock=n.prevBlock.bind(Object(D.a)(Object(D.a)(n))),n}return Object(T.a)(t,e),Object(x.a)(t,[{key:"prevBlock",value:function(){this.props.daterangePrevBlock()}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(P.a,{onClick:this.prevBlock},r.a.createElement(Bt,{name:"caret-left"})))}}]),t}(r.a.Component);var zt=Object(s.b)(null,function(e){return{daterangePrevBlock:function(){e(Ft())}}})(Wt),qt=n(25),Gt=function(e){function t(e){var n;return Object(w.a)(this,t),(n=Object(_.a)(this,Object(R.a)(t).call(this,e))).nextBlock=n.nextBlock.bind(Object(D.a)(Object(D.a)(n))),n}return Object(T.a)(t,e),Object(x.a)(t,[{key:"nextBlock",value:function(){this.props.daterangeNextBlock()}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(P.a,{onClick:this.nextBlock},r.a.createElement(qt,{name:"caret-right"})))}}]),t}(r.a.Component);var Qt=Object(s.b)(null,function(e){return{daterangeNextBlock:function(){e(St())}}})(Gt),Kt=n(42),Jt=n.n(Kt),Xt=n(37),Zt=n.n(Xt),$t=(n(525),{dateLimit:{days:90},showWeekNumbers:!0,autoApply:!0,alwaysShowCalendars:!0,locale:{direction:"ltr",format:"DD.MM.YYYY",separator:" - ",applyLabel:"Apply",cancelLabel:"Cancel",fromLabel:"From",toLabel:"To",customRangeLabel:"Custom",daysOfWeek:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],firstDay:1},linkedCalendars:!1,ranges:{"Last 7 Days":[Jt()().subtract(6,"days"),Jt()()],"Last 30 Days":[Jt()().subtract(29,"days"),Jt()()],"This Month":[Jt()().startOf("month"),Jt()().endOf("month")],"Last Month":[Jt()().subtract(1,"month").startOf("month"),Jt()().subtract(1,"month").endOf("month")]}}),en={singleDatePicker:!0,showDropdowns:!1,showWeekNumbers:!0,alwaysShowCalendars:!0,autoApply:!0,locale:{direction:"ltr",format:"DD.MM.YYYY",separator:" - ",applyLabel:"Apply",cancelLabel:"Cancel",fromLabel:"From",toLabel:"To",customRangeLabel:"Custom",daysOfWeek:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],firstDay:1}},tn=function(e){function t(e){var n;return Object(w.a)(this,t),(n=Object(_.a)(this,Object(R.a)(t).call(this,e))).state={start:e.value?e.value:e.start?e.start:new Date,end:e.value?null:e.end?e.end:new Date},n}return Object(T.a)(t,e),Object(x.a)(t,[{key:"componentWillReceiveProps",value:function(e){e.value?(Zt()("#"+this.props.pickerName).data("daterangepicker").setStartDate(e.value),Zt()("#"+this.props.pickerName).data("daterangepicker").setEndDate(e.value)):e.start&&(Zt()("#"+this.props.pickerName).data("daterangepicker").setStartDate(e.start),Zt()("#"+this.props.pickerName).data("daterangepicker").setEndDate(e.end))}},{key:"componentDidMount",value:function(){var e=this;"single"===this.props.pickerType&&Zt()("#"+this.props.pickerName).daterangepicker(en,function(t){e.props.pickerCallback(t,e.props.pickerName)}),"range"===this.props.pickerType&&Zt()("#"+this.props.pickerName).daterangepicker($t,function(t,n){e.props.pickerCallback(t,n,e.props.pickerName)}),Zt()("#"+this.props.pickerName).data("daterangepicker").setStartDate(this.state.start),"range"===this.props.pickerType?Zt()("#"+this.props.pickerName).data("daterangepicker").setEndDate(this.state.end):Zt()("#"+this.props.pickerName).data("daterangepicker").setEndDate(this.state.start)}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("input",{disabled:this.props.disabled,autoComplete:"off",onKeyDown:function(e){if(9!==(e.which||e.keyCode))return e.preventDefault(),!1},type:"text",id:this.props.pickerName,className:"form-control",style:{display:"inline",width:"range"===this.props.pickerType?"185px":"100px",backgroundColor:this.props.touched?"lightyellow":""}}))}}]),t}(r.a.Component);tn.defaultProps={componentWillReceiveProps:!1,start:null,end:null,disabled:!1,touched:!1};var nn=Object(s.b)(function(e){return{start:e.daterange.s,end:e.daterange.e}})(tn),an=n(107);n(542);function rn(e,t){for(var n=0;n<e.length;n++){var a=e[n];if(t(a))return a}return null}var sn=n(25),ln=function(e){function t(e){var n;return Object(w.a)(this,t),(n=Object(_.a)(this,Object(R.a)(t).call(this,e))).state={selectedValue:null,items:e.getConstants(e.constants_id)},n.constants_id=e.constants_id,n.onValueChange=n.onValueChange.bind(Object(D.a)(Object(D.a)(n))),n.className=n.className.bind(Object(D.a)(Object(D.a)(n))),n}return Object(T.a)(t,e),Object(x.a)(t,[{key:"onValueChange",value:function(e){return this.setState({selectedValue:e}),this.props.onValueChange(null!=e?e.value:null),this.renderOption(e)}},{key:"componentWillReceiveProps",value:function(e){if(e.constants&&e.constants[this.props.constants_id]){var t=e.constants[this.props.constants_id],n=rn(t,function(t){return t.value===e.selectedValue}),a=t.filter(function(e){return e.valid||e===n});this.setState({selectedValue:n,items:a})}}},{key:"renderOption",value:function(e){if(null!=e)return r.a.createElement("span",{style:{display:"block",whiteSpace:"nowrap"}},r.a.createElement("span",{style:{display:"block",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",maxWidth:"100px"}},r.a.createElement("span",{style:{marginRight:"5px",marginLeft:"5px"}},r.a.createElement(sn,{name:"square",style:{color:e.color}})),r.a.createElement("span",null,e.label)))}},{key:"className",value:function(){return this.props.readOnly||this.props.touched?!this.props.readOnly&&this.props.touched?"simpledropdown_touched":this.props.readOnly&&!this.props.touched?"simpledropdown_ro":this.props.readOnly&&this.props.touched?"simpledropdown_ro_touched":void 0:"simpledropdown"}},{key:"render",value:function(){return r.a.createElement(an.SimpleSelect,{className:this.className(),disabled:this.props.readOnly,style:{width:"150px",border:"none",backgroundColor:"none",backgroundImage:"none"},renderOption:this.renderOption,renderValue:this.renderOption,onValueChange:this.onValueChange,placeholder:this.props.placeholder,options:this.state.items,value:this.state.selectedValue,hideResetButton:!0,cancelKeyboardEventOnSelection:!1})}}]),t}(r.a.Component);ln.defaultProps={refreshTime:null,onValueChange:null,touched:!1,readOnly:!1,placeholder:"",constants:null,constants_id:null};var cn=Object(s.b)(function(e){return{refreshTime:e.constants.refreshTime,constants:e.constants.constants}},function(e){return{getConstants:function(t){Q(t,e)}}})(ln),on=function(e){function t(e){var n;return Object(w.a)(this,t),(n=Object(_.a)(this,Object(R.a)(t).call(this,e))).state={filter:null,checked:!0},n.onFilterChanged=n.onFilterChanged.bind(Object(D.a)(Object(D.a)(n))),n.onCheck=n.onCheck.bind(Object(D.a)(Object(D.a)(n))),n}return Object(T.a)(t,e),Object(x.a)(t,[{key:"onFilterChanged",value:function(e){this.setState({filter:e}),this.props.balances_load(e)}},{key:"onCheck",value:function(e){this.setState({checked:e}),e?this.props.balances_load(0):this.state.filter&&this.props.balances_load(this.state.filter)}},{key:"render",value:function(){var e=r.a.createElement(cn,{readOnly:this.state.checked,onValueChange:this.onFilterChanged,selectedValue:this.state.filter,placeholder:"filter",constants_id:"cat"});return r.a.createElement("div",null,r.a.createElement("span",{style:{display:"inline-flex"}},r.a.createElement("div",{style:{paddingTop:"7px",paddingRight:"5px"}},"All"),r.a.createElement(ee,{id:"all",onValueChanged:this.onCheck,checked:this.state.checked}),this.state.checked?null:e))}}]),t}(r.a.Component);var un=Object(s.b)(null,function(e){return{balances_load:function(t){e(Pt(t))}}})(on),dn=n(44),hn=n(25),pn=function(e){function t(e){var n;return Object(w.a)(this,t),(n=Object(_.a)(this,Object(R.a)(t).call(this,e))).showMinibars=n.showMinibars.bind(Object(D.a)(Object(D.a)(n))),n.state={showMinibars:!1},n}return Object(T.a)(t,e),Object(x.a)(t,[{key:"showMinibars",value:function(){this.setState({showMinibars:!this.state.showMinibars});var e=this;setTimeout(function(){e.props.minibarsRedraw()},0)}},{key:"render",value:function(){var e=this,t=this.state.showMinibars?r.a.createElement("span",{className:"pull-right",style:{paddingLeft:"20px"}},r.a.createElement(un,null)):null,n=r.a.createElement("div",null,r.a.createElement("div",{style:{display:"inline-flex",whiteSpace:"nowrap",alignItems:"center",fontSize:"23px"}},r.a.createElement(hn,{name:"calendar"}),"-",r.a.createElement(hn,{name:"calendar"}),"\xa0",r.a.createElement("div",{style:{paddingTop:"1px"}},r.a.createElement(zt,null)),r.a.createElement(nn,{componentWillReceiveProps:!0,pickerName:"rangePicker1",pickerType:"range",pickerCallback:function(t,n,a){e.props.setDateRange(new Date(t),new Date(n))}}),r.a.createElement("div",{style:{paddingTop:"1px"}},r.a.createElement(Qt,null))),r.a.createElement("span",null,r.a.createElement(S.a.Toggle,{componentClass:"button",className:"link-button",onClick:this.showMinibars,style:{textDecoration:"none"}},"\xa0",this.state.showMinibars?r.a.createElement(hn,{name:"caret-up",size:"2x"}):r.a.createElement(hn,{name:"caret-down",size:"2x"}),"\xa0")),r.a.createElement(at,{fetching:this.props.fetching}),t);return r.a.createElement(S.a,{style:{width:"100%"},id:"minibars-panel",expanded:this.state.showMinibars,onToggle:function(){}},r.a.createElement(dn.a,{query:"(max-width: 604px)"},function(e){return e?r.a.createElement(S.a.Heading,{style:{paddingTop:"3px",paddingBottom:"3px",height:"80px"}},n):r.a.createElement(S.a.Heading,{style:{paddingTop:"3px",paddingBottom:"3px",height:"45px"}},n)}),r.a.createElement(S.a.Collapse,null,r.a.createElement(S.a.Body,null,r.a.createElement(Yt,{name:"minibar"}))))}}]),t}(r.a.Component);var mn=Object(s.b)(function(e){return{fetching:e.minibars.fetching}},function(e){return{setDateRange:function(t,n){e(Tt(t,n))},minibarsRedraw:function(){e(Vt())}}})(pn),fn=n(32),bn=function(e,t){return{type:"PIE_REQUEST",payload:{s:e,e:t}}},yn=function(e){return{type:"PIE_RESPONSE",payload:{slices:e}}},vn=null;function gn(e){e(bn(vn.s,vn.e)),B("pie?ts="+Date.now(),{params:vn},function(t){e(yn(t.data))},e)}var On=function(e,t){return function(n){vn={s:fn(e,"yyyy-mm-dd"),e:fn(t,"yyyy-mm-dd")},gn(n)}},En=function(){return function(e){e({type:"PIE_REDRAW",payload:{redraw:(new Date).getTime()}})}},jn=n(32),kn=null,Cn=[],wn=-1,xn=function(){return{type:"PAYMENTS_REQUEST"}},_n=function(e,t){return{type:"PAYMENTS_RESPONSE",payload:{params:kn,queryType:kn.e,payments:e,balances:t,historystack:{last:wn===Cn.length-1,first:0===wn}}}},Rn=function(e){return function(t){t(function(e){return{type:"PAYMENTS_UPDATE_REQUEST",payload:{updates:e}}}(e)),W("payments/update",e,function(e){t({type:"PAYMENTS_UPDATE_RESPONSE"}),t(Vn()),t(function(e){console.assert(vn),gn(e)}),t(Pt(Dt)),t(Pe())},t)}};function Tn(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&(wn<Cn.length-1&&(Cn=Cn.slice(0,wn+1)),Cn.push(kn),wn++),e(xn()),B("payments",{params:kn},function(t){e(_n(t.data[0],t.data[1]))},e)}var Sn=function(e){return function(t){kn={e:"d",d:jn(e,"yyyy-mm-dd")},Tn(t,!0)}},Fn=function(e,t,n){return function(a){kn={e:"a",a:e,d1:jn(t,"yyyy-mm-dd"),d2:jn(n,"yyyy-mm-dd")},Tn(a,!0)}},Nn=function(e,t,n){return function(a){kn={e:"c",c:e,d1:jn(t,"yyyy-mm-dd"),d2:jn(n,"yyyy-mm-dd")},Tn(a,!0)}},Dn=function(e){return function(t){kn={e:"g",g:e},Tn(t,!0)}},Pn=function(e){return function(t){kn={e:"l",ids:e},Tn(t,!0)}},Vn=function(){return function(e){console.assert(kn),Tn(e)}},An=function(){return function(e){kn=Cn[--wn],Tn(e)}},Mn=function(){return function(e){kn=Cn[++wn],Tn(e)}},In=function(e,t){return function(n){n(function(e,t){return{type:"LOCK_PAYMENT_REQUEST",payload:{lock_payment_request:e,locked:t}}}(e,t)),B("lock",{params:{id:e,l:t}},function(t){n(function(e,t){return{type:"LOCK_PAYMENT_RESPONSE",payload:{payment:e}}}(e))},n)}},Ln=function(e){return function(t){t(function(e){return{type:"PAYMENT_SELECTION",payload:{payments:e}}}(e))}},Hn=function(e){return function(t){t(function(e){return{type:"CALC_ADD_REQUEST",payload:{p:e}}}(e))}},Un=n(598),Yn=n(599),Bn=n(608),Wn=n(605),zn=(n(545),function(e){function t(){return Object(w.a)(this,t),Object(_.a)(this,Object(R.a)(t).apply(this,arguments))}return Object(T.a)(t,e),Object(x.a)(t,[{key:"render",value:function(){if(null==this.props.logentries)return null;var e=this.props.logentries[0],t=Object(N.a)({},this.props),n={show:t.show,onHide:t.onHide};return r.a.createElement(Wn.a,Object.assign({},n,{size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:"true",dialogClassName:"modal-90w"}),r.a.createElement(Wn.a.Header,{closeButton:!0},r.a.createElement(Wn.a.Title,{id:"contained-modal-title-vcenter"},"History")),r.a.createElement(Wn.a.Body,null,r.a.createElement(bt,{logEntry:e,singleEntry:!0})),r.a.createElement(Wn.a.Footer,null,r.a.createElement(P.a,{onClick:this.props.onHide},"Close")))}}]),t}(r.a.Component)),qn=Object(s.b)(function(e){return{logentries:e.auditlog.logentries}})(zn),Gn=n(231),Qn=n.n(Gn),Kn=(n(560),n(25)),Jn=function(e){function t(){return Object(w.a)(this,t),Object(_.a)(this,Object(R.a)(t).apply(this,arguments))}return Object(T.a)(t,e),Object(x.a)(t,[{key:"render",value:function(){return r.a.createElement(Kn,{name:"lock",style:{color:"white"}})}}]),t}(r.a.Component),Xn=function(e){function t(){return Object(w.a)(this,t),Object(_.a)(this,Object(R.a)(t).apply(this,arguments))}return Object(T.a)(t,e),Object(x.a)(t,[{key:"render",value:function(){return r.a.createElement(Kn,{name:"unlock-alt",style:{color:"white"}})}}]),t}(r.a.Component),Zn=function(e){function t(e){var n;return Object(w.a)(this,t),(n=Object(_.a)(this,Object(R.a)(t).call(this,e))).toggleLock=n.toggleLock.bind(Object(D.a)(Object(D.a)(n))),n}return Object(T.a)(t,e),Object(x.a)(t,[{key:"toggleLock",value:function(e){var t=this.props,n=t.field,a=t.index,r=!e.target.checked;this.props.onValueChanged(r,n,a),this.props.lockPayment(this.props.id,r)}},{key:"componentWillReceiveProps",value:function(e){this.setState({checked:e.checked})}},{key:"render",value:function(){var e=this.props,t=e.readOnly,n=e.checked;return r.a.createElement("div",{style:{paddingTop:8}},r.a.createElement(Qn.a,{disabled:t,checked:!n,onChange:this.toggleLock,icons:{checked:r.a.createElement(Xn,null),unchecked:r.a.createElement(Jn,null)}}))}}]),t}(r.a.Component);Zn.defaultProps={id:null,onValueChanged:null,checked:!1,readOnly:!1,field:null,index:null};var $n=Object(s.b)(null,function(e){return{lockPayment:function(t,n){e(In(t,n))}}})(Zn),ea=n(609),ta=n(597),na=function(e){function t(e){var n;return Object(w.a)(this,t),(n=Object(_.a)(this,Object(R.a)(t).call(this,e))).state={currencyValue:e.value},n.onChange=n.onChange.bind(Object(D.a)(Object(D.a)(n))),n.handleFocus=n.handleFocus.bind(Object(D.a)(Object(D.a)(n))),n}return Object(T.a)(t,e),Object(x.a)(t,[{key:"handleFocus",value:function(e){}},{key:"onChange",value:function(e){var t=this.props,n=t.onValueChanged,a=t.field,r=t.index,i=function(e){if(!e)return e;"-"!==e&&"+"!==e||(e+="0");var t=e.lastIndexOf("+"),n=e.lastIndexOf("-");return""===(e=e.replace(/[^\d]/g,""))&&(e="0"),(e=""+parseInt(e,10)).length<3&&(e="00".slice(-3+e.length)+e),(t>=n?"+":"-")+e.slice(0,-2)+"."+e.slice(-2)}(e.target.value);this.setState({currencyValue:i}),n(i,a,r)}},{key:"componentWillReceiveProps",value:function(e){this.setState({currencyValue:e.value})}},{key:"render",value:function(){var e=this,t=this.props,n=t.id,a=t.readOnly,i=t.placeholder,s=t.touched,l=t.fontSize,c=t.linkCb,o=t.popoverText,u=r.a.createElement("div",null,r.a.createElement("input",{onFocus:this.handleFocus,autoComplete:"off",id:n,disabled:a,value:this.state.currencyValue,onChange:this.onChange,placeholder:a?"":i,type:"text",className:"form-control",style:{fontSize:l,textAlign:"right",color:this.state.currencyValue&&"-"===this.state.currencyValue.substr(0,1)?"red":"green",display:"inline",width:"85px",backgroundColor:s?"lightyellow":""}}));if(a)return r.a.createElement(P.a,{className:"link-button",onClick:function(){c(e.state.currencyValue)}},u);if(null==c||null==this.state.currencyValue||0===this.state.currencyValue.length)return r.a.createElement("span",{style:{display:"inline-flex"}},u);var d=c&&this.state.currencyValue&&this.state.currencyValue.length>0?r.a.createElement(P.a,{className:"link-button",onClick:function(){c(e.state.currencyValue)}},o):null;return r.a.createElement("div",null,r.a.createElement("span",{style:{display:"inline-flex"}},r.a.createElement(ea.a,{trigger:"focus",key:"top",placement:"top",overlay:r.a.createElement(ta.a,{id:"popover_cur_-positioned-".concat(n)},d)},u)))}}]),t}(r.a.Component);na.defaultProps={id:null,onValueChanged:null,placeholder:"",value:"",readOnly:!1,field:null,index:null,touched:!1,fontSize:"inherit",linkCb:null,popoverText:null};var aa=na,ra=function(e){function t(){return Object(w.a)(this,t),Object(_.a)(this,Object(R.a)(t).apply(this,arguments))}return Object(T.a)(t,e),Object(x.a)(t,[{key:"render",value:function(){var e=this.props,t=e.readOnly,n=e.field,a=e.index,i=e.onValueChanged,s=e.placeholder,l=e.touched,c=e.constants_id;return r.a.createElement("div",null,r.a.createElement(cn,{readOnly:t,onValueChange:function(e){i(e,n,a)},selectedValue:this.props.value,placeholder:s,touched:l,constants_id:c}))}}]),t}(r.a.Component);ra.defaultProps={onValueChanged:null,value:null,readOnly:!1,placeholder:"",field:null,index:null,touched:!1,constants_id:null};var ia=ra,sa=function(e){function t(e){var n;return Object(w.a)(this,t),(n=Object(_.a)(this,Object(R.a)(t).call(this,e))).state={txtValue:e.value},n.onChange=n.onChange.bind(Object(D.a)(Object(D.a)(n))),n}return Object(T.a)(t,e),Object(x.a)(t,[{key:"onChange",value:function(e){var t=this.props,n=t.onValueChanged,a=t.field,r=t.index;this.setState({txtValue:e.target.value}),n(e.target.value,a,r)}},{key:"componentWillReceiveProps",value:function(e){this.setState({txtValue:e.value})}},{key:"render",value:function(){var e=this,t=this.props,n=t.id,a=t.placeholder,i=t.readOnly,s=t.touched,l=t.linkCb,c=t.popoverText,o=t.maxLength,u=r.a.createElement("input",{autoComplete:"off",id:n,value:this.state.txtValue,disabled:i,style:{backgroundColor:s?"lightyellow":""},placeholder:i?"":a,type:"text",onChange:this.onChange,className:"form-control",maxLength:o});if(i&&null!=l)return r.a.createElement(P.a,{className:"link-button",onClick:function(){l(e.state.txtValue)}},u);if(s||null==l||null==this.state.txtValue||0===this.state.txtValue.length)return r.a.createElement("span",{style:{display:"inline-flex"}},u);var d=l&&this.state.txtValue&&this.state.txtValue.length>0?r.a.createElement(P.a,{className:"link-button",onClick:function(){l(e.state.txtValue)}},c):null;return r.a.createElement("div",null,r.a.createElement("span",{style:{display:"inline-flex"}},r.a.createElement(ea.a,{trigger:"focus",key:"top",placement:"top",overlay:r.a.createElement(ta.a,{id:"popover-positioned-".concat(n)},d)},u)))}}]),t}(r.a.Component);sa.defaultProps={id:null,placeholder:"",onValueChanged:null,value:"",readOnly:!1,field:null,index:null,touched:!1,linkCb:null,popoverText:null,maxLength:255};var la=sa,ca=n(32),oa=function(e){function t(){return Object(w.a)(this,t),Object(_.a)(this,Object(R.a)(t).apply(this,arguments))}return Object(T.a)(t,e),Object(x.a)(t,[{key:"render",value:function(){var e=this.props,t=e.id,n=e.onValueChanged,a=e.value,i=e.readOnly,s=e.field,l=e.index,c=e.touched,o=e.linkCb,u=e.popoverText,d=r.a.createElement("div",null,r.a.createElement(nn,{disabled:i,value:a,id:t,pickerName:"picker_d_"+t+l,pickerCallback:function(e){return n(ca(e,"dd.mm.yyyy"),s,l)},pickerType:"single",touched:c,style:{backgroundColor:c?"lightyellow":""}}));if(i&&null!=o)return r.a.createElement(P.a,{className:"link-button",onClick:function(){o(a)}},d);if(c||i||null==o||null==a||0===a.length)return r.a.createElement("span",{style:{display:"inline-flex"}},d);var h=o&&a&&a.length>0?r.a.createElement(P.a,{className:"link-button",onClick:function(){o(a)}},u):null;return r.a.createElement("div",null,r.a.createElement("span",{style:{display:"inline-flex"}},r.a.createElement(ea.a,{trigger:"focus",key:"top",placement:"top",overlay:r.a.createElement(ta.a,{id:"popover-d-positioned-"+t},h)},d)))}}]),t}(r.a.Component);oa.defaultProps={id:null,onValueChanged:null,value:!0,readOnly:!1,field:null,index:null,touched:!1,linkCb:null,popoverText:null};var ua=oa,da=n(233),ha=n.n(da);n(571);var pa=n(32),ma={DAILY:function(e,t){var n=jt(ht(e.d),1);e.d=pa(n,"dd.mm.yyyy")},WEEKLY:function(e,t){var n=jt(ht(e.d),7);e.d=pa(n,"dd.mm.yyyy")},FORTNIGHTLY:function(e,t){var n=jt(ht(e.d),14);e.d=pa(n,"dd.mm.yyyy")},TWICE_A_MONTH:function(e,t){var n,a=ht(e.d),r=null;n=t,r=0===(n=Number(n))||n&&!(n%2)?jt(a,14):kt(r=jt(a,-14),1),e.d=pa(r,"dd.mm.yyyy")},MONTHLY:function(e,t){var n=kt(ht(e.d),1);e.d=pa(n,"dd.mm.yyyy")},EVERY_OTHER_MONTH:function(e,t){var n=kt(ht(e.d),2);e.d=pa(n,"dd.mm.yyyy")},EVERY_3_MONTHS:function(e,t){var n=kt(ht(e.d),3);e.d=pa(n,"dd.mm.yyyy")},EVERY_4_MONTHS:function(e,t){var n=kt(ht(e.d),4);e.d=pa(n,"dd.mm.yyyy")},EVERY_6_MONTHS:function(e,t){var n=kt(ht(e.d),6);e.d=pa(n,"dd.mm.yyyy")},YEARLY:function(e,t){var n=kt(ht(e.d),12);e.d=pa(n,"dd.mm.yyyy")}};var fa=function(e,t,n){ma[n](e,t)},ba=n(32),ya=["d","b","i","s","g","c","a","descr"],va={id:null,l:!1,d:ba(new Date,"dd.mm.yyyy"),i:"+0.00",c:null,a:null,s:!0,g:"",descr:"",b:null},ga={id:null,l:!1,d:ba(new Date,"dd.mm.yyyy"),i:"+0.00",c:null,a:null,s:!0,g:"",descr:"",b:null},Oa={check:function(e){return null},l:function(e){return null},d:function(e){return null!=e&&""!==e?null:"required"},i:function(e){return""!==e?null:"required"},s:function(e){return null},c:function(e){return null!=e&&""!==e?null:"required"},a:function(e){return null!==e&&""!==e?null:"required"},g:function(e){return null},descr:function(e){return null},b:function(e){return null}};function Ea(e,t){var n=function(e,t){var n=[];return e.forEach(function(e){n.push(Ca(e,t))}),n}(e,t);return n.forEach(function(e){e.d=ba(e.d,"dd.mm.yyyy"),e.i=(e.i>=0?"+":"")+he(e.i)}),n}function ja(e){return e.forEach(function(e){e.i&&(e.i=parseFloat(e.i)),e.d&&(e.d=function(e){var t=e.split("."),n=t[0],a=t[1]-1,r=t[2];return dt(new Date(r,a,n),"yyyy-mm-dd")}(e.d))}),e}function ka(e){return{check:e,id:e,l:e,d:e,i:e,c:e,a:e,s:e,g:e,descr:e,b:e}}function Ca(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{check:t.indexOf(e.id)>-1,index:n,id:e.id,l:e.l,d:e.d,i:e.i,c:e.c,a:e.a,s:e.s,g:e.g,descr:e.descr,b:e.b}}var wa=[{label:"daily",value:"DAILY"},{label:"weekly",value:"WEEKLY"},{label:"fortnightly",value:"FORTNIGHTLY"},{label:"twice a month",value:"TWICE_A_MONTH"},{label:"monthly",value:"MONTHLY"},{label:"every other month",value:"EVERY_OTHER_MONTH"},{label:"every 3 months",value:"EVERY_3_MONTHS"},{label:"every 4 months",value:"EVERY_4_MONTHS"},{label:"every 6 months",value:"EVERY_6_MONTHS"},{label:"yearly",value:"YEARLY"}];function xa(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{recur:!1,times:1,span:wa[4]},a={values:[],initial:[],errors:[],touched:[],deleted:[],masked:ka(!1),maskValues:ga,maskErrors:ka(null),sort:null,asc:!0,allChecked:!1,recurring:n};return a.recurring.recur=!1,e.forEach(function(e,n){a.values.push(Ca(e,t,n)),a.initial.push(Ca(e,t)),a.errors.push(ka(null)),a.touched.push(ka(!1)),a.deleted.push(!1)}),a}function _a(e){return e.d||e.i||e.c||e.a||e.s||e.g||e.descr}function Ra(e){return e.splice(0)}var Ta=n(25),Sa=n(32),Fa=-1,Na=[],Da=function(e){function t(e){var n;return Object(w.a)(this,t),(n=Object(_.a)(this,Object(R.a)(t).call(this,e))).renderPaymentsHeaderT=function(){return n.state.values&&0!==n.state.values.length?r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{className:n.thClassName("check")},r.a.createElement(ee,{id:"check_all",onValueChanged:n.setValueCheckAllF,checked:n.state.allChecked,readOnly:!1,field:"check_all",index:-2,touched:!1})),r.a.createElement("th",{className:n.thClassName("l")}),n.th("d","Date"),n.drawBalanceF()?n.th("b","Balance",!1):null,n.th("i","Pay"),n.th("s",r.a.createElement(Ta,{name:"pie-chart",size:"lg"}),!1),n.th("g",r.a.createElement(Ta,{name:"paperclip",size:"lg"})),n.th("c","Issue"),n.th("a","Account"),n.th("descr","Description"),r.a.createElement("th",{className:n.thClassName("deleted")},r.a.createElement(Ta,{name:"remove",style:{color:"red"}})),r.a.createElement("th",null))):r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null)))},n.renderControls=function(){return r.a.createElement(S.a,{id:"ctrls-panel",expanded:n.state.recurring.recur,onToggle:function(){}},r.a.createElement(S.a.Heading,null,r.a.createElement(S.a.Title,null,r.a.createElement(P.a,{onClick:function(){return n.resetT()},disabled:n.pristine,bsStyle:n.pristine?"default":"primary"},"Reset"),r.a.createElement(P.a,{onClick:function(){return n.preSubmitT()},disabled:n.pristine||null!=n.errors,bsStyle:n.pristine?"default":"primary"},"Save"),r.a.createElement(P.a,{onClick:function(){return n.addR()}},0===n.state.values.length?"New":n.state.recurring.recur?"Recur last":"Copy last"),r.a.createElement("span",{style:{marginTop:"6px"}},r.a.createElement(S.a.Toggle,{componentClass:"button",className:"link-button",onClick:n.setRecurring},n.state.values&&0!==n.state.values.length?n.state.recurring.recur?"No recur":"Recurring...":"")))),r.a.createElement(S.a.Collapse,null,r.a.createElement(S.a.Body,null,r.a.createElement("span",{style:{display:"inline-flex"}},r.a.createElement(an.SimpleSelect,{style:{width:"170px"},onValueChange:n.setRecurringSpan,placeholder:"choose span",options:wa,value:n.state.recurring.span,hideResetButton:!0}),r.a.createElement(ha.a,{id:"recurringTimes",min:1,step:1,precision:0,max:365,value:n.state.recurring.times,onChange:n.setRecurringTimes}),r.a.createElement("span",{style:{marginTop:"6px"}},"times.")))))},n.renderNarrowT=function(){return n.sortedValues.map(function(e){return r.a.createElement(V.a,{id:"payments_table_s",bordered:!0,condensed:!0},r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",{className:"field_value"},n.renderContentF("l",e.index)),r.a.createElement("td",{className:"field_value"},r.a.createElement("span",{style:{float:"right"}},r.a.createElement("div",{style:{display:"inline-flex",whiteSpace:"nowrap",alignItems:"center"}},"mark ",n.renderContentF("check",e.index),r.a.createElement(Ta,{name:"remove",style:{color:"red"}}),n.renderDeletedContentF(e.index))))),r.a.createElement("tr",null,r.a.createElement("td",{className:"field_name"},r.a.createElement("span",{style:{float:"right"}},"Date")),r.a.createElement("td",{className:n.tdClassName(e.index,"d")},n.renderContentF("d",e.index))),r.a.createElement("tr",null,r.a.createElement("td",{className:"field_name"},r.a.createElement("span",{style:{float:"right"}},"Sum")),r.a.createElement("td",{className:n.tdClassName(e.index,"i")},n.renderContentF("i",e.index))),r.a.createElement("tr",null,r.a.createElement("td",{className:"field_name"},r.a.createElement("span",{style:{float:"right"}},"In ",r.a.createElement(Ta,{name:"pie-chart",size:"lg"}))),r.a.createElement("td",{className:n.tdClassName(e.index,"s")},n.renderContentF("s",e.index))),r.a.createElement("tr",null,r.a.createElement("td",{className:"field_name"},r.a.createElement("span",{style:{float:"right"}},"Issue")),r.a.createElement("td",{className:n.tdClassName(e.index,"c")},n.renderContentF("c",e.index))),r.a.createElement("tr",null,r.a.createElement("td",{className:"field_name"},r.a.createElement("span",{style:{float:"right"}},r.a.createElement(Ta,{name:"paperclip",size:"lg"}))),r.a.createElement("td",{className:n.tdClassName(e.index,"g")},n.renderContentF("g",e.index))),r.a.createElement("tr",null,r.a.createElement("td",{className:"field_name"},r.a.createElement("span",{style:{float:"right"}},"Account")),r.a.createElement("td",{className:n.tdClassName(e.index,"d")},n.renderContentF("a",e.index))),r.a.createElement("tr",null,r.a.createElement("td",{className:"field_name"},r.a.createElement("span",{style:{float:"right"}},"Descr")),r.a.createElement("td",{className:n.tdClassName(e.index,"descr")},n.renderContentF("descr",e.index)))))})},n.renderNormalT=function(){return r.a.createElement(V.a,{id:"payments_table",striped:!0,bordered:!0,hover:!0,condensed:!0},n.renderPaymentsHeaderT(),r.a.createElement("tbody",null,n.sortedValues.map(function(e){return n.renderPaymentR(e.index)})))},n.renderPaymentsT=function(e){return n.sortedValues=n.state.values.slice(0),n.state.sort&&n.sortedValues.sort(n.sortersF()),r.a.createElement("div",null,n.renderControls(),"narrow"===e?n.renderNarrowT():n.renderNormalT())},n.showAlert=n.showAlert.bind(Object(D.a)(Object(D.a)(n))),n.showOk=n.showOk.bind(Object(D.a)(Object(D.a)(n))),n.changePropertyF=n.changePropertyF.bind(Object(D.a)(Object(D.a)(n))),n.changePropertyDeletedF=n.changePropertyDeletedF.bind(Object(D.a)(Object(D.a)(n))),n.changePropertyLF=n.changePropertyLF.bind(Object(D.a)(Object(D.a)(n))),n.setValueF=n.setValueF.bind(Object(D.a)(Object(D.a)(n))),n.setValueCheckF=n.setValueCheckF.bind(Object(D.a)(Object(D.a)(n))),n.setValueCheckAllF=n.setValueCheckAllF.bind(Object(D.a)(Object(D.a)(n))),n.setValueMaskF=n.setValueMaskF.bind(Object(D.a)(Object(D.a)(n))),n.setValueMaskCheckF=n.setValueMaskCheckF.bind(Object(D.a)(Object(D.a)(n))),n.validateF=n.validateF.bind(Object(D.a)(Object(D.a)(n))),n.validateMaskF=n.validateMaskF.bind(Object(D.a)(Object(D.a)(n))),n.maskedF=n.maskedF.bind(Object(D.a)(Object(D.a)(n))),n.touchedF=n.touchedF.bind(Object(D.a)(Object(D.a)(n))),n.isDifferentFromInitialF=n.isDifferentFromInitialF.bind(Object(D.a)(Object(D.a)(n))),n.drawBalanceF=n.drawBalanceF.bind(Object(D.a)(Object(D.a)(n))),n.chooseValueF=n.chooseValueF.bind(Object(D.a)(Object(D.a)(n))),n.renderContentF=n.renderContentF.bind(Object(D.a)(Object(D.a)(n))),n.renderDeletedContentF=n.renderDeletedContentF.bind(Object(D.a)(Object(D.a)(n))),n.setSortF=n.setSortF.bind(Object(D.a)(Object(D.a)(n))),n.sortersF=n.sortersF.bind(Object(D.a)(Object(D.a)(n))),n.addR=n.addR.bind(Object(D.a)(Object(D.a)(n))),n.getDefaultR=n.getDefaultR.bind(Object(D.a)(Object(D.a)(n))),n.removeR=n.removeR.bind(Object(D.a)(Object(D.a)(n))),n.setRecurring=n.setRecurring.bind(Object(D.a)(Object(D.a)(n))),n.setRecurringTimes=n.setRecurringTimes.bind(Object(D.a)(Object(D.a)(n))),n.setRecurringSpan=n.setRecurringSpan.bind(Object(D.a)(Object(D.a)(n))),n.validateR=n.validateR.bind(Object(D.a)(Object(D.a)(n))),n.readOnlyR=n.readOnlyR.bind(Object(D.a)(Object(D.a)(n))),n.isPersistedR=n.isPersistedR.bind(Object(D.a)(Object(D.a)(n))),n.disabledCheckR=n.disabledCheckR.bind(Object(D.a)(Object(D.a)(n))),n.renderPaymentR=n.renderPaymentR.bind(Object(D.a)(Object(D.a)(n))),n.resetT=n.resetT.bind(Object(D.a)(Object(D.a)(n))),n.isPristineT=n.isPristineT.bind(Object(D.a)(Object(D.a)(n))),n.hasErrorsT=n.hasErrorsT.bind(Object(D.a)(Object(D.a)(n))),n.preInitT=n.preInitT.bind(Object(D.a)(Object(D.a)(n))),n.preSubmitT=n.preSubmitT.bind(Object(D.a)(Object(D.a)(n))),n.init=n.init.bind(Object(D.a)(Object(D.a)(n))),n.renderPaymentsHeaderT=n.renderPaymentsHeaderT.bind(Object(D.a)(Object(D.a)(n))),n.renderPaymentsT=n.renderPaymentsT.bind(Object(D.a)(Object(D.a)(n))),n.renderNormalT=n.renderNormalT.bind(Object(D.a)(Object(D.a)(n))),n.renderNarrowT=n.renderNarrowT.bind(Object(D.a)(Object(D.a)(n))),n.renderControls=n.renderControls.bind(Object(D.a)(Object(D.a)(n))),n.tdClassName=n.tdClassName.bind(Object(D.a)(Object(D.a)(n))),n.td=n.td.bind(Object(D.a)(Object(D.a)(n))),n.thClassName=n.thClassName.bind(Object(D.a)(Object(D.a)(n))),n.th=n.th.bind(Object(D.a)(Object(D.a)(n))),n.groupLoad=n.groupLoad.bind(Object(D.a)(Object(D.a)(n))),n.dayLoad=n.dayLoad.bind(Object(D.a)(Object(D.a)(n))),n.showHistory=n.showHistory.bind(Object(D.a)(Object(D.a)(n))),n.init(),n.state=Object(N.a)({},xa(n.preInitT(e.initPayments),Na),{historyShow:!1}),n}return Object(T.a)(t,e),Object(x.a)(t,[{key:"showAlert",value:function(){this.msg.show("SAVE YOUR CHANGES, OR RESET FIRST!",{time:5e3,type:"success",icon:r.a.createElement("img",{src:"stop.png",alt:"SAVE YOUR CHANGES, OR RESET FIRST!"})})}},{key:"showOk",value:function(){this.msg.show("SAVED SUCCESSFULLY",{time:2e3,type:"success",icon:r.a.createElement("img",{src:"yes.png",alt:"save ok"})})}},{key:"changePropertyF",value:function(e,t,n){if(-1!==n){if(-2===n)return this.validateMaskF(t,e),void this.setValueMaskF(t,e);if(this.isPersistedR(n)){var a=Ra(this.state.touched);a[n][t]=this.isDifferentFromInitialF(e,t,n),this.setState({touched:a})}this.state.masked[t]||this.validateF(t,e,n),this.setValueF(e,t,n)}else this.setValueMaskCheckF(t,e)}},{key:"changePropertyDeletedF",value:function(e,t,n){if(this.isPersistedR(n)){this.deleteCount+=e?1:-1;var a=Ra(this.state.deleted);a[n]=e,this.setValueCheckF(!1,"check",n),this.setState({deleted:a})}else this.removeR(n)}},{key:"changePropertyLF",value:function(e,t,n){var a=Ra(this.state.values);a[n].l=e;var r=Ra(this.state.initial);r[n].l=e,this.setState({values:a,initial:r})}},{key:"setValueF",value:function(e,t,n){var a=Ra(this.state.values);a[n][t]=e,this.setState({values:a})}},{key:"setValueCheckF",value:function(e,t,n){this.updateCheckedSet(e,n),this.setValueF(e,"check",n),this.props.paymentSelection(Na.slice(0))}},{key:"setValueCheckAllF",value:function(e,t,n){var a=this,r=this.state.values.slice(0);r.map(function(t){return a.updateCheckedSet(e,t.index,r),null}),this.setState({values:r,allChecked:e}),this.props.paymentSelection(Na.slice(0))}},{key:"setValueMaskF",value:function(e,t){var n=Object(N.a)({},this.state.maskValues);n[e]=t,this.setState({maskValues:n})}},{key:"setValueMaskCheckF",value:function(e,t){var n=Object(N.a)({},this.state.masked);n[e]=t,this.setState({masked:n}),(n=Object(N.a)({},this.state.maskErrors))[e]=t?Oa[e](this.state.maskValues[e]):null,this.setState({maskErrors:n});var a=Ra(this.state.errors);this.state.values.forEach(function(n,r){a[r][e]=t?null:Oa[e](n[e])}),this.setState({errors:a})}},{key:"validateF",value:function(e,t,n){var a=this.state.errors[n][e];if(Oa[e](t)!==a){var r=Ra(this.state.errors);r[n][e]=Oa[e](t),this.setState({errors:r})}}},{key:"validateMaskF",value:function(e,t){var n=Object(N.a)({},this.state.maskErrors);n[e]=this.state.masked[e]?Oa[e](t):null,this.setState({maskErrors:n})}},{key:"maskedF",value:function(e,t){return!(e<0||this.state.deleted[e])&&(this.state.masked[t]&&!this.state.values[e].l)}},{key:"touchedF",value:function(e,t){return!(e<0)&&(!this.state.deleted[e]&&(!(this.maskedF(e,t)&&this.isPersistedR(e)&&!this.isDifferentFromInitialF(this.state.maskValues[t],t,e))&&(!!this.maskedF(e,t)||!!this.isPersistedR(e)&&this.state.touched[e][t])))}},{key:"isDifferentFromInitialF",value:function(e,t,n){return e!==this.state.initial[n][t]}},{key:"chooseValueF",value:function(e,t){return this.state.deleted[e]?this.state.initial[e][t]:this.maskedF(e,t)?this.state.maskValues[t]:this.state.values[e][t]}},{key:"renderContentF",value:function(e,t){if(-1===t)return r.a.createElement("div",null,r.a.createElement(ee,{id:e+"_mask_check",onValueChanged:this.changePropertyF,checked:this.state.masked[e],readOnly:!1,field:e,index:-1}));if(-2!==t||this.state.masked[e]){var n=null;switch(n=-2===t?this.state.maskValues[e]:this.chooseValueF(t,e),e){case"check":return r.a.createElement("div",null,r.a.createElement(ee,{id:"check_"+t,onValueChanged:this.setValueCheckF,checked:n,readOnly:this.disabledCheckR(t),field:"check",index:t,touched:!1}));case"l":return r.a.createElement("div",null,r.a.createElement($n,{id:this.state.values[t].id,onValueChanged:this.changePropertyLF,checked:n,readOnly:!this.isPersistedR(t)||this.state.deleted[t]||_a(this.state.masked)||_a(this.state.touched[t]),field:"l",index:t}));case"d":return r.a.createElement("div",null,r.a.createElement(ua,{id:"d_"+t,onValueChanged:this.changePropertyF,value:n,readOnly:this.readOnlyR(t,"d"),field:"d",index:t,touched:this.touchedF(t,"d"),linkCb:"d"!==this.props.queryType&&-2!==t&&this.isPristineT()?this.dayLoad:null,popoverText:"Show day "+n}));case"b":return r.a.createElement("div",null,r.a.createElement(aa,{value:""+this.chooseValueF(t,"b"),field:"b",readOnly:!0,touched:!1,linkCb:-2===t?null:this.props.calculatorAdd}));case"i":return r.a.createElement("div",null,r.a.createElement(aa,{id:"i_"+t,onValueChanged:this.changePropertyF,placeholder:"amount",value:n,readOnly:this.readOnlyR(t,"i"),field:"i",index:t,touched:this.touchedF(t,"i"),linkCb:-2===t?null:this.props.calculatorAdd,popoverText:"Add to calculator"}));case"s":return r.a.createElement("div",null,r.a.createElement(ee,{id:"s_"+t,onValueChanged:this.changePropertyF,checked:n,readOnly:this.readOnlyR(t,"s"),field:"s",index:t,touched:this.touchedF(t,"s")}));case"g":return r.a.createElement("div",null,r.a.createElement(la,{id:"g_"+t,onValueChanged:this.changePropertyF,value:n,readOnly:this.readOnlyR(t,"g"),field:"g",index:t,touched:this.touchedF(t,"g"),placeholder:"gId",linkCb:"g"!==this.props.queryType&&-2!==t&&this.isPristineT()?this.groupLoad:null,popoverText:'Show all in group "'+n+'"',maxLength:15}));case"c":return r.a.createElement("div",null,r.a.createElement(ia,{onValueChanged:this.changePropertyF,value:n,readOnly:this.readOnlyR(t,e),placeholder:"select",field:"c",index:t,touched:this.touchedF(t,e),constants_id:"cat"}));case"a":return r.a.createElement("div",{style:{display:"inline-flex",whiteSpace:"nowrap"}},r.a.createElement(ia,{onValueChanged:this.changePropertyF,value:n,readOnly:this.readOnlyR(t,e),placeholder:"select",field:"a",index:t,touched:this.touchedF(t,e),constants_id:"acc"}));case"descr":return r.a.createElement("div",null,r.a.createElement(ae,{id:"descr_"+t,onValueChanged:this.changePropertyF,value:n,readOnly:this.readOnlyR(t,"descr"),field:"descr",index:t,touched:this.touchedF(t,"descr"),placeholder:"description",maxLength:50}));default:return console.log("UNKONWN field: "+e),null}}}},{key:"renderDeletedContentF",value:function(e){var t=this;return this.isPersistedR(e)?r.a.createElement("div",null,r.a.createElement(ee,{id:"deleted_"+e,onValueChanged:this.changePropertyDeletedF,checked:this.state.deleted[e],readOnly:this.state.values[e].l,field:"deleted",index:e,touched:!1})):r.a.createElement("button",{type:"button",className:"form-control",onClick:function(){return t.changePropertyDeletedF(!0,"deleted",e)}},r.a.createElement(Ta,{name:"remove",style:{color:"red"}}))}},{key:"setSortF",value:function(e){this.state.sort&&this.state.sort===e?this.state.sort===e&&this.state.asc?this.setState({asc:!1}):this.setState({sort:null}):this.setState({sort:e,asc:!0})}},{key:"sortersF",value:function(){var e=this,t=this.state.asc?-1:1;switch(this.state.sort){case"i":case"a":case"c":return function(n,a){return t*(e.chooseValueF(a.index,e.state.sort)-e.chooseValueF(n.index,e.state.sort))};case"d":return function(n,a){return t*(ht(e.chooseValueF(a.index,"d")).getTime()-ht(e.chooseValueF(n.index,"d")).getTime())};case"g":return function(n,a){var r=e.chooseValueF(n.index,"g").toUpperCase(),i=e.chooseValueF(a.index,"g").toUpperCase();return t*(r<i?-1:r>i?1:0)};default:return function(e,t){return 0}}}},{key:"addR",value:function(){var e=this.getDefaultR(),t=Ra(this.state.values),n=Ra(this.state.errors),a=1;this.state.recurring.recur&&(a=this.state.recurring.times);for(var r=0;r<a;r++)(e=Ca(e,[])).id=Fa--,e.index=t.length,e.l=!1,e.check=!1,this.state.recurring.recur&&fa(e,r,this.state.recurring.span.value),t.push(e),this.sortedValues.push(e),n.push(this.validateR(e));this.setState({values:t,errors:n})}},{key:"setRecurring",value:function(){this.setState({recurring:Object(N.a)({},this.state.recurring,{recur:!this.state.recurring.recur})})}},{key:"setRecurringTimes",value:function(e){this.setState({recurring:Object(N.a)({},this.state.recurring,{times:e})})}},{key:"setRecurringSpan",value:function(e){this.setState({recurring:Object(N.a)({},this.state.recurring,{span:e})})}},{key:"getDefaultR",value:function(){var e=va;return this.sortedValues.length?e=this.sortedValues[this.sortedValues.length-1]:e.d=Sa(this.props.defaultDate,"dd.mm.yyyy"),Object(N.a)({},e)}},{key:"removeR",value:function(e){this.state.values.splice(e,1);var t=Ra(this.state.values);this.state.errors.splice(e,1);for(var n=Ra(this.state.errors),a=e;a<t.length;a++)t[a].index--,n[a].index--;this.setState({values:t,errors:n})}},{key:"validateR",value:function(e){var t={};return ya.forEach(function(n){t[n]=Oa[n](e[n])}),t}},{key:"readOnlyR",value:function(e,t){return!(e<0)&&(this.state.masked[t]||this.state.deleted[e]||this.state.values[e].l)}},{key:"isPersistedR",value:function(e){return this.state.values[e].id>=0}},{key:"disabledCheckR",value:function(e){return!this.isPersistedR(e)||this.state.deleted[e]}},{key:"renderPaymentR",value:function(e){var t=this;return r.a.createElement("tr",{key:e},["check","l"].concat(Object(F.a)(ya)).map(function(n){return t.td(e,n)}),r.a.createElement("td",{className:this.tdClassName(e,"deleted")},this.renderDeletedContentF(e)),r.a.createElement("td",null,r.a.createElement(P.a,{variant:"primary",onClick:function(){return t.showHistory(t.chooseValueF(e,"id"))}},r.a.createElement(Ta,{name:"history"}))))}},{key:"resetT",value:function(){var e=xa(this.state.initial,Na,this.state.recurring);this.setState(Object(N.a)({},e)),this.init()}},{key:"isPristineT",value:function(){var e=!0;return this.state.touched.forEach(function(t){ya.forEach(function(n){e=e&&!t[n]})}),e&&this.state.initial.length===this.state.values.length&&!_a(this.state.masked)&&!this.deleteCount}},{key:"hasErrorsT",value:function(){var e=!1;return this.state.errors.forEach(function(t){e=e||_a(t)}),e||_a(this.state.maskErrors)}},{key:"preInitT",value:function(e){return Ea(e,Na)}},{key:"preSubmitT",value:function(){var e=this,t=[];this.state.values.forEach(function(n,a){if(!e.isPersistedR(a)){var r={};ya.forEach(function(t){r[t]=e.chooseValueF(a,t)}),t.push(r)}});var n=[];this.state.deleted.forEach(function(t,a){t&&n.push(e.state.values[a].id)});var a=[];this.state.values.forEach(function(t,n){if(e.isPersistedR(n)){var r={};ya.forEach(function(a){e.touchedF(n,a)&&(r.id=t.id,r[a]=e.chooseValueF(n,a))}),Object.keys(r).length>0&&a.push(r)}});var r={created:ja(t),deleted:n,modified:ja(a)};this.pristine=null,this.props.update(r),this.showOk()}},{key:"init",value:function(){this.deleteCount=0,this.pristine=null,this.errors=null,this.allChecked=!1}},{key:"tdClassName",value:function(e,t){return t+"_cell"+(this.isPersistedR(e)?"":" newRow")+(this.state.deleted[e]?" deleted":"")+(this.state.values[e].check?" selected":"")+(this.state.errors[e][t]?" error":"")}},{key:"drawBalanceF",value:function(){return"a"===this.props.queryType&&this.pristine}},{key:"td",value:function(e,t){if("b"!==t||this.drawBalanceF())return r.a.createElement("td",{key:e+"_"+t,className:this.tdClassName(e,t)},this.renderContentF(t,e))}},{key:"thClassName",value:function(e){return e+"_header"+(this.state.maskErrors[e]?" error":"")+(_a(this.state.masked)?" header_tall":"")}},{key:"th",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!(!(arguments.length>2&&void 0!==arguments[2])||arguments[2]))return r.a.createElement("th",{className:this.thClassName(e)},r.a.createElement("div",null,r.a.createElement("span",{style:{display:"flex"}},r.a.createElement("div",{style:{marginTop:8,textDecoration:"none"},className:"link-button"},null!==n?n:""))));var a=r.a.createElement(Ta,{name:this.state.asc?"sort-asc":"sort-desc"}),i=r.a.createElement("div",null,this.state.sort===e?a:""),s=r.a.createElement("div",{style:{marginTop:8}},r.a.createElement("button",{type:"button",className:"link-button",onClick:function(){t.setSortF(e)}},n));return r.a.createElement("th",{className:this.thClassName(e)},r.a.createElement("div",null,r.a.createElement("span",{style:{display:"flex"}},this.renderContentF(e,-1),r.a.createElement("div",{style:{marginTop:8,paddingRight:3}},i),null!==n?s:"")),this.renderContentF(e,-2))}},{key:"componentWillReceiveProps",value:function(e){this.init(),this.setState(Object(N.a)({},xa(this.preInitT(e.initPayments),Na)))}},{key:"updateCheckedSet",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!(t<0||this.disabledCheckR(t))){var a=Na.indexOf(this.state.values[t].id);e&&a<0&&Na.push(this.state.values[t].id),!e&&a>-1&&Na.splice(a,1),n&&(n[t].check=e)}}},{key:"groupLoad",value:function(e){this.pristine&&e&&e.length>0&&this.props.groupLoad(e)}},{key:"dayLoad",value:function(e){this.pristine&&e&&e.length>0&&this.props.dayLoad(ht(e))}},{key:"showHistory",value:function(e){this.props.historyLoad(e),this.setState({historyShow:!0})}},{key:"render",value:function(){var e=this;return this.pristine=this.isPristineT(),this.errors=this.hasErrorsT(),r.a.createElement("div",null,r.a.createElement(ue.a,Object.assign({ref:function(t){return e.msg=t}},de)),r.a.createElement(dn.a,{query:"(max-width: 734px)"},function(t){return t?e.renderPaymentsT("narrow"):e.renderPaymentsT("wide")}),r.a.createElement(qn,{show:this.state.historyShow,onHide:function(){return e.setState({historyShow:!1})}}),r.a.createElement(Un.a,null,r.a.createElement(Yn.a,null,"Copyright"),r.a.createElement(Bn.a.Static,null,"jhupli@gmail.com")))}}]),t}(r.a.Component);Da.defaultProps={initPayments:[],queryType:null};var Pa=Object(s.b)(null,function(e){return{update:function(t){e(Rn(t))},paymentSelection:function(t){e(Ln(t))},groupLoad:function(t){e(Dn(t))},dayLoad:function(t){e(Sn(t))},historyLoad:function(t){e(it(t))},calculatorAdd:function(t){e(Hn(t))}}})(Da),Va=function(e){function t(e){var n;return Object(w.a)(this,t),(n=Object(_.a)(this,Object(R.a)(t).call(this,e))).state={payments:[],balances:[]},n}return Object(T.a)(t,e),Object(x.a)(t,[{key:"render",value:function(){return r.a.createElement(Pa,{initPayments:this.props.payments,queryType:this.props.queryType,defaultDate:this.props.defaultDate})}}]),t}(r.a.Component);Va.defaultProps={defaultDate:new Date};var Aa=Object(s.b)(function(e){return{queryType:e.payments.queryType,payments:e.payments.payments,balances:e.payments.balances}})(Va),Ma=n(600),Ia=function(e){function t(e){var n;return Object(w.a)(this,t),(n=Object(_.a)(this,Object(R.a)(t).call(this,e))).list=n.list.bind(Object(D.a)(Object(D.a)(n))),n}return Object(T.a)(t,e),Object(x.a)(t,[{key:"list",value:function(){this.props.listLoad(this.props.payments)}},{key:"render",value:function(){return 0===this.props.payments.length?null:r.a.createElement(P.a,{onClick:this.list},r.a.createElement(Ma.a,null,this.props.payments.length))}}]),t}(r.a.Component);Ia.defaultProps={payments:[]};var La=Object(s.b)(function(e){return{payments:e.payment.payments}},function(e){return{listLoad:function(t){e(Pn(t))}}})(Ia),Ha=n(32);function Ua(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(t){var i=Ha(e,"yyyymmdd")+"T00",s=function(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return n;return-1}(t[0],function(e){return i===e});if(s<0)return null;var l=[];return t.forEach(function(e,t){if(1===t&&l.push(r.a.createElement("tr",{className:"c3-tooltip-name--data2",key:-1},r.a.createElement("td",{className:"name"},r.a.createElement("span",{style:{backgroundColor:"green"}})),r.a.createElement("td",{className:"value"},he(e[s])))),2===t&&l.push(r.a.createElement("tr",{className:"c3-tooltip-name--data2",key:-2},r.a.createElement("td",{className:"name"},r.a.createElement("span",{style:{backgroundColor:"red"}})),r.a.createElement("td",{className:"value"},he(e[s])))),t>=3){var a=rn(n.acc,function(t){return e[0]===""+t.value});l.push(r.a.createElement("tr",{className:"c3-tooltip-name--data2",key:a.value},r.a.createElement("td",{className:"name"},r.a.createElement("span",{style:{backgroundColor:a.color}})),r.a.createElement("td",{className:"value"},he(e[s]))))}}),r.a.createElement("table",{className:"c3-tooltip"},r.a.createElement("tbody",null,a?r.a.createElement("th",{colSpan:"2"},Ha(e,"dd.mm.yyyy ddd")):null,l))}}var Ya=n(25),Ba=function(e){function t(e){var n;return Object(w.a)(this,t),(n=Object(_.a)(this,Object(R.a)(t).call(this,e))).prevDay=n.prevDay.bind(Object(D.a)(Object(D.a)(n))),n}return Object(T.a)(t,e),Object(x.a)(t,[{key:"prevDay",value:function(){this.props.chartPrevDay()}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(P.a,{onClick:this.prevDay},r.a.createElement(Ya,{name:"caret-left"})))}}]),t}(r.a.Component);var Wa=Object(s.b)(null,function(e){return{chartPrevDay:function(){e(Ae())}}})(Ba),za=n(25),qa=function(e){function t(e){var n;return Object(w.a)(this,t),(n=Object(_.a)(this,Object(R.a)(t).call(this,e))).nextDay=n.nextDay.bind(Object(D.a)(Object(D.a)(n))),n}return Object(T.a)(t,e),Object(x.a)(t,[{key:"nextDay",value:function(){this.props.chartNextDay()}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(P.a,{onClick:this.nextDay},r.a.createElement(za,{name:"caret-right"})))}}]),t}(r.a.Component);var Ga=Object(s.b)(null,function(e){return{chartNextDay:function(){e(Ve())}}})(qa),Qa=function(e){function t(e){var n;return Object(w.a)(this,t),(n=Object(_.a)(this,Object(R.a)(t).call(this,e))).today=n.today.bind(Object(D.a)(Object(D.a)(n))),n}return Object(T.a)(t,e),Object(x.a)(t,[{key:"today",value:function(){this.props.chartToday()}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(P.a,{onClick:this.today},"Today"))}}]),t}(r.a.Component);var Ka=Object(s.b)(null,function(e){return{chartToday:function(){e(Me())}}})(Qa),Ja=(n(573),n(25)),Xa=function(e){function t(e){var n;return Object(w.a)(this,t),(n=Object(_.a)(this,Object(R.a)(t).call(this,e))).changeValue=n.changeValue.bind(Object(D.a)(Object(D.a)(n))),n.newRow=n.newRow.bind(Object(D.a)(Object(D.a)(n))),n.clear=n.clear.bind(Object(D.a)(Object(D.a)(n))),n.state={rows:[]},n}return Object(T.a)(t,e),Object(x.a)(t,[{key:"changeValue",value:function(e,t,n){console.log("changePropertyF: "+e+" index:"+n);var a=this.state.rows.slice();a[n]=e,this.setState({rows:a})}},{key:"newRow",value:function(){var e=this.state.rows.slice();e.push("0.00"),this.setState({rows:e})}},{key:"componentWillReceiveProps",value:function(e){if(e.ts!==this.props.ts){var t=this.state.rows.slice();t.push(e.p),this.setState({rows:t})}}},{key:"clear",value:function(){this.setState({rows:[]})}},{key:"render",value:function(){var e=this,t=0;return this.state.rows.map(function(e){return t+=Number(e),null}),r.a.createElement("div",null,r.a.createElement(S.a,null,r.a.createElement(S.a.Heading,{style:{padding:"5px",height:"30px",fontSize:"15px"}},r.a.createElement("span",{className:"pull-right",style:{display:"inline-flex"}},he(t))),r.a.createElement(S.a.Body,{style:{padding:"2px"}},0===this.state.rows.length?null:r.a.createElement(V.a,{id:"calc_table",style:{marginBottom:"10px"},striped:!0,hover:!0,condensed:!0},r.a.createElement("tbody",{style:{border:"none"}},this.state.rows.map(function(t,n){return r.a.createElement("tr",{key:"calr"+n},r.a.createElement("td",{style:{border:"none",padding:"0px",margin:"0px"}},r.a.createElement(Z,{id:"calcf",onValueChanged:e.changeValue,placeholder:"amount",value:t,readOnly:!1,field:"calc",index:n,touched:!1})))}))),r.a.createElement("span",{className:"pull-right",style:{display:"inline-flex",whiteSpace:"nowrap",marginLeft:"1px"}},r.a.createElement(P.a,{onClick:this.newRow},r.a.createElement(Ja,{name:"plus"})),0===this.state.rows.length?null:r.a.createElement(P.a,{style:{fontStyle:"italic",fontWeight:"bold"},onClick:this.clear},"C")))))}}]),t}(r.a.Component),Za=Object(s.b)(function(e){return{p:e.calculator.p,ts:e.calculator.ts}})(Xa),$a=n(32),er=n(25),tr=function(e){function t(e){var n;return Object(w.a)(this,t),(n=Object(_.a)(this,Object(R.a)(t).call(this,e))).state={accs:e.getConstants("acc"),cats:e.getConstants("cat"),refreshTime:null,start:null,end:null},n.defaultDate=new Date,n.prevHistory=n.prevHistory.bind(Object(D.a)(Object(D.a)(n))),n.nextHistory=n.nextHistory.bind(Object(D.a)(Object(D.a)(n))),n}return Object(T.a)(t,e),Object(x.a)(t,[{key:"componentWillReceiveProps",value:function(e){if(e.constants&&e.constants.acc&&this.setState({accs:e.constants.acc}),e.constants&&e.constants.cat&&this.setState({accs:e.constants.cat}),null==this.state.start&&null!=e.start)this.setState({start:e.start,end:e.end});else if(this.state.start!=e.start||this.state.end!=e.end)switch(this.setState({start:e.start,end:e.end}),this.props.queryType){case"d":break;case"a":this.props.accountLoad(this.props.params.a,e.start,e.end);break;case"c":this.props.categoryLoad(this.props.params.c,e.start,e.end)}}},{key:"prevHistory",value:function(){this.props.prevInHistory()}},{key:"nextHistory",value:function(){this.props.nextInHistory()}},{key:"render",value:function(){var e=this,t="";switch(this.props.queryType){case"d":t=r.a.createElement("span",{style:{display:"inline-flex",whiteSpace:"nowrap",alignItems:"center",marginRight:"5px",marginLeft:"5px"}},r.a.createElement(Wa,null),r.a.createElement("div",{style:{marginRight:"5px",marginLeft:"5px"}},$a(this.props.params.d,"dd.mm.yyyy ddd")),r.a.createElement(Ga,null)),this.defaultDate=this.props.params.d;break;case"a":var n=rn(this.props.constants.acc,function(t){return e.props.params.a===""+t.value});t=r.a.createElement("span",null,r.a.createElement("span",{style:{marginRight:"5px",marginLeft:"5px"}},"Account : ",r.a.createElement(er,{name:"square",style:{color:n.color}})),r.a.createElement("span",null,n.label+" ("+$a(this.props.params.d1,"dd.mm.yyyy ddd")+" - "+$a(this.props.params.d2,"dd.mm.yyyy ddd")+")"));break;case"c":var a=rn(this.props.constants.cat,function(t){return e.props.params.c===""+t.value});t=r.a.createElement("span",null,r.a.createElement("span",{style:{marginRight:"5px",marginLeft:"5px"}},"Issue : ",r.a.createElement(er,{name:"square",style:{color:a.color}})),r.a.createElement("span",null,a.label+" ("+$a(this.props.params.d1,"dd.mm.yyyy ddd")+" - "+$a(this.props.params.d2,"dd.mm.yyyy ddd")+")"));break;case"g":t=r.a.createElement("span",null,"\xa0",r.a.createElement(er,{name:"paperclip",size:"lg"}),"  ",this.props.params.g);break;case"l":t="Checked";break;default:t=""}var i=null;"d"===this.props.queryType&&this.props.curves&&null!==(i=Ua(this.props.params.d,this.props.curves,this.props.constants))&&(i=r.a.createElement("div",{style:{paddingBottom:"4px"}},i));var s=null==this.props.historystack||null==this.props.historystack.first||this.props.historystack.first,l=null==this.props.historystack||null==this.props.historystack.last||this.props.historystack.last,c=r.a.createElement(S.a.Heading,{style:{paddingTop:"5px",paddingBottom:"3px",height:"45px"}},r.a.createElement("div",{style:{display:"inline-flex",whiteSpace:"nowrap",alignItems:"center",fontSize:"23px"}},r.a.createElement(er,{name:"th-list"})," ",r.a.createElement("span",{style:{fontSize:"15px"}},t),r.a.createElement(La,null),r.a.createElement(at,{fetching:this.props.fetching})),r.a.createElement("span",{className:"pull-right",style:{display:"inline-flex"}},r.a.createElement(Ka,null),r.a.createElement(P.a,{style:{borderRadius:"20px",height:"35px",paddingTop:"2px",color:s?"gray":"darkblue"},onClick:this.prevHistory,disabled:s},r.a.createElement(er,{name:"arrow-circle-left",size:"2x",color:"blue"})),r.a.createElement(P.a,{style:{borderRadius:"20px",height:"35px",paddingTop:"2px",color:l?"gray":"darkblue"},disabled:l,onClick:this.nextHistory},r.a.createElement(er,{name:"arrow-circle-right",size:"2x",color:"blue"})))),o=r.a.createElement(S.a.Heading,{style:{paddingTop:"5px",paddingBottom:"3px",height:"80px"}},r.a.createElement("div",{style:{display:"inline-flex",whiteSpace:"nowrap",alignItems:"center",fontSize:"23px"}},r.a.createElement(er,{name:"th-list"})," ",r.a.createElement("span",{style:{fontSize:"15px"}},t),r.a.createElement(La,null),r.a.createElement(at,{fetching:this.props.fetching})),r.a.createElement("span",{style:{display:"inline-flex"}},r.a.createElement(Ka,null),r.a.createElement(P.a,{style:{borderRadius:"20px",height:"35px",paddingTop:"2px",color:s?"gray":"darkblue"},onClick:this.prevHistory,disabled:s},r.a.createElement(er,{name:"arrow-circle-left",size:"2x",color:"blue"})),r.a.createElement(P.a,{style:{borderRadius:"20px",height:"35px",paddingTop:"2px",color:l?"gray":"darkblue"},disabled:l,onClick:this.nextHistory},r.a.createElement(er,{name:"arrow-circle-right",size:"2x",color:"blue"}))));return r.a.createElement("div",null,r.a.createElement(S.a,{style:{width:"100%"}},r.a.createElement(dn.a,{query:"(max-width: 432px)"},function(e){return e?o:c}),r.a.createElement(S.a.Body,null,r.a.createElement("table",null,r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",{style:{width:"100%",verticalAlign:"top"}},r.a.createElement(Aa,{defaultDate:this.defaultDate})),r.a.createElement("td",{style:{width:"30px",verticalAlign:"top",paddingLeft:"4px"}},i,r.a.createElement(Za,null))))))))}}]),t}(r.a.Component);var nr=Object(s.b)(function(e){return{fetching:e.payments.fetching,queryType:e.payments.queryType,historystack:e.payments.historystack,params:e.payments.params,refreshTime:e.constants.refreshTime,constants:e.constants.constants,curves:e.chart.curves,start:e.daterange.s,end:e.daterange.e}},function(e){return{getConstants:function(t){Q(t,e)},prevInHistory:function(){e(An())},nextInHistory:function(){e(Mn())},accountLoad:function(t,n,a){e(Fn(t,n,a))},categoryLoad:function(t,n,a){e(Nn(t,n,a))}}})(tr),ar=n(81),rr=n.n(ar),ir=n(234),sr=n.n(ir),lr=(n(576),n(102)),cr=n(32),or=-1,ur=!1,dr=function(e){function t(e){var n;Object(w.a)(this,t),n=Object(_.a)(this,Object(R.a)(t).call(this,e));var a=Object(D.a)(Object(D.a)(n));return n.state={start:null,end:null,curves:null,constants:e.getConstants("acc"),refreshTime:null,selectedType:"",nextday:null,prevday:null,today:null,redraw:null},n.boundingRect=null,n.hahlo_ix=null,n.hahlo=null,n.draw=n.draw.bind(Object(D.a)(Object(D.a)(n))),n.dateselect=n.dateselect.bind(Object(D.a)(Object(D.a)(n))),n.paint_dayselection=n.paint_dayselection.bind(Object(D.a)(Object(D.a)(n))),n.nextday=n.nextday.bind(Object(D.a)(Object(D.a)(n))),n.prevday=n.prevday.bind(Object(D.a)(Object(D.a)(n))),n.today=n.today.bind(Object(D.a)(Object(D.a)(n))),n.redraw=n.redraw.bind(Object(D.a)(Object(D.a)(n))),n.legendnames=n.legendnames.bind(Object(D.a)(Object(D.a)(n))),n.onmouseover=n.onmouseover.bind(Object(D.a)(Object(D.a)(n))),n.onmouseover_account=n.onmouseover_account.bind(Object(D.a)(Object(D.a)(n))),n.onmouseout=n.onmouseout.bind(Object(D.a)(Object(D.a)(n))),n.find_ix=n.find_ix.bind(Object(D.a)(Object(D.a)(n))),n.chartDatetoDate=n.chartDatetoDate.bind(Object(D.a)(Object(D.a)(n))),n.tooltip=n.tooltip.bind(Object(D.a)(Object(D.a)(n))),n.c3onRendered=n.c3onRendered.bind(Object(D.a)(Object(D.a)(n))),n.timer=null,n.chart_config={onrendered:n.c3onRendered,bindto:"#chart",grid:{x:{show:!0},y:{show:!0,lines:[{value:0}]}},tooltip:{grouped:!0,contents:function(e,t,n,r){return a.tooltip(e)}},data:{x:"x",onmouseover:function(e){ur&&a.onmouseover(e)},onclick:n.onmouseover,xFormat:"%Y%m%dT%H",columns:null,transition:{duration:500},names:{},colors:{},types:{},type:"bar",groups:[["E","I"]],selection:{}},axis:{x:{type:"timeseries",tick:{culling:{max:10},format:function(e){return cr(e,"dd.mm")}}}},legend:{item:{onclick:function(e){a.onmouseover_account(e)},onmouseover:function(e){!this.transiting&&this.isTargetToShow(e)&&this.api.focus(e),ur&&a.onmouseover_account(e)}}}},n}return Object(T.a)(t,e),Object(x.a)(t,[{key:"tooltip",value:function(e){var t=Ua(e[0].x,this.props.curves,this.props.constants,!0);return sr.a.renderToStaticMarkup(t)}},{key:"onmouseout",value:function(){this.timer&&clearTimeout(this.timer)}},{key:"onmouseover",value:function(e){var t=this;if(ur){if("I"===e.id&&0!==Ct(e.x,this.selectedDate)){this.timer&&clearTimeout(this.timer);this.timer=setTimeout(function(){t.dateselect(e.x)},300)}}else this.dateselect(e.x)}},{key:"chartDatetoDate",value:function(e){var t=e.substring(0,4),n=e.substring(4,6)-1,a=e.substring(6,8);return new Date(t,n,a)}},{key:"find_ix",value:function(e){return this.chart_config.data.columns?Ct(this.chartDatetoDate(this.chart_config.data.columns[0][1]),e):null}},{key:"nextday",value:function(){this.selectedDate&&this.dateselect(jt(this.selectedDate,1))}},{key:"prevday",value:function(){this.selectedDate&&this.dateselect(jt(this.selectedDate,-1))}},{key:"today",value:function(){var e=new Date;this.props.daterangeToday(),this.dateselect(e)}},{key:"redraw",value:function(){this.draw()}},{key:"onmouseover_account",value:function(e){var t=this;if("I"!==e&&"E"!==e){var n=this;this.timer=setTimeout(function(){t.props.accountLoad(e,n.props.start,n.props.end)},300)}}},{key:"dateselect",value:function(e){this.selectedDate=e;var t=this.find_ix(e);null!==t&&-1===t&&(this.props.daterangePrevBlock(),t=this.chart_config.data.columns[0].length-2),null!=t&&t===this.chart_config.data.columns[0].length-1&&(this.props.daterangeNextBlock(),t=0),this.props.dayLoad(e,t),this.paint_dayselection()}},{key:"paint_dayselection",value:function(){if(null!=this.hahlo_ix){var e=cr(jt(this.selectedDate,-1),"yyyymmdd")+"T20",t=cr(this.selectedDate,"yyyymmdd")+"T4";this.chart_config.regions[this.hahlo_ix].start=e,this.chart_config.regions[this.hahlo_ix].end=t,rr.a.generate(this.chart_config)}}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{id:"chart",onMouseOut:function(){return e.onmouseout()}})}},{key:"draw",value:function(){if(this.boundingRect=document.getElementById("chart").getBoundingClientRect(),this.chart_config.data.columns){if(!this.chart_config.regions){this.chart_config.regions=[];for(var e=1;e<this.chart_config.data.columns[0].length;e++)for(var t=3;t<this.chart_config.data.columns.length;t++){var n=cr(jt(this.chartDatetoDate(this.chart_config.data.columns[0][e]),-1),"yyyymmdd")+"T12",a=cr(this.chartDatetoDate(this.chart_config.data.columns[0][e]),"yyyymmdd")+"T12";this.chart_config.regions.push({start:n,end:a,class:this.chart_config.data.columns[t][e]<0?"red":"white"})}if(this.selectedDate){this.hahlo_ix=this.chart_config.regions.length;var r=cr(jt(this.selectedDate,-1),"yyyymmdd")+"T20",i=cr(this.selectedDate,"yyyymmdd")+"T4";this.chart_config.regions.push({start:r,end:i,class:"gray"})}}rr.a.generate(this.chart_config)}}},{key:"c3onRendered",value:function(){var e=this;this.chart_config.data.columns[0].forEach(function(t,n){if(n>0){var a=lr.selectAll("#chart").select(".c3-event-rect-"+(n-1)),r=e.chartDatetoDate(t);a[0][0].onclick=function(){e.dateselect(r)}}})}},{key:"componentWillReceiveProps",value:function(e){if(e.nextday!==this.props.nextday&&this.nextday(),e.prevday!==this.props.prevday&&this.prevday(),e.today!==this.props.today&&this.today(),e.redraw!==this.props.redraw&&this.redraw(),e.selectedType!==this.props.selectedType&&(or=-1),"d"===e.selectedType&&(this.selectedDate=e.params.d,this.paint_dayselection()),e.constants&&e.constants[this.props.constants_id]){var t=e.constants[this.props.constants_id],n=rn(t,function(t){return t.value===e.selectedValue}),a=t.filter(function(e){return e.valid||e===n});this.setState({selectedValue:n,items:a})}if(this.state.start!=e.start||this.state.end!=e.end)this.setState({start:e.start,end:e.end}),this.props.chartLoad(e.start,e.end);else if((e.curves!==this.props.curves||e.refreshTime!==this.props.refreshTime)&&(this.chart_config.data.names={},this.chart_config.data.types={},this.chart_config.data.colors={},this.chart_config.data.columns=e.curves,this.chart_config.regions=null,this.legendnames(e.curves,e.constants),this.chart_config.data.colors.I="green",this.chart_config.data.colors.E="red",e.curves)){for(var r=function(e){return s===""+e.value},i=3;i<e.curves.length;i++){var s=e.curves[i][0],l=rn(e.constants.acc,r);this.chart_config.data.colors[s]=l.color,this.chart_config.data.types[s]="spline"}this.draw()}}},{key:"legendnames",value:function(e,t){if(this.chart_config.data.names.I="Income",this.chart_config.data.names.E="Exp",e)for(var n=function(e){return r===""+e.value},a=3;a<e.length;a++){var r=e[a][0],i=rn(t.acc,n);this.chart_config.data.names[r]=i.label}}}]),t}(r.a.Component);var hr=Object(s.b)(function(e){return{start:e.daterange.s,end:e.daterange.e,curves:e.chart.curves,nextday:e.chart.nextday,prevday:e.chart.prevday,today:e.chart.today,redraw:e.chart.redraw,refreshTime:e.constants.refreshTime,constants:e.constants.constants,selectedType:e.payments.queryType,params:e.payments.params}},function(e){return{chartLoad:function(t,n){or=-1,e(De(t,n))},dayLoad:function(t,n){n!==or&&(or=n,e(Sn(t)))},accountLoad:function(t,n,a){t!==or&&(or=t,e(Fn(t,n,a)))},getConstants:function(t){Q(t,e)},daterangeToday:function(){e(Nt())},daterangeNextBlock:function(){e(St())},daterangePrevBlock:function(){e(Ft())},setDateRange:function(t,n){e(Tt(t,n))}}})(dr),pr=function(e){function t(){return Object(w.a)(this,t),Object(_.a)(this,Object(R.a)(t).apply(this,arguments))}return Object(T.a)(t,e),Object(x.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(S.a,null,r.a.createElement(S.a.Body,null,r.a.createElement(hr,null))))}}]),t}(r.a.Component),mr=Object(s.b)(function(e){return{fetching:e.chart.fetching,start:e.daterange.s,end:e.daterange.e}})(pr),fr={startDate:jt(new Date,-10),endDate:jt(new Date,10)},br=(n(578),n(102)),yr=!1,vr={},gr=function(e){function t(e){var n;Object(w.a)(this,t),n=Object(_.a)(this,Object(R.a)(t).call(this,e));var a=Object(D.a)(Object(D.a)(n));return n.state={constants:e.getConstants("cat"),refreshTime:null,redraw:null},n.draw=n.draw.bind(Object(D.a)(Object(D.a)(n))),n.redraw=n.redraw.bind(Object(D.a)(Object(D.a)(n))),n.onmouseover=n.onmouseover.bind(Object(D.a)(Object(D.a)(n))),n.onmouseout=n.onmouseout.bind(Object(D.a)(Object(D.a)(n))),n.c3onRendered=n.c3onRendered.bind(Object(D.a)(Object(D.a)(n))),n.d3onMouseI=n.d3onMouseI.bind(Object(D.a)(Object(D.a)(n))),n.d3onMouseOutI=n.d3onMouseOutI.bind(Object(D.a)(Object(D.a)(n))),n.d3onMouseE=n.d3onMouseE.bind(Object(D.a)(Object(D.a)(n))),n.d3onMouseOutE=n.d3onMouseOutE.bind(Object(D.a)(Object(D.a)(n))),n.getBoudingRect=n.getBoudingRect.bind(Object(D.a)(Object(D.a)(n))),n.timer=null,n.chart_config={onrendered:n.c3onRendered,sum_i:0,sum_e:0,bindto:"#pie",tooltip:{format:{value:function(e,t,n){return"p"===n.substr(0,1)?e+"  ("+he(100*e/a.chart_config.sum_i)+"%)":-e+"  ("+he(100*-e/a.chart_config.sum_e)+"%)"}}},data:{names:{},columns:[],colors:{},order:null,onclick:function(e){a.onmouseover(e.id)},onmouseover:function(e){yr&&a.onmouseover(e.id)},type:"pie"},pie:{label:{format:function(e,t,n){return vr[n]}}},legend:{show:!0,item:{onclick:function(e){a.onmouseover(e)},onmouseover:function(e){!this.transiting&&this.isTargetToShow(e)&&this.api.focus(e),yr&&a.onmouseover(e)}}}},n}return Object(T.a)(t,e),Object(x.a)(t,[{key:"onmouseout",value:function(){this.timer&&clearTimeout(this.timer)}},{key:"onmouseover",value:function(e){var t=this;this.timer=setTimeout(function(){t.props.categoryLoad(e.substring(1),t.props.start,t.props.end)},300)}},{key:"getBoudingRect",value:function(){var e=document.getElementById(this.chart_config.bindto.substring(1)).getBoundingClientRect(),t=document.documentElement,n=(window.pageXOffset||t.scrollLeft)-(t.clientLeft||0),a=(window.pageYOffset||t.scrollTop)-(t.clientTop||0);return{left:n+e.left,top:a+e.top}}},{key:"d3onMouseI",value:function(){var e=this.getBoudingRect();br.select("#incomes").style({display:"inline",left:-60+e.left+"px",top:150+e.top+"px"})}},{key:"d3onMouseOutI",value:function(){br.select("#incomes").style({display:"none"})}},{key:"d3onMouseE",value:function(){var e=this.getBoudingRect();br.select("#expences").style({display:"inline",left:e.left+"px",top:150+e.top+"px"})}},{key:"d3onMouseOutE",value:function(){br.select("#expences").style({display:"none"})}},{key:"c3onRendered",value:function(){var e=this.lessThan700?this.lessThan450?8:20:40,t=this.chart_config.sum_i-this.chart_config.sum_e;if(0!==t){var n=-this.chart_config.sum_e/t*2*Math.PI,a=br.svg.arc().innerRadius(0).outerRadius(e).startAngle(0).endAngle(n),r=br.svg.arc().innerRadius(0).outerRadius(e).startAngle(n).endAngle(2*Math.PI),i=br.svg.arc().innerRadius(e).outerRadius(e+1).startAngle(0).endAngle(2*Math.PI),s=br.selectAll("#pie").select(".c3-chart-arcs");s.append("svg:path").attr("id","arc-minus").style("stroke-width",0).attr("d",a).on({click:this.d3onMouseE,mouseover:this.d3onMouseE,mouseout:this.d3onMouseOutE}),s.append("svg:path").attr("id","arc-plus").style("stroke-width",0).attr("d",r).on({click:this.d3onMouseI,mouseover:this.d3onMouseI,mouseout:this.d3onMouseOutI}),s.append("svg:path").attr("id","arc-space").style("stroke-width",0).attr("d",i)}}},{key:"draw",value:function(){rr.a.generate(this.chart_config)}},{key:"redraw",value:function(){this.draw()}},{key:"componentWillReceiveProps",value:function(e){if(this.props.start!==e.start||this.props.end!==e.end)this.props.pieLoad(e.start,e.end);else{var t={},n=[],a=0,r=0,i=null;e.slices&&(e.slices.forEach(function(s){var l=rn(e.constants.cat,function(e){return s.c===e.value});s.sl<0?(r+=s.sl,i="n"+s.c,vr[i]=l.label,t[i]=l.color,n.push([i,-s.sl])):(a+=s.sl,i="p"+s.c,vr[i]=l.label,t[i]=l.color,n.push([i,s.sl]))}),this.chart_config.sum_i=a,this.chart_config.sum_e=r,this.chart_config.data.names=vr,this.chart_config.data.colors=t,this.chart_config.data.columns=n,this.draw())}}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(dn.a,{query:"(max-width: 699px)"},function(t){return e.lessThan700=t}),r.a.createElement(dn.a,{query:"(max-width: 449px)"},function(t){return e.lessThan450=t}),r.a.createElement("div",{id:"pie",onMouseOut:function(){return e.onmouseout()}}),r.a.createElement("table",{id:"incomes",className:"c3-tooltip",style:{display:"none",position:"absolute"}},r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("span",{style:{backgroundColor:"green"}})," Income total"),r.a.createElement("td",null,he(this.chart_config.sum_i))))),r.a.createElement("table",{id:"expences",className:"c3-tooltip",style:{display:"none",position:"absolute"}},r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("span",{style:{backgroundColor:"red"}})," Expences total"),r.a.createElement("td",null,he(this.chart_config.sum_e))))))}}]),t}(r.a.Component);gr.defaultProps={start:fr.startDate,end:fr.endDate,slices:null};var Or=Object(s.b)(function(e){return{start:e.daterange.s,end:e.daterange.e,slices:e.pie.slices,refreshTime:e.constants.refreshTime,redraw:e.pie.redraw,constants:e.constants.constants}},function(e){return{pieLoad:function(t,n){e(On(t,n))},categoryLoad:function(t,n,a){e(Nn(t,n,a))},getConstants:function(t){Q(t,e)}}})(gr),Er=function(e){function t(){return Object(w.a)(this,t),Object(_.a)(this,Object(R.a)(t).apply(this,arguments))}return Object(T.a)(t,e),Object(x.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(S.a,null,r.a.createElement(S.a.Body,null,r.a.createElement(Or,null))))}}]),t}(r.a.Component),jr=Object(s.b)(function(e){return{fetching:e.pie.fetching,start:e.daterange.s,end:e.daterange.e}})(Er),kr=function(e){return function(t){"c"===e&&t(J()),"a"===e&&t(He()),"l"===e&&t(it()),t(function(e){return{type:"SHOW_VIEW",payload:{view:e}}}(e))}},Cr=function(){return r.a.createElement(tt,null)},wr=function(){return r.a.createElement(_e,null)},xr=function(){return r.a.createElement(Et,null)},_r=function(e){function t(){return Object(w.a)(this,t),Object(_.a)(this,Object(R.a)(t).apply(this,arguments))}return Object(T.a)(t,e),Object(x.a)(t,[{key:"componentWillReceiveProps",value:function(e){"main"!==this.props.view&&"main"===e.view&&(this.props.minibarsRedraw(),this.props.chartRedraw(),this.props.pieRedraw())}},{key:"render",value:function(){var e=r.a.createElement("div",null,r.a.createElement("div",{style:{width:"100%"}},r.a.createElement(mn,null)),r.a.createElement("div",{style:{width:"100%"}},r.a.createElement("div",{style:{width:"100%",display:"inline-flex",whiteSpace:"nowrap"}},r.a.createElement("div",{style:{width:"75%",paddingRight:"2px"}},r.a.createElement(mr,null)),r.a.createElement("div",{style:{width:"25%",paddingLeft:"2px"}},r.a.createElement(jr,null)))),r.a.createElement(nr,null));return r.a.createElement("div",{style:{padding:"15px"}},r.a.createElement("div",{style:{display:"main"===this.props.view?"":"none"}},e),r.a.createElement("div",{style:{display:"a"===this.props.view?"":"none"}},r.a.createElement(Cr,null)),r.a.createElement("div",{style:{display:"c"===this.props.view?"":"none"}},r.a.createElement(wr,null)),r.a.createElement("div",{style:{display:"l"===this.props.view?"":"none"}},r.a.createElement(xr,null)))}}]),t}(r.a.Component);_r.defaultProps={view:"main"};var Rr=Object(s.b)(function(e){return{view:e.navi.view}},function(e){return{showView:function(t){e(kr(t))},chartRedraw:function(){e(Ie())},pieRedraw:function(){e(En())},minibarsRedraw:function(){e(Vt())}}})(_r),Tr=n(601),Sr=function(e){function t(e){var n;return Object(w.a)(this,t),(n=Object(_.a)(this,Object(R.a)(t).call(this,e))).dismiss=n.dismiss.bind(Object(D.a)(Object(D.a)(n))),n.show=n.show.bind(Object(D.a)(Object(D.a)(n))),n.state={show:!1},n}return Object(T.a)(t,e),Object(x.a)(t,[{key:"dismiss",value:function(){this.setState({show:!1})}},{key:"show",value:function(){this.setState({show:!0})}},{key:"componentWillReceiveProps",value:function(e){e.when!==this.props.when&&this.show()}},{key:"render",value:function(){if(!this.state.show)return null;var e=this.props,t=e.status,n=e.msg;return r.a.createElement(Tr.a,{bsStyle:"danger",onDismiss:this.dismiss},r.a.createElement("h4",null,"We've got an error!"),"Server returned:",r.a.createElement("ul",null,r.a.createElement("li",null,"Status: ",t),r.a.createElement("li",null,"Message: ",n)),r.a.createElement("hr",null),r.a.createElement("p",null,r.a.createElement(P.a,{onClick:this.dismiss},"Close")))}}]),t}(r.a.Component);Sr.defaultProps={when:0};var Fr=Object(s.b)(function(e){return{status:e.errorMessage.status,msg:e.errorMessage.msg,when:e.errorMessage.when}})(Sr),Nr=n(606),Dr=n(602),Pr=n(607),Vr=n(603),Ar=function(){return function(e){e({type:"NEW_GROUP_REQUEST"}),Y("group/newid",null,function(t){e({type:"NEW_GROUP_RESPONSE",payload:{g:t.data}})},e)}},Mr=n(580),Ir=function(e){function t(e){var n;return Object(w.a)(this,t),(n=Object(_.a)(this,Object(R.a)(t).call(this,e))).generatedOk=n.generatedOk.bind(Object(D.a)(Object(D.a)(n))),n.generateGroup=n.generateGroup.bind(Object(D.a)(Object(D.a)(n))),n}return Object(T.a)(t,e),Object(x.a)(t,[{key:"generatedOk",value:function(e){this.msg.show("NEW GROUPID ON CLIPBOARD",{time:2e3,type:"success",icon:r.a.createElement("img",{src:"yes.png",alt:"save ok"})})}},{key:"generateGroup",value:function(){this.props.newGroup()}},{key:"componentWillReceiveProps",value:function(e){e.g!==this.props.g&&(Mr(e.g),this.generatedOk(e.g))}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(ue.a,Object.assign({ref:function(t){return e.msg=t}},de)),r.a.createElement(Nr.a,{style:{marginBottom:"0px"}},r.a.createElement(Nr.a.Header,null,r.a.createElement(Nr.a.Brand,null," Onassis "),r.a.createElement(Nr.a.Toggle,null)),r.a.createElement(Nr.a.Collapse,null,r.a.createElement(Dr.a,null,r.a.createElement(Pr.a,{eventKey:3,title:"View",id:"basic-nav-dropdown"},r.a.createElement(Vr.a,{eventKey:3.1,onSelect:function(t){e.props.showView("main")}},"main"===this.props.view?"X":""," Main"),r.a.createElement(Vr.a,{eventKey:3.2,onSelect:function(t){e.props.showView("c")}},"c"===this.props.view?"X":""," Categories"),r.a.createElement(Vr.a,{eventKey:3.3,onSelect:function(t){e.props.showView("a")}},"a"===this.props.view?"X":""," Accounts"),r.a.createElement(Vr.a,{divider:!0}),r.a.createElement(Vr.a,{eventKey:3.4,onSelect:function(t){e.props.showView("l")}},"l"===this.props.view?"X":""," Logs")),r.a.createElement(Pr.a,{eventKey:4,title:"Util",id:"basic-nav-dropdown"},r.a.createElement(Vr.a,{eventKey:4.1,onSelect:function(t){e.generateGroup()}},"Generate unused groupid"))))))}}]),t}(r.a.Component);Ir.defaultProps={view:"main"};var Lr=Object(s.b)(function(e){return{view:e.navi.view,g:e.group.g}},function(e){return{showView:function(t){e(kr(t))},newGroup:function(){e(Ar())}}})(Ir),Hr=function(e){return{type:"PING_RESPONSE",payload:{up:e}}},Ur=function(){return function(e){e({type:"PING_REQUEST"}),M.a.get("http://localhost:8080/ping?ts="+Date.now(),{port:8080}).then(function(t){e(Hr(!0))}).catch(function(t){e(Hr(!1))})}},Yr=function(e){function t(e){var n;return Object(w.a)(this,t),(n=Object(_.a)(this,Object(R.a)(t).call(this,e))).timer=null,n}return Object(T.a)(t,e),Object(x.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.timer=setInterval(function(){e.props.ping()},5e3)}},{key:"render",value:function(){return null}}]),t}(r.a.Component);Yr.defaultProps={show:!1};var Br=Object(s.b)(function(e){return{show:0!==e.ping.length&&!e.ping.up}},function(e){return{ping:function(){e(Ur())}}})(Yr),Wr=function(e){function t(){return Object(w.a)(this,t),Object(_.a)(this,Object(R.a)(t).apply(this,arguments))}return Object(T.a)(t,e),Object(x.a)(t,[{key:"componentDidMount",value:function(){this.props.chartToday()}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(Br,null),r.a.createElement(Lr,null),r.a.createElement(Fr,null),r.a.createElement(Rr,null))}}]),t}(r.a.Component);var zr=Object(s.b)(null,function(e){return{chartToday:function(){e(Me())}}})(Wr),qr=n(236),Gr=[c.a],Qr=Object(l.createStore)(C,Object(qr.composeWithDevTools)(l.applyMiddleware.apply(void 0,Gr)));window.reduxStore=Qr,Object(i.render)(r.a.createElement(s.a,{store:Qr},r.a.createElement(zr,null)),document.getElementById("root"))}},[[237,2,1]]]);
//# sourceMappingURL=main.7d35ab76.chunk.js.map